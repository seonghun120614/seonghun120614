<!DOCTYPE html>
<html lang="kor">

    <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="icon" href="/seonghun120614/assets/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/seonghun120614/assets/css/style.css">
<title>[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 46ì¼ì°¨ Rest API 2</title>
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 46ì¼ì°¨ Rest API 2 | Seonghunâ€™s Blog</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 46ì¼ì°¨ Rest API 2" />
<meta name="author" content="Seonghun Park" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="https://seonghun120614.github.io/seonghun120614/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC/%EB%A9%8B%EC%82%AC/%EB%B0%B1%EC%97%94%EB%93%9C/til/java/spring/2025/10/30/%EB%A9%8B%EC%82%AC-%EB%B0%B1%EC%97%94%EB%93%9C-19%EA%B8%B0-til-46%EC%9D%BC%EC%B0%A8-rest-api-2.html" />
<meta property="og:url" content="https://seonghun120614.github.io/seonghun120614/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC/%EB%A9%8B%EC%82%AC/%EB%B0%B1%EC%97%94%EB%93%9C/til/java/spring/2025/10/30/%EB%A9%8B%EC%82%AC-%EB%B0%B1%EC%97%94%EB%93%9C-19%EA%B8%B0-til-46%EC%9D%BC%EC%B0%A8-rest-api-2.html" />
<meta property="og:site_name" content="Seonghunâ€™s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-30T00:07:20+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 46ì¼ì°¨ Rest API 2" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Seonghun Park"},"dateModified":"2025-10-30T00:07:20+00:00","datePublished":"2025-10-30T00:07:20+00:00","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 46ì¼ì°¨ Rest API 2","mainEntityOfPage":{"@type":"WebPage","@id":"https://seonghun120614.github.io/seonghun120614/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC/%EB%A9%8B%EC%82%AC/%EB%B0%B1%EC%97%94%EB%93%9C/til/java/spring/2025/10/30/%EB%A9%8B%EC%82%AC-%EB%B0%B1%EC%97%94%EB%93%9C-19%EA%B8%B0-til-46%EC%9D%BC%EC%B0%A8-rest-api-2.html"},"url":"https://seonghun120614.github.io/seonghun120614/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC/%EB%A9%8B%EC%82%AC/%EB%B0%B1%EC%97%94%EB%93%9C/til/java/spring/2025/10/30/%EB%A9%8B%EC%82%AC-%EB%B0%B1%EC%97%94%EB%93%9C-19%EA%B8%B0-til-46%EC%9D%BC%EC%B0%A8-rest-api-2.html"}</script>
<!-- End Jekyll SEO tag -->


<script type="text/javascript" src="/seonghun120614/assets/js/darkmode.js"></script>

<!-- Mermaid -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RQTWJRLWGD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-RQTWJRLWGD');
</script></head><script>
        document.addEventListener("DOMContentLoaded", function () {
            const toggle = document.getElementById("dark-toggle");
        
            // ì´ë¯¸ ì‹¤í–‰í•œ ì  ìˆëŠ”ì§€ í™•ì¸
            const hasToggled = localStorage.getItem("darkModeInitialized");
        
            if (!hasToggled && toggle && toggle.checked) {
                toggleDarkMode();
                localStorage.setItem("darkModeInitialized", "true"); // ìµœì´ˆ ì‹¤í–‰ ê¸°ë¡
            }
        });
    </script>

    <body>
        <div id="scroll-progress"></div>
        <main class="container">
            <section class="about">
                <div class="about-header condensed">
                    <div class="about-title">
                        <a href="/seonghun120614/">
                            
                            <img class="light"
                                src="/seonghun120614/assets/portfolio.png"
                                alt="Seonghun Park" />
                            <img class="dark"
                                src="/seonghun120614/assets/portfolio.png"
                                alt="Seonghun Park" />
                            
                        </a>
                        <h2 id="title">
                            <a href="/seonghun120614/">Seonghun Park</a>
                        </h2>
                    </div><p class="tagline">Developer.</p></div>
                
                <ul class="social about-footer condensed"><li>
                        <a
                            href="https://github.com/seonghun120614"
                            target="_blank"
                            rel="noopener"
                            aria-label="github">
                            <i class="icon-github-circled"></i>
                        </a>
                    </li><li>
                        <a
                            href="mailto:seonghun120614@gmail.com"
                            target="_blank" rel="noopener" aria-label="email">
                            <i class="icon-mail-alt"></i>
                        </a>
                    </li></ul><nav class="navigation about-footer condensed">
                    <ul>
                        
                        <li>
                            <a href="/seonghun120614/about">About Me</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/computerscience">Computer Science</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/math">Math</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/softwareengineering">Software Engineering</a>
                        </li>
                        
                    </ul>
                </nav><p class="about-footer condensed">&copy;
                    2025</p><div class="about-footer condensed">
                    <p>Dark Mode
                        <i class="icon-moon"></i>
                        <label class="switch" for="dark-toggle">
                            <input id="dark-toggle" type="checkbox"
                                class="dark-mode-toggle"
                                aria-label="Toggle dark mode">
                            <span class="slider round"
                                onclick="toggleDarkMode()"></span>
                        </label>
                    </p>
                </div>
            </section>
            <section class="content">
                <script>
window.MathJax = {
    tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']]
    },
    options: {
    renderActions: {
        addMenu: []
    }
    }
};
</script>

<script type="text/javascript"
    id="MathJax-script"
    async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script><div class="post-container">
    <a class="post-link" href="/seonghun120614/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC/%EB%A9%8B%EC%82%AC/%EB%B0%B1%EC%97%94%EB%93%9C/til/java/spring/2025/10/30/%EB%A9%8B%EC%82%AC-%EB%B0%B1%EC%97%94%EB%93%9C-19%EA%B8%B0-til-46%EC%9D%BC%EC%B0%A8-rest-api-2.html">
        <h2 class="post-title">[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 46ì¼ì°¨ Rest API 2</h2>
    </a>
    
    <div class="post-meta">
        <div class="post-date"><i class="icon-calendar"></i>Oct 30, 2025</div><ul class="post-categories"><li>ë©‹ìŸì´ì‚¬ìì²˜ëŸ¼</li><li>ë©‹ì‚¬</li><li>ë°±ì—”ë“œ</li><li>TIL</li><li>Java</li><li>Spring</li></ul></div>

    <div class="post">
        <!--more-->

<h2 id="-ëª©ì°¨">ğŸ“‚ ëª©ì°¨</h2>
<ul>
  <li><a href="#uri-ì„¤ê³„-ì›ì¹™">URI ì„¤ê³„ ì›ì¹™</a></li>
  <li><a href="#http-ìƒíƒœ-ì½”ë“œì˜-ì„¸ë¶„í™”">HTTP ìƒíƒœ ì½”ë“œì˜ ì„¸ë¶„í™”</a>
    <ul>
      <li><a href="#http-ìƒíƒœ-ì½”ë“œì˜-ì„¸ë¶„í™”">RestControllerAdvice</a></li>
    </ul>
  </li>
  <li><a href="#versioning">Versioning</a></li>
  <li><a href="#content-negotiation">Content Negotiation</a></li>
  <li><a href="#etag-ê¸°ë°˜-ì¡°ê±´ë¶€-ìš”ì²­-if-match-if-none-match">ETag ê¸°ë°˜ ì¡°ê±´ë¶€ ìš”ì²­ (If-Match, If-None-Match)</a></li>
  <li><a href="#idempotency-key">Idempotency-Key</a></li>
  <li><a href="#cors--csrf">CORS &amp; CSRF</a>
    <ul>
      <li><a href="#cors">CORS</a>
        <ul>
          <li><a href="#simple-request">Simple Request</a></li>
          <li><a href="#preflight-request">Preflight Request</a></li>
          <li><a href="#ì „ì²´-íë¦„">ì „ì²´ íë¦„</a></li>
        </ul>
      </li>
      <li><a href="#csrf">CSRF</a>
        <ul>
          <li><a href="#csrf-í† í°">CSRF í† í°</a></li>
          <li><a href="#samesite-cookie-ì„¤ì •">SameSite Cookie ì„¤ì •</a></li>
          <li><a href="#referer--origin-ê²€ì¦">Referer / Origin ê²€ì¦</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#spring-hateoas-ì‹¬í™”">Spring HATEOAS ì‹¬í™”</a>
    <ul>
      <li><a href="#hateoas-representation-model">HATEOAS Representation Model</a></li>
    </ul>
  </li>
  <li><a href="#globalexceptionhandler">GlobalExceptionHandler</a></li>
</ul>

<hr />

<h2 id="-ë³¸ë¬¸">ğŸ“š ë³¸ë¬¸</h2>

<p>REST ì— ëŒ€í•´ ë” ê¹Šì´ ì‚´í´ë³¸ë‹¤.</p>

<h3 id="uri-ì„¤ê³„-ì›ì¹™">URI ì„¤ê³„ ì›ì¹™</h3>

<ul>
  <li>ëª…ì‚¬ ê¸°ë°˜ ì„¤ê³„ (<code class="language-plaintext highlighter-rouge">/createUser</code> X , <code class="language-plaintext highlighter-rouge">/users</code> O)</li>
  <li>ë³µìˆ˜í˜• ì‚¬ìš© (<code class="language-plaintext highlighter-rouge">/users</code>)</li>
  <li>í•„í„°ë§ &amp; ì •ë ¬ (<code class="language-plaintext highlighter-rouge">/users?age=20&amp;sort=name,desc</code>)</li>
  <li>sub resource (<code class="language-plaintext highlighter-rouge">/users/{id}/orders</code>)</li>
  <li>ê´€ê³„ ìì› í‘œí˜„ (<code class="language-plaintext highlighter-rouge">/orders/{id}/items</code>)</li>
</ul>

<h3 id="http-ìƒíƒœ-ì½”ë“œì˜-ì„¸ë¶„í™”">HTTP ìƒíƒœ ì½”ë“œì˜ ì„¸ë¶„í™”</h3>

<p><a href="https://datatracker.ietf.org/doc/html/rfc9110">HTTP Semantics</a></p>

<h4 id="restcontrolleradvice">RestControllerAdvice</h4>

<p>ì˜ˆì™¸ì²˜ë¦¬ëŠ” <code class="language-plaintext highlighter-rouge">ControllerAdvice</code> ì™€ ë³„ë°˜ ë‹¤ë¥´ì§€ ì•Šë‹¤. ë°˜í™˜ìœ¼ë¡œëŠ” <code class="language-plaintext highlighter-rouge">ErrorResponse</code> ë¥¼ ë‚´ë³´ë‚´ê²Œ ëœë‹¤.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RestControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="o">{</span>

    <span class="c1">// ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸ ì²˜ë¦¬</span>
    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">ResourceNotFoundException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">handleNotFound</span><span class="o">(</span>
            <span class="nc">ResourceNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">ErrorResponse</span> <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ErrorResponse</span><span class="o">(</span>
            <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">.</span><span class="na">value</span><span class="o">(),</span>
            <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span>
            <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">()</span>
        <span class="o">);</span>

        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">).</span><span class="na">body</span><span class="o">(</span><span class="n">error</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// ê²€ì¦ ì˜ˆì™¸ ì²˜ë¦¬</span>
    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">MethodArgumentNotValidException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">handleValidation</span><span class="o">(</span>
            <span class="nc">MethodArgumentNotValidException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">()</span>
            <span class="o">.</span><span class="na">getFieldErrors</span><span class="o">()</span>
            <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">err</span> <span class="o">-&gt;</span> <span class="n">err</span><span class="o">.</span><span class="na">getField</span><span class="o">()</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">err</span><span class="o">.</span><span class="na">getDefaultMessage</span><span class="o">())</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>

        <span class="nc">ErrorResponse</span> <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ErrorResponse</span><span class="o">(</span>
            <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">BAD_REQUEST</span><span class="o">.</span><span class="na">value</span><span class="o">(),</span>
            <span class="s">"Validation failed"</span><span class="o">,</span>
            <span class="n">errors</span><span class="o">,</span>
            <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">()</span>
        <span class="o">);</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">badRequest</span><span class="o">().</span><span class="na">body</span><span class="o">(</span><span class="n">error</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="c1">// ì¼ë°˜ ì˜ˆì™¸ ì²˜ë¦¬</span>
    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">handleGeneral</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ErrorResponse</span> <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ErrorResponse</span><span class="o">(</span>
            <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">.</span><span class="na">value</span><span class="o">(),</span>
            <span class="s">"Internal server error"</span><span class="o">,</span>
            <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">()</span>
        <span class="o">);</span>

        <span class="k">return</span> <span class="nc">ResponseEntity</span>
            <span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">)</span>
            <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">error</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ErrorResponse</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">status</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">errors</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">timestamp</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ErrorResponse</span><span class="o">(</span><span class="kt">int</span> <span class="n">status</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">,</span> <span class="nc">LocalDateTime</span> <span class="n">timestamp</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">status</span><span class="o">,</span> <span class="n">message</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">timestamp</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// ì»¤ìŠ¤í…€ ì˜ˆì™¸</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResourceNotFoundException</span> <span class="kd">extends</span> <span class="nc">RuntimeException</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">ResourceNotFoundException</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="versioning">Versioning</h3>

<p>ë³´í†µ URI ìª½ì— ë²„ì „ì„ ë„£ëŠ” ë°©ì‹ì´ í‘œì¤€ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ëœë‹¤.</p>

<ul>
  <li>URI: <code class="language-plaintext highlighter-rouge">/api/v1/users</code></li>
  <li>Header: <code class="language-plaintext highlighter-rouge">Accept: application.vnd.example.v1+json</code></li>
  <li>Parameer: <code class="language-plaintext highlighter-rouge">/users?version=1</code></li>
</ul>

<h3 id="content-negotiation">Content Negotiation</h3>

<p>REST API ì˜ í•µì‹¬ ê°œë… ì¤‘ í•˜ë‚˜ì´ë©°, ì´ê±¸ ì´í•´í•˜ë©´ ì›í•˜ëŠ” ë°ì´í„° í˜•ì‹ì„ ì„œë²„ì—ê²Œ ìš”ì²­í•˜ê³  ì„œë²„ê°€ ê°€ì¥ ì ì ˆí•œ í‘œí˜„ìœ¼ë¡œ ì‘ë‹µí•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<p>ì½˜í…ì¸  í˜‘ìƒì´ë¼ê³  í•˜ëŠ” ê°œë…ì€ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ìš”ì²­/ì‘ë‹µì˜ ë°ì´í„° í˜•ì‹ì„ í˜‘ì˜í•˜ëŠ” ê³¼ì •ì´ë‹¤. ë‹¤ìŒ ë‘ ê°€ì§€ í—¤ë”ê°€ í•µì‹¬ì´ë‹¤.</p>

<ul>
  <li>ìš”ì²­ì—ì„œì˜ <code class="language-plaintext highlighter-rouge">Accept</code>: í´ë¼ì´ì–¸íŠ¸ê°€ ë°›ê³  ì‹¶ì€ ì‘ë‹µ í˜•ì‹ì„ ì§€ì •í•œë‹¤.</li>
  <li>ìš”ì²­ì—ì„œì˜ <code class="language-plaintext highlighter-rouge">Content-Type</code>: í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚´ëŠ” ë°ì´í„° í˜•ì‹ ì§€ì •</li>
  <li>ì‘ë‹µì—ì„œì˜ <code class="language-plaintext highlighter-rouge">Content-Type</code>: ì„œë²„ê°€ ë³´ë‚´ëŠ” ì‹¤ì œ ë°ì´í„° í˜•ì‹ ëª…ì‹œ</li>
</ul>

<figure class="highlight"><pre><code class="language-text" data-lang="text">### Request
GET /api/users/1 HTTP/1.1
Accept: application/json
- Content-Type: application/json &lt;- ë³´ë‚´ëŠ” body ê°€ ìˆì„ë•Œë§Œ ì‚¬ìš©

### Response
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 1,
  "name": "í™ê¸¸ë™"
}</code></pre></figure>

<p><strong>Spring MVC ì—ì„œì˜ ë™ì‘</strong></p>

<p>ì „ì²´ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">ìš”ì²­ â†’ DispatcherServlet
        â†“
     HandlerMapping (ì ì ˆí•œ Controller ì°¾ê¸°)
        â†“
   HandlerAdapter(RequestMappingHandlerAdapter) (ì ì ˆí•œ ì‹¤í–‰ ì–´ëŒ‘í„° ì„ íƒ)
        â†“
   HandlerMethod(@Controller or @RestController) ì‹¤í–‰
        â†“
   HandlerMethodReturnValueHandler ë¡œ HandlerMethod ë°˜í™˜ê°’ ì²˜ë¦¬ 
        â†“
   ë°˜í™˜ ê°ì²´ë¥¼ HttpMessageConverter ë¡œ ì§ë ¬í™”
        â†“
   ContentNegotiationManager ê°€ Accept í—¤ë” ê¸°ë°˜ìœ¼ë¡œ MIME íƒ€ì… ê²°ì •
        â†“
   ResponseEntity / ResponseBody ë¡œ ì‘ë‹µ ë°˜í™˜</code></pre></figure>

<ol>
  <li><code class="language-plaintext highlighter-rouge">RequestMappingHandlerAdapter</code> ê°€ í´ë¼ì´ì–¸íŠ¸ ë§¤ê°œë³€ìˆ˜, ë°˜í™˜ê°’, ìš”ì²­/ì‘ë‹µ body ì§ë ¬í™”/ì—­ì§ë ¬í™” ë¶„ì„
    <ul>
      <li>ì´ ì•ˆì—” ì—¬ëŸ¬ ê°ì²´ê°€ ìˆëŠ”ë°, <code class="language-plaintext highlighter-rouge">HandlerMethodArgumentResolver</code>, <code class="language-plaintext highlighter-rouge">HandlerMethodReturnValueHandler</code>, <code class="language-plaintext highlighter-rouge">HttpMessageConverter</code> ê°€ ìˆë‹¤.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">ReturnHandler</code> ì˜ <code class="language-plaintext highlighter-rouge">HandlerMethodReturnValueHandler</code> ë¡œ <code class="language-plaintext highlighter-rouge">Accept</code> í—¤ë” ì½ì–´ë“¤ì„</li>
  <li>ì•Œë§ì€ <code class="language-plaintext highlighter-rouge">HttpMessageConverter</code> ë¥¼ ì„ íƒí•´ ì§ë ¬í™”
    <ul>
      <li><code class="language-plaintext highlighter-rouge">MappingJackson2HttpMessageConverter</code> -&gt; <code class="language-plaintext highlighter-rouge">application/json</code></li>
      <li><code class="language-plaintext highlighter-rouge">Jaxb2RootElementHttpMessageConverter</code> -&gt; <code class="language-plaintext highlighter-rouge">application/xml</code></li>
      <li><code class="language-plaintext highlighter-rouge">StringHttpMessageConverter</code> -&gt; <code class="language-plaintext highlighter-rouge">text/plain</code></li>
      <li><code class="language-plaintext highlighter-rouge">ByteArrayHttpMessageConverter</code> -&gt; <code class="language-plaintext highlighter-rouge">application/octet-stream</code></li>
    </ul>
  </li>
  <li>ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë¦¬í„´ ê°ì²´ë¥¼ ê·¸ í¬ë§·ìœ¼ë¡œ ì§ë ¬í™”</li>
</ol>

<p>ì´ë¥¼ ì§€í‚¤ê¸° ìœ„í•´ Mapping ì—ëŠ” <code class="language-plaintext highlighter-rouge">produces</code>, <code class="language-plaintext highlighter-rouge">consumes</code> ë¥¼ ë¶™ì´ëŠ” ê²ƒì„ ì „ í¬ìŠ¤íŠ¸ì—ì„œ ë³´ì•˜ë‹¤. ì½”ë“œëŠ” ìƒëµí•œë‹¤.</p>

<h3 id="etag-ê¸°ë°˜-ì¡°ê±´ë¶€-ìš”ì²­-if-match-if-none-match">ETag ê¸°ë°˜ ì¡°ê±´ë¶€ ìš”ì²­ (If-Match, If-None-Match)</h3>

<p><code class="language-plaintext highlighter-rouge">ETag</code> ëŠ” ì„œë²„ê°€ ë¦¬ì†ŒìŠ¤ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ë¶€ì—¬í•˜ëŠ” ê³ ìœ í•œ ì‹ë³„ì(í† í°)ì´ë‹¤. ë¦¬ì†ŒìŠ¤ì˜ ë‚´ìš©ì´ ë°”ë€Œë©´, <code class="language-plaintext highlighter-rouge">ETag</code> ì˜ ê°’ë„ ë°”ë€Œê²Œ ëœë‹¤.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">HTTP/1.1 200 OK
Content-Type: application/json
ETag: "v1-users-12345"

{
  "id": 1,
  "name": "í™ê¸¸ë™"
}</code></pre></figure>

<p>ë§Œì•½ ì „ìš© ìŠ¤í† ë¦¬ì§€ê°€ ìˆë‹¤ë©´, ë¸Œë¼ìš°ì €ë‚˜ í´ë¼ì´ì–¸íŠ¸ëŠ” ì´ê±¸ ê¸°ì–µí•´ë’€ë‹¤ê°€ ë‹¤ìŒ ìš”ì²­ ì‹œì— ì‚¬ìš©í•œë‹¤.</p>

<ul>
  <li>ìºì‹± ìµœì í™”</li>
  <li>ë™ì‹œì„± ì œì–´</li>
  <li>ë„¤íŠ¸ì›Œí¬ ì ˆì•½</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span>
            <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ProductResponseDto</span><span class="o">&gt;</span> <span class="nf">getProduct</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">notFound</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

    <span class="kt">var</span> <span class="n">product</span> <span class="o">=</span> <span class="n">productService</span><span class="o">.</span><span class="na">getProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">ok</span><span class="o">()</span>
                         <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">)</span>
                         <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"ETag"</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">product</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()))</span>
                         <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>ì´ì œ client-side ì˜ storage ìì²´ì—ì„œ ì´ë¥¼ ì“¸ ìˆ˜ ìˆë‹¤. ìœ„ í—¤ë”ë¥¼ í†µí•´ì„œ ì´ì œ CRUD ì—ì„œ ë‹¤ìŒ ì˜µì…˜ë„ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤.</p>

<p><strong>If-None-Match</strong></p>

<p>GET ë°©ì‹ì—ì„œ ìºì‹± ìµœì í™”ë¥¼ ìœ„í•´ ì‚¬ìš©ëœë‹¤.<br />
í´ë¼ì´ì–¸íŠ¸ê°€ ê°€ì§€ê³  ìˆëŠ” ë¦¬ì†ŒìŠ¤ì˜ ETag ê°’ì´ ì„œë²„ì™€ ê°™ë‹¤ë©´, ë‹¤ì‹œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">GET /api/products/1 HTTP/1.1
If-None-Match: "v1-users-12345"</code></pre></figure>

<p>ì„œë²„ ë™ì‘:</p>
<ul>
  <li>í˜„ì¬ ë¦¬ì†ŒìŠ¤ì˜ ETagë¥¼ ê³„ì‚°</li>
  <li>If-None-Match ê°’ê³¼ ë¹„êµ
    <ul>
      <li>ê°™ìœ¼ë©´ â†’ <code class="language-plaintext highlighter-rouge">304 Not Modified</code></li>
      <li>ë‹¤ë¥´ë©´ â†’ <code class="language-plaintext highlighter-rouge">200 OK</code> + ìƒˆë¡œìš´ ETag + ìƒˆ ë°ì´í„°</li>
    </ul>
  </li>
</ul>

<p>ì´ë¥¼ í†µí•´ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ì ˆì•½ê³¼ ì‘ë‹µ ì†ë„ í–¥ìƒì„ ì–»ì„ ìˆ˜ ìˆë‹¤. ê¸°ëŠ¥ìƒ <code class="language-plaintext highlighter-rouge">GET</code> ë°©ì‹ì— ë” ì–´ìš¸ë¦°ë‹¤. ë‹¤ìŒ ì½”ë“œë¥¼ ë³´ì.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span>
            <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ProductResponseDto</span><span class="o">&gt;</span> <span class="nf">getProduct</span><span class="o">(</span>
        <span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
        <span class="nd">@RequestHeader</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"If-None-Match"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">eTag</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">notFound</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

    <span class="kt">var</span> <span class="n">product</span> <span class="o">=</span> <span class="n">productService</span><span class="o">.</span><span class="na">getProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">eTag</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">eTag</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">product</span><span class="o">.</span><span class="na">hashCode</span><span class="o">())))</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_MODIFIED</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>

    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">ok</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"ETag"</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">product</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()))</span>
                            <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>GET ë°©ì‹ìœ¼ë¡œ HTTP ìš”ì²­ì„ ë‹¤ìŒê³¼ ê°™ì´ ë³´ë‚´ë©´ 304 ë¡œ ë¦¬í„´ ë°›ê³  ìˆìŒì„ ë³¼ ìˆ˜ ìˆë‹¤:</p>

<p><img src="/seonghun120614/assets/img/etag-if-none-match.png" alt="assets/img/etag-if-none-match.png" /></p>

<blockquote>
  <p>HttpStatus.NOT_MODIFIED ëŠ” 302 ë²ˆì´ë‹¤.</p>
</blockquote>

<p><strong>If-Match</strong></p>

<p>ì´ì œ PUT, PATCH, DELETE ë“±ì— ì“¸ ìˆ˜ ìˆëŠ” ë°©ì‹ì´ë‹¤. <code class="language-plaintext highlighter-rouge">If-Match</code> ëŠ” ì´ ë²„ì „ì´ ì•„ì§ ìœ íš¨í•  ë•Œë§Œ ìˆ˜ì • í—ˆìš© -&gt; ë™ì‹œì„± ì œì–´</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@PutMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span>
            <span class="n">consumes</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">,</span>
            <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ProductResponseDto</span><span class="o">&gt;</span> <span class="nf">updateProduct</span><span class="o">(</span>
        <span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
        <span class="nd">@RequestBody</span> <span class="nc">ProductResponseDto</span> <span class="n">productRequestDto</span><span class="o">,</span>
        <span class="nd">@RequestHeader</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"If-Match"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">eTag</span><span class="o">)</span> <span class="o">{</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span>
        <span class="n">productRequestDto</span><span class="o">.</span><span class="na">name</span><span class="o">().</span><span class="na">isBlank</span><span class="o">()</span> <span class="o">||</span>
        <span class="n">productRequestDto</span><span class="o">.</span><span class="na">price</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">badRequest</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

    <span class="kt">var</span> <span class="n">oldProduct</span> <span class="o">=</span> <span class="n">productService</span><span class="o">.</span><span class="na">getProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">eTag</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">eTag</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">oldProduct</span><span class="o">.</span><span class="na">hashCode</span><span class="o">())))</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">PRECONDITION_FAILED</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>

    <span class="kt">var</span> <span class="n">product</span> <span class="o">=</span> <span class="n">productService</span><span class="o">.</span><span class="na">updateProduct</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">productRequestDto</span><span class="o">.</span><span class="na">name</span><span class="o">(),</span> <span class="n">productRequestDto</span><span class="o">.</span><span class="na">price</span><span class="o">());</span>

    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">ok</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@DeleteMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">deleteProduct</span><span class="o">(</span>
        <span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
        <span class="nd">@RequestHeader</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"If-Match"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">eTag</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">id</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
        <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">notFound</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

    <span class="kt">var</span> <span class="n">product</span> <span class="o">=</span> <span class="n">productService</span><span class="o">.</span><span class="na">getProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">eTag</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">eTag</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">product</span><span class="o">.</span><span class="na">hashCode</span><span class="o">())))</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">PRECONDITION_FAILED</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>

    <span class="n">productService</span><span class="o">.</span><span class="na">deleteProduct</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">noContent</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">HttpStatus.PRECONDITION_FAILED</code> ëŠ” 412 ë²ˆì´ë‹¤.</p>
</blockquote>

<h3 id="idempotency-key">Idempotency-Key</h3>

<p>POST ìš”ì²­ì€ ë‹¤ë¥¸ ìš”ì²­ë“¤ê³¼ëŠ” ë‹¤ë¥´ê²Œ ë©±ë“±ì„±ì„ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¤‘ë³µ ìš”ì²­ ì‹œ ìƒíƒœê°€ ë‹¬ë¼ì§€ë©°, ì´ëŠ” ë‹¤ìŒ ë¬¸ì œë“¤, <strong>ê²°ì œ, ì£¼ë¬¸ ìƒì„±, íšŒì› ê°€ì…</strong> ë“± í•œ ë²ˆë§Œ ìˆ˜í–‰ë˜ì–´ì•¼ í•˜ëŠ” ìš”ì²­ì— ìˆì–´ ì¤‘ë³µ ì‹¤í–‰ì„ ë°©ì§€í•´ì•¼ í•¨ì„ ë§í•œë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">Idempotency-Key</code> ëŠ” í—¤ë”ì— ìˆê³ , ì„œë²„ëŠ” ê°™ì€ í‚¤ë¥¼ ê°€ì§„ ìš”ì²­ì´ ì´ë¯¸ ì²˜ë¦¬ëëŠ”ì§€ í™•ì¸í•˜ë©°, ì´ë¯¸ ì²˜ë¦¬ëœ ìš”ì²­ì´ë©´ ì¤‘ë³µ ì²˜ë¦¬í•˜ì§€ ì•Šê³  ì´ì „ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.</p>

<p><strong>ìš”ì²­ ì˜ˆì‹œ</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="no">POST</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">orders</span> <span class="no">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="nc">Content</span><span class="o">-</span><span class="nl">Type:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="nc">Idempotency</span><span class="o">-</span><span class="nl">Key:</span> <span class="mi">123</span><span class="n">e4567</span><span class="o">-</span><span class="n">e89b</span><span class="o">-</span><span class="mi">12</span><span class="n">d3</span><span class="o">-</span><span class="n">a456</span><span class="o">-</span><span class="mi">426614174000</span>

<span class="o">{</span>
  <span class="s">"productId"</span><span class="o">:</span> <span class="mi">1</span><span class="o">,</span>
  <span class="s">"quantity"</span><span class="o">:</span> <span class="mi">2</span>
<span class="o">}</span></code></pre></figure>

<h3 id="cors--csrf">CORS &amp; CSRF</h3>

<h4 id="cors">CORS</h4>

<p>CORS(Cross-Origin Resource Sharing) ëŠ” <strong>ë¸Œë¼ìš°ì €ì—ì„œ ë‹¤ë¥¸ ì¶œì²˜(Origin) ìœ¼ë¡œì˜ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ ë°œìƒí•˜ëŠ” ë³´ì•ˆ ì •ì±…ì„ ì œì–´í•˜ëŠ” ê¸°ë²•</strong>ì´ë‹¤.</p>

<p>ì´ë•Œ <code class="language-plaintext highlighter-rouge">Origin = í”„ë¡œí† ì½œ + ë„ë©”ì¸ + í¬íŠ¸</code> ë¡œ ì •ì˜ë˜ë©°, ë‹¤ìŒê³¼ ê°™ì´ ìƒê°í•˜ë©´ ëœë‹¤:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">https://localhost:8080</code></li>
</ul>

<p><strong>Same-Origin Policy</strong></p>

<p>ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ ì •ì±…ì€ ë‹¤ë¥¸ ì¶œì²˜ë¡œë¶€í„° ìŠ¤í¬ë¦½íŠ¸ê°€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì„ ë§‰ëŠ”ë‹¤. ì´ëŠ” ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ê°€ ìˆì„ ìˆ˜ë„ ìˆê³ , ì‚¬ìš©ìì˜ ë°ì´í„°ë¥¼ íƒˆì·¨í•  ìˆ˜ë„ ìˆê¸°ì— ë§‰ëŠ”ê²Œ ì¢‹ìœ¼ë©° ì´ë•Œ ì´ ì•ˆì—ëŠ” CORS ë¼ëŠ” ê¸°ìˆ ì„ í†µí•´ ì„œë²„ê°€ íŠ¹ì • ë‹¤ë¥¸ ì¶œì²˜ë¥¼ í—ˆìš©í•´ì£¼ì–´ì„œ ë¸Œë¼ìš°ì €ê°€ ìš”ì²­ì„ í—ˆìš©í•  ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆë„ë¡ í•˜ë©° ë‹¤ë¥¸ í—ˆìš©ë˜ì§€ ì•Šì€ ì›¹ ì‘ë‹µì´ë‚˜ ìš”ì²­ì„ ë§‰ëŠ” ê¸°ëŠ¥ì´ ë°”ë¡œ CORS ì´ë‹¤.</p>

<blockquote>
  <p>ì„œë²„ -&gt; ë¸Œë¼ìš°ì €: <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code> í—¤ë”ë¥¼ í†µí•´ í—ˆìš©</p>
</blockquote>

<p>CORS ìš”ì²­ì—ëŠ” ë‘ ê°€ì§€ê°€ ìˆë‹¤.</p>

<h5 id="simple-request">Simple Request</h5>

<p>HTTP ë©”ì„œë“œì—ëŠ” 8ê°€ì§€ê°€ ìˆë‹¤.</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">GET</code>: ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒ. ì„œë²„ ìƒíƒœë¥¼ ë³€ê²½í•˜ì§€ ì•ŠìŒ</li>
  <li><code class="language-plaintext highlighter-rouge">HEAD</code>: GET ê³¼ ë™ì¼í•˜ì§€ë§Œ, ì‘ë‹µ ë³¸ë¬¸ì€ ì œì™¸í•˜ê³  í—¤ë”ë§Œ ë°˜í™˜</li>
  <li><code class="language-plaintext highlighter-rouge">POST</code>: ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ì„œë²„ì— ë°ì´í„°ë¥¼ ì „ì†¡. ìƒíƒœ ë³€ê²½ ê°€ëŠ¥</li>
  <li><code class="language-plaintext highlighter-rouge">PUT</code>: ë¦¬ì†ŒìŠ¤ë¥¼ ì „ì²´ ê°±ì‹ . ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒì„± ê°€ëŠ¥</li>
  <li><code class="language-plaintext highlighter-rouge">DELETE</code>: ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œ</li>
  <li><code class="language-plaintext highlighter-rouge">CONNECT</code>: í„°ë„ë§ì„ ìœ„í•´ ì‚¬ìš©. ì£¼ë¡œ HTTPS í”„ë¡ì‹œ ì—°ê²°ì— ì“°ì„</li>
  <li><code class="language-plaintext highlighter-rouge">OPTIONS</code>: ì„œë²„ê°€ ì§€ì›í•˜ëŠ” ë©”ì„œë“œ, CORS í—ˆìš© ë“± ì˜µì…˜ í™•ì¸ ìš©</li>
  <li><code class="language-plaintext highlighter-rouge">TRACE</code>: ìš”ì²­-ì‘ë‹µ ê²½ë¡œë¥¼ ë””ë²„ê¹…ìš©ìœ¼ë¡œ ê·¸ëŒ€ë¡œ ë°˜í™˜</li>
</ol>

<p>ì´ ì¤‘ì—ì„œ ë‹¨ìˆœ ìš”ì²­ì€ <strong>GET, POST, HEAD</strong> ì— í•´ë‹¹í•œë‹¤.</p>

<p>ë‹¨ìˆœìš”ì²­ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ <code class="language-plaintext highlighter-rouge">Content-Type</code> ì œì•½ì´ ë“¤ì–´ê°„ë‹¤:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">application/x-www-form-urlencoded</code></li>
  <li><code class="language-plaintext highlighter-rouge">multipart/form-data</code></li>
  <li><code class="language-plaintext highlighter-rouge">text/plain</code></li>
</ul>

<p>ë˜í•œ, í—¤ë”ì—ëŠ” ì‚¬ìš©ì ì •ì˜ í—¤ë” ë“¤ì–´ê°€ë©´ ì•ˆëœë‹¤. ì´ëŠ” ì•„ì£¼ ê¸°ë³¸ì ì¸ ìš”ì²­ì¼ ë•Œ ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³ , ì„œë²„ì— í—ˆìš©í•˜ë©´ ë°”ë¡œ ì‘ë‹µì´ ë“¤ì–´ì˜¤ê²Œ ëœë‹¤.</p>

<p><strong>ìš”ì²­ ì‘ë‹µ íë¦„</strong></p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">GET /api/users HTTP/1.1
Origin: http://localhost:3000</code></pre></figure>

<p>ë¸Œë¼ìš°ì €ê°€ ìœ„ì™€ ê°™ì´ ë³´ëƒˆë‹¤ê³  í•˜ì. ê·¸ëŸ¬ë©´ ì„œë²„ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ë‹µí•  ìˆ˜ ìˆë‹¤.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://localhost:3000
Content-Type: application/json</code></pre></figure>

<p>ì—¬ê¸°ì„œ <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code> í—¤ë”ê°€ ë¸Œë¼ìš°ì €ê°€ ìš”ì²­í•œ origin ê³¼ ì¼ì¹˜í•´ì•¼ ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ëœë‹¤. ì´ë ‡ë“¯ ë‹¨ìˆœ ìš”ì²­ì€ <strong>Preflight</strong> ì—†ì´ ë°”ë¡œ ìš”ì²­ì´ ì§„í–‰ëœë‹¤.</p>

<h5 id="preflight-request">Preflight Request</h5>

<p><strong>Preflight Request(ì‚¬ì „ ìš”ì²­)</strong> ì—ëŠ” <code class="language-plaintext highlighter-rouge">PUT</code>, <code class="language-plaintext highlighter-rouge">DELETE</code>, <code class="language-plaintext highlighter-rouge">PATCH</code>, <code class="language-plaintext highlighter-rouge">OPTIONS</code> ê°€ ìˆê³ , <code class="language-plaintext highlighter-rouge">Content-Type</code> ì—ëŠ” <code class="language-plaintext highlighter-rouge">application/json</code> ë“±ì´ ë“¤ì–´ê°„ë‹¤.</p>

<p>ì´ ì¤‘ <code class="language-plaintext highlighter-rouge">OPTIONS ìš”ì²­</code>ì´ <code class="language-plaintext highlighter-rouge">Preflight</code> ìš”ì²­ì˜ í•µì‹¬ì´ë©°, ëª©ì ì€ ë¸Œë¼ìš°ì €ê°€ ì‹¤ì œ ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ì— ì„œë²„ê°€ í—ˆìš©í•˜ëŠ” ë©”ì„œë“œ, í—¤ë”, ì¶œì²˜ë¥¼ ë¯¸ë¦¬ í™•ì¸í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤. í•­ìƒ <code class="language-plaintext highlighter-rouge">OPTIONS</code> ìš”ì²­ì´ ë¨¼ì € ì¼ì–´ë‚˜ê³  ê·¸ ë‹¤ìŒ <code class="language-plaintext highlighter-rouge">PUT</code>, <code class="language-plaintext highlighter-rouge">DELETE</code>, <code class="language-plaintext highlighter-rouge">PATCH</code> ìš”ì²­-ì‘ë‹µì´ ì´ë£¨ì–´ì§„ë‹¤.</p>

<p><strong>Preflight Reqeust íë¦„</strong></p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">OPTIONS /api/products/1 HTTP/1.1
Origin: http://localhost:3000
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: Content-Type</code></pre></figure>

<p>ìœ„ì™€ ê°™ì´ ìš”ì²­ì„ ë³´ë‚¸ë‹¤ë©´,</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://localhost:3000
Access-Control-Allow-Methods: GET, POST, PUT, DELETE
Access-Control-Allow-Headers: Content-Type
Access-Control-Max-Age: 3600</code></pre></figure>

<p>ìœ„ì™€ ê°™ì´ ì‘ë‹µì„ í•  ìˆ˜ ìˆë‹¤(GET ì€ ê¸°ë³¸ì ìœ¼ë¡œ í—ˆìš©í•˜ê¸° ë•Œë¬¸ì— ë‹¹ì—°íˆ ëª…ì‹œì ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ”ê²Œ ë§ìŒ).</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code>: http://localhost:8080</li>
  <li><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Methods</code>: í—ˆìš©ë˜ëŠ” ë©”ì„œë“œ(GET, POST, PUT, DELETE)</li>
  <li><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Headers</code>: í—ˆìš©ë˜ëŠ” ìš”ì²­ í—¤ë”</li>
  <li><code class="language-plaintext highlighter-rouge">Access-Control-Max-Age</code>: Preflight ìºì‹± ì‹œê°„</li>
</ul>

<p>ì´ì œ ë“œë””ì–´ <code class="language-plaintext highlighter-rouge">GET</code>, <code class="language-plaintext highlighter-rouge">POST</code>, <code class="language-plaintext highlighter-rouge">PUT</code>, <code class="language-plaintext highlighter-rouge">DELETE</code> ë¥¼ ì“¸ ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">PUT /api/products/1 HTTP/1.1
Origin: http://localhost:3000
Content-Type: application/json

{
  "name": "ìƒˆ ì œí’ˆ"
}</code></pre></figure>

<h5 id="ì „ì²´-íë¦„">ì „ì²´ íë¦„</h5>

<p>ì„œë²„ A(REST API ì„œë²„), ìœ ì € ê°€ ìˆë‹¤ê³  í•˜ì. ì´ì œ ì „ë°˜ì ì¸ íë¦„ì„ ë³¸ë‹¤.</p>

<p><strong>ë‹¨ìˆœ GET, POST, HEAD</strong></p>
<ol>
  <li>ë¸Œë¼ìš°ì €ê°€ ìš”ì²­
    <ul>
      <li>ë‹¨ìˆœ ìš”ì²­ ì œì•½ì„ ë§Œì¡±í•˜ë„ë¡ ìš”ì²­ì„ ë³´ë‚¸ë‹¤:</li>
      <li><code class="language-plaintext highlighter-rouge">Content-Type</code>: <code class="language-plaintext highlighter-rouge">text/plain</code> ë˜ëŠ” ìœ„ì˜ ì œì•½ì¡°ê±´ ë”°ë¥´ë„ë¡, ì•„ì˜ˆ ì—†ì–´ë„ë¨</li>
      <li>ì‚¬ìš©ì ì •ì˜ í—¤ë” X</li>
    </ul>
  </li>
  <li>ì„œë²„ A ê°€ ì‘ë‹µ
    <ul>
      <li>ë‹¨ìˆœ ìš”ì²­ ì¡°ê±´ì„ ë§Œì¡±í•˜ë¯€ë¡œ Preflilght ì—†ì´ ë°”ë¡œ ì„œë²„ ìš”ì²­</li>
      <li>ë¸Œë¼ìš°ì €ê°€ <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code> ì„ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ì‘ë‹µì„ ë³´ë‚´ê²Œ ë¨</li>
    </ul>
  </li>
  <li>ë¸Œë¼ìš°ì €ê°€ ë°›ìŒ
    <ul>
      <li>ë°›ì„ ë•Œ Origin ì´ í—ˆìš©ë˜ì–´ ìˆë‹¤ë©´ ë¸Œë¼ìš°ì €ëŠ” ë°ì´í„°ë¥¼ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê²Œ ë˜ê³ </li>
      <li>ë¸Œë¼ìš°ì € ìì²´ì—ì„œ í—ˆìš©ë˜ì§€ ì•ŠëŠ” Origin ì´ë¼ë©´ CORS ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ê²Œ ëœë‹¤.</li>
    </ul>
  </li>
</ol>

<p><strong>ì‚¬ì „ OPTIONS ì´ í•„ìš”í•œ PUT, DELETE, PATCH</strong></p>

<ol>
  <li>ë¸Œë¼ìš°ì €ê°€ Preflight(OPTIONS) ì „ì†¡
    <ul>
      <li>ë¸Œë¼ìš°ì €ëŠ” ì‹¤ì œ ìš”ì²­(PUT, DELETE, PATCH) ë¥¼ ë³´ë‚´ê¸° ì „ì— ì„œë²„ê°€ ì´ìš”ì²­ì„ í—ˆìš©í•˜ëŠ”ì§€ ë¯¸ë¦¬ í™•ì¸í•˜ê¸° ìœ„í•´ ìë„ìœ¼ë¡œ OPTIONS ìš”ì²­ì„ ë³´ëƒ„</li>
    </ul>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-text" data-lang="text">OPTIONS /api/products/1 HTTP/1.1
Origin: http://localhost:3000
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: Content-Type, Authorization</code></pre></figure>

<ol>
  <li>ì„œë²„ Aê°€ OPTIONS ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ ì „ì†¡
    <ul>
      <li>ì´ë•Œ ì´ ì‘ë‹µì´ ìœ íš¨í•´ì•¼ë§Œ ë¸Œë¼ìš°ì €ê°€ ì‹¤ì œ ìš”ì²­(2ë‹¨ê³„) ë¡œ ë„˜ì–´ê°</li>
      <li>í•˜ë‚˜ë¼ë„ ëˆ„ë½ë˜ë©´ CORS ì—ëŸ¬ ë°œìƒ</li>
    </ul>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-text" data-lang="text">HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://localhost:3000
Access-Control-Allow-Methods: GET, POST, PUT, DELETE, PATCH
Access-Control-Allow-Headers: Content-Type, Authorization
Access-Control-Max-Age: 3600</code></pre></figure>

<ol>
  <li>ë¸Œë¼ìš°ì €ê°€ ì‹¤ì œ ìš”ì²­ ì „ì†¡
    <ul>
      <li>Preflight ì‘ë‹µì´ ìœ íš¨í•˜ë©´, ì´ì œ ë¸Œë¼ìš°ì €ëŠ” ì§„ì§œ ìš”ì²­ì„ ë³´ë‚´ê²Œ ëœë‹¤.</li>
    </ul>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-text" data-lang="text">PUT /api/products/1 HTTP/1.1
Origin: http://localhost:3000
Content-Type: application/json
Authorization: Bearer 123456

{
  "name": "ìƒˆ ì œí’ˆ"
}</code></pre></figure>

<ol>
  <li>ì„œë²„ Aê°€ ì‹¤ì œ ì‘ë‹µ ì „ì†¡</li>
</ol>

<figure class="highlight"><pre><code class="language-text" data-lang="text">HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://localhost:3000
Content-Type: application/json

{
  "id": 1,
  "name": "ìƒˆ ì œí’ˆ"
}</code></pre></figure>

<ol>
  <li>ë¸Œë¼ìš°ì €ê°€ ì‘ë‹µ ì²˜ë¦¬
    <ul>
      <li>ì‘ë‹µì˜ Access-Control-Allow-Origin í—¤ë”ë¥¼ ë¨¼ì € ì½ì–´ì„œ ìì‹ ì˜ Origin ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  ë§ë‹¤ë©´ ë°ì´í„° ì ‘ê·¼ì„ í•œë‹¤.</li>
    </ul>
  </li>
</ol>

<h4 id="csrf">CSRF</h4>

<p>CSRF(Cross-Site Request Forgery, ì‚¬ì´íŠ¸ ê°„ ìš”ì²­ ìœ„ì¡°)ëŠ” ì‚¬ìš©ìê°€ ì¸ì¦ëœ ì„¸ì…˜ ìƒíƒœì— ìˆì„ ë•Œ, ê³µê²©ìê°€ ì‚¬ìš©ìë¥¼ ì†ì—¬ ì•…ì˜ì ì¸ ìš”ì²­ì„ ëŒ€ì‹  ë³´ë‚´ê²Œ í•˜ëŠ” ê³µê²©ì´ë‹¤. ìš”ì²­ì´ ì •ìƒì ì¸ ì‚¬ìš©ìì˜ ì¿ í‚¤ë¥¼ í¬í•¨í•˜ë¯€ë¡œ ì§„ì§œ ìš”ì²­ì²˜ëŸ¼ ë³´ì´ê²Œ ëœë‹¤. ê³µê²½ë‹¹í•˜ê²Œ ë˜ëŠ” ê³¼ì •ì„ ë³´ì.</p>

<ol>
  <li>ì‚¬ìš©ìëŠ” <code class="language-plaintext highlighter-rouge">https://bank.com</code> ì— ë¡œê·¸ì¸ ëœ ìƒíƒœ(ì„¸ì…˜ ì¿ í‚¤ë¥¼ ì–»ì€ ìƒíƒœ)
    <ul>
      <li>sessionId = abc123</li>
    </ul>
  </li>
  <li>ê³µê²©ìê°€ ë§Œë“  ì‚¬ì´íŠ¸ëŠ” <code class="language-plaintext highlighter-rouge">https://evil.com</code></li>
  <li>ê·¸ ìƒíƒœë¡œ ê³µê²©ì ì‚¬ì´íŠ¸ ìš°ì—°íˆ ì ‘ì†(<code class="language-plaintext highlighter-rouge">evil.com</code>)</li>
  <li><code class="language-plaintext highlighter-rouge">evil.com</code> ì— ë‹¤ìŒ HTML ì´ ìˆ¨ì–´ ìˆë‹¤ê³  ê°€ì •
    <ul>
      <li><code class="language-plaintext highlighter-rouge">&lt;img src="https://bank.com/transfer?to=hacker&amp;amount=100000" /&gt;</code></li>
    </ul>
  </li>
  <li>ë¸Œë¼ìš°ì €ëŠ” ì´ë¯¸ <code class="language-plaintext highlighter-rouge">bank.com</code> ì˜ ì¿ í‚¤(<code class="language-plaintext highlighter-rouge">sessionId=abc123</code>) ì„ ì €ì¥í•˜ê³  ìˆê¸° ë•Œë¬¸ì—
    <ul>
      <li>ìë™ìœ¼ë¡œ ì´ ì¿ í‚¤ë¥¼ í¬í•¨í•œ GET ìš”ì²­ì„ <code class="language-plaintext highlighter-rouge">https://bank.com</code> ìœ¼ë¡œ ë³´ë‚´ê²Œ ë¨</li>
    </ul>
  </li>
  <li>ì„œë²„ëŠ” ì •ìƒ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ìš”ì²­ìœ¼ë¡œ ì¸ì‹í•˜ê²Œ ë˜ê³ , ì†¡ê¸ˆì„ ìˆ˜í–‰í•¨</li>
</ol>

<p>ì´ë¥¼ ë°©ì–´í•˜ëŠ” ë°©ë²•ì´ CSRF í† í°ì´ë©° ê°€ì¥ ì¼ë°˜ì ì¸ ë°©ë²•ì´ë‹¤.</p>

<h5 id="csrf-í† í°">CSRF í† í°</h5>

<ul>
  <li>ì„œë²„ê°€ í¼ì„ ë Œë”ë§í•  ë•Œ ë‚œìˆ˜ í† í°ì„ í¬í•¨ì‹œí‚¤ê³ </li>
  <li>í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ ì‹œ ì´ í† í°ì„ í•¨ê»˜ ì „ì†¡í•´ì•¼ë§Œ ìœ íš¨í•œ ìš”ì²­ìœ¼ë¡œ ì¸ì •í•˜ê²Œ ëœë‹¤.</li>
  <li>ê³µê²©ìëŠ” í† í° ê°’ì„ ëª¨ë¥´ë¯€ë¡œ ìœ„ì¡°ê°€ ë¶ˆê°€í•˜ë‹¤</li>
</ul>

<p><strong>ì˜ˆì‹œ</strong></p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/transfer"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_csrf"</span> <span class="na">value=</span><span class="s">"a1b2c3d4e5f6"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"to"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;button&gt;</span>ì†¡ê¸ˆ<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span></code></pre></figure>

<p>ì´ëŠ” Spring Security ì—ì„œ ë‹¤ë£¨ì.</p>

<h5 id="samesite-cookie-ì„¤ì •">SameSite Cookie ì„¤ì •</h5>

<p>ë¸Œë¼ìš°ì € ì¿ í‚¤ì˜ <code class="language-plaintext highlighter-rouge">SameSite</code> ì†ì„±ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">Cross-Site</code> ìš”ì²­ì—ì„œ ì¿ í‚¤ ìë™ ì „ì†¡ì„ ì œí•œí•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.</p>

<figure class="highlight"><pre><code class="language-http" data-lang="http"><span class="err">Set-Cookie: sessionId=abc123; SameSite=Lax; Secure; HttpOnly</span></code></pre></figure>

<h5 id="referer--origin-ê²€ì¦">Referer / Origin ê²€ì¦</h5>

<p>ì„œë²„ë‹¨ì—ì„œ í•  ìˆ˜ ìˆëŠ” ë³´ì•ˆì´ë©°, ì„œë²„ê°€ ìš”ì²­ì˜ Origin í˜¹ì€ Referer í—¤ë”ë¥¼ ë³´ê³  í—ˆìš©ëœ ë„ë©”ì¸ì—ì„œ ì˜¨ ìš”ì²­ë§Œ ì²˜ë¦¬í•˜ë„ë¡ ê²€ì¦í•œë‹¤.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Set</span><span class="o">-</span><span class="nl">Cookie:</span> <span class="n">sessionId</span><span class="o">=</span><span class="n">abc123</span><span class="o">;</span> <span class="nc">SameSite</span><span class="o">=</span><span class="nc">Lax</span><span class="o">;</span> <span class="nc">Secure</span><span class="o">;</span> <span class="nc">HttpOnly</span></code></pre></figure>

<h3 id="spring-hateoas-ì‹¬í™”">Spring HATEOAS ì‹¬í™”</h3>

<p>HATEOAS (Hypermedia as the Engine of Application State)ëŠ” RESTì˜ ë§ˆì§€ë§‰ ë‹¨ê³„(â€œREST Level 3â€)ë¡œ, API ì‘ë‹µ ì•ˆì— ë§í¬ ì •ë³´ë¥¼ í¬í•¨í•´ì„œ í´ë¼ì´ì–¸íŠ¸ê°€ â€œë‹¤ìŒ í–‰ë™â€ì„ API ë¬¸ì„œ ì—†ì´ë„ ìœ ë„í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°œë…ì´ë‹¤.</p>

<p>ê¸°ë³¸ì ì¸ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<p><strong>Mapping Method</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">EntityModel</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getUser</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

    <span class="kt">var</span> <span class="n">userModel</span> <span class="o">=</span> <span class="nc">EntityModel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="n">userModel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">linkTo</span><span class="o">(</span><span class="n">methodOn</span><span class="o">(</span><span class="nc">UserController</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getUser</span><span class="o">(</span><span class="n">id</span><span class="o">)).</span><span class="na">withSelfRel</span><span class="o">());</span>
    <span class="n">userModel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">linkTo</span><span class="o">(</span><span class="n">methodOn</span><span class="o">(</span><span class="nc">UserController</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getOrdersByUser</span><span class="o">(</span><span class="n">id</span><span class="o">)).</span><span class="na">withRel</span><span class="o">(</span><span class="s">"orders"</span><span class="o">));</span>

    <span class="k">return</span> <span class="n">userModel</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<p><strong>ì‘ë‹µ</strong></p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"í™ê¸¸ë™"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"self"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080/api/users/1"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="nl">"orders"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080/api/users/1/orders"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p><strong>ì£¼ìš” í´ë˜ìŠ¤</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">EntityModel&lt;T&gt;</code>: ë‹¨ì¼ ë¦¬ì†ŒìŠ¤ì— ë§í¬ ì¶”ê°€</li>
  <li><code class="language-plaintext highlighter-rouge">CollectionModel&lt;T&gt;</code>: ì—¬ëŸ¬ ë¦¬ì†ŒìŠ¤(ë¦¬ìŠ¤íŠ¸)ì— ê³µí†µ ë§í¬ ì¶”ê°€</li>
  <li><code class="language-plaintext highlighter-rouge">PagedModel&lt;T&gt;</code>: íŒ¨ì´ì§• ì²˜ë¦¬ëœ ë¦¬ì†ŒìŠ¤ ì‘ë‹µ</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.example.resthateoasexam</span><span class="o">;</span>

<span class="kd">public</span> <span class="n">record</span> <span class="nf">Memo</span><span class="o">(</span>
		<span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
		<span class="nc">String</span> <span class="n">content</span>
<span class="o">)</span> <span class="o">{</span> <span class="o">}</span></code></pre></figure>

<p>ìœ„ë¥¼ í† ëŒ€ë¡œ ê³„ì† ì§„í–‰í•´ë³´ì.</p>

<h4 id="hateoas-representation-model">HATEOAS Representation Model</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@PostMapping</span><span class="o">(</span><span class="n">consumes</span> <span class="o">=</span> <span class="s">"text/plain"</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Memo</span><span class="o">&gt;</span> <span class="nf">createMemo</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">content</span><span class="o">.</span><span class="na">isBlank</span><span class="o">())</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">BAD_REQUEST</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
    <span class="kt">long</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">memos</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="kt">var</span> <span class="n">memo</span> <span class="o">=</span> <span class="n">memos</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">idx</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Memo</span><span class="o">(</span><span class="n">idx</span><span class="o">,</span> <span class="n">content</span><span class="o">));</span>

    <span class="no">URI</span> <span class="n">location</span> <span class="o">=</span> <span class="nc">ServletUriComponentsBuilder</span><span class="o">.</span><span class="na">fromCurrentRequest</span><span class="o">()</span>
                                                <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
                                                <span class="o">.</span><span class="na">buildAndExpand</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="n">idx</span><span class="o">)</span>
                                                <span class="o">.</span><span class="na">toUri</span><span class="o">();</span>

    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">created</span><span class="o">(</span><span class="n">location</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">memo</span><span class="o">);</span>
<span class="o">}</span> </code></pre></figure>

<p>ìœ„ëŠ” ì „í˜•ì ì¸ create ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì´ë‹¤. ì´ë•Œ <code class="language-plaintext highlighter-rouge">Memo</code> ì™€ <code class="language-plaintext highlighter-rouge">ResponseEntity</code> ì¤‘ê°„ì— <code class="language-plaintext highlighter-rouge">EntityModel</code> ì„ í•œ ë²ˆ ë” ê°ì‹¸ì„œ ì²˜ë¦¬í•´ì£¼ë©´ ëœë‹¤. ì—¬ê¸°ì„œ <code class="language-plaintext highlighter-rouge">URI</code> ë¥¼ ì§ì ‘ ë§Œë“¤ê³  ë„£ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆëŠ”ë° ì´ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë°”ê¿€ ìˆ˜ ìˆë‹¤.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@PostMapping</span><span class="o">(</span><span class="n">consumes</span> <span class="o">=</span> <span class="s">"text/plain"</span><span class="o">,</span>
             <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">EntityModel</span><span class="o">&lt;</span><span class="nc">MemoResponseDTO</span><span class="o">&gt;&gt;</span> <span class="nf">createMemo</span><span class="o">(</span>
        <span class="nd">@RequestBody</span> <span class="nc">String</span> <span class="nc">Memo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">memo</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">isBlank</span><span class="o">())</span> <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">badRequest</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

    <span class="nc">MemoResponseDTO</span> <span class="n">response</span> <span class="o">=</span> <span class="n">memoService</span><span class="o">.</span><span class="na">createMemo</span><span class="o">(</span><span class="n">memo</span><span class="o">);</span>

    <span class="no">URI</span> <span class="n">location</span> <span class="o">=</span> <span class="nc">UriComponentsBuilder</span><span class="o">.</span><span class="na">fromUriString</span><span class="o">(</span><span class="s">"/api/memos/"</span><span class="o">)</span>
                                        <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
                                        <span class="o">.</span><span class="na">buildAndExpand</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">id</span><span class="o">())</span>
                                        <span class="o">.</span><span class="na">toUri</span><span class="o">();</span>

    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">created</span><span class="o">(</span><span class="n">location</span><span class="o">)</span>
                         <span class="o">.</span><span class="na">eTag</span><span class="o">(</span><span class="n">getETag</span><span class="o">(</span><span class="n">response</span><span class="o">).</span><span class="na">toString</span><span class="o">())</span>
                         <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">wrap</span><span class="o">(</span><span class="n">response</span><span class="o">));</span>
<span class="o">}</span>
<span class="c1">// ...</span>
<span class="kd">private</span> <span class="nc">EntityModel</span><span class="o">&lt;</span><span class="nc">MemoResponseDTO</span><span class="o">&gt;</span> <span class="nf">wrap</span><span class="o">(</span><span class="nc">MemoResponseDTO</span> <span class="n">dto</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">EntityModel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">dto</span><span class="o">)</span>
                      <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">linkTo</span><span class="o">(</span><span class="no">MEMO_CTRL</span><span class="o">.</span><span class="na">createMemo</span><span class="o">(</span><span class="s">"This is create function"</span><span class="o">))</span>
                                  <span class="o">.</span><span class="na">withRel</span><span class="o">(</span><span class="s">"createMemo"</span><span class="o">))</span>
                      <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">linkTo</span><span class="o">(</span><span class="no">MEMO_CTRL</span><span class="o">.</span><span class="na">getMemo</span><span class="o">(</span><span class="n">dto</span><span class="o">.</span><span class="na">id</span><span class="o">(),</span> <span class="kc">null</span><span class="o">))</span>
                                  <span class="o">.</span><span class="na">withRel</span><span class="o">(</span><span class="s">"getMemo"</span><span class="o">))</span>
                      <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">linkTo</span><span class="o">(</span><span class="no">MEMO_CTRL</span><span class="o">.</span><span class="na">getMemos</span><span class="o">(</span><span class="kc">null</span><span class="o">))</span>
                                  <span class="o">.</span><span class="na">withRel</span><span class="o">(</span><span class="s">"getMemos"</span><span class="o">))</span>
                      <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">linkTo</span><span class="o">(</span><span class="no">MEMO_CTRL</span><span class="o">.</span><span class="na">updateMemo</span><span class="o">(</span><span class="n">dto</span><span class="o">.</span><span class="na">id</span><span class="o">(),</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">))</span>
                                  <span class="o">.</span><span class="na">withRel</span><span class="o">(</span><span class="s">"updateMemo"</span><span class="o">))</span>
                      <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">linkTo</span><span class="o">(</span><span class="no">MEMO_CTRL</span><span class="o">.</span><span class="na">deleteMemo</span><span class="o">(</span><span class="n">dto</span><span class="o">.</span><span class="na">id</span><span class="o">(),</span> <span class="kc">null</span><span class="o">))</span>
                                  <span class="o">.</span><span class="na">withRel</span><span class="o">(</span><span class="s">"deleteMemo"</span><span class="o">));</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">ETag</span> <span class="nf">getETag</span><span class="o">(</span><span class="nc">MemoResponseDTO</span> <span class="n">dto</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">eTagValue</span> <span class="o">=</span> <span class="s">"\""</span> <span class="o">+</span> <span class="n">dto</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\""</span><span class="o">;</span>
    <span class="k">return</span> <span class="nc">ETag</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">eTagValue</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<h4 id="globalexceptionhandler">GlobalExceptionHandler</h4>

<p>ì´ì œ <code class="language-plaintext highlighter-rouge">RestControllerAdvice</code> ì–´ë…¸í…Œì´ì…˜ì„ ë³¼ ê²ƒì´ë‹¤. ì´ì „ì— ë´¤ë‹¤ì‹œí”¼ <code class="language-plaintext highlighter-rouge">ControllerAdvice</code> ë„ ìˆê³  ì´ì™€ ìœ ì‚¬í•˜ë‹¤.</p>

<p><strong>ë™ì‘</strong></p>

<ol>
  <li>ì˜ˆì™¸ ë°œìƒ
    <ul>
      <li>í´ë¼ì´ì–¸íŠ¸ê°€ API ë¥¼ ìš”ì²­í•œ í›„</li>
      <li><strong>ì„œë¹„ìŠ¤ë‚˜ ì»¨íŠ¸ë¡¤ëŸ¬</strong> ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒ</li>
    </ul>
  </li>
  <li>ì˜ˆì™¸ íƒìƒ‰
    <ul>
      <li>Spring MVC ëŠ” <code class="language-plaintext highlighter-rouge">HandlerExceptionResolver</code> ì²´ì¸ì„ í†µí•´ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬</li>
      <li><code class="language-plaintext highlighter-rouge">@ControllerAdvice</code> í˜¹ì€ <code class="language-plaintext highlighter-rouge">@RestControllerAdvice</code> ê°€ ìˆëŠ” í´ë˜ìŠ¤ ì¤‘ì—ì„œ
        <ul>
          <li><code class="language-plaintext highlighter-rouge">@ExceptionHandler</code> ë¡œ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œê°€ ìˆëŠ”ì§€ íƒìƒ‰</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ì˜ˆì™¸ ì²˜ë¦¬ ë©”ì„œë“œ í˜¸ì¶œ
    <ul>
      <li>ì´ë•Œ ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ ì˜ˆì™¸ ê°ì²´ë¥¼ ì¸ìë¡œ ì£¼ì…ì‹œì¼œì¤€ë‹¤.</li>
      <li>ëŒ€ë¶€ë¶„ì˜ ì—ëŸ¬ ì‘ë‹µì€ <code class="language-plaintext highlighter-rouge">ErrorResponse</code> ì¸í„°í˜ì´ìŠ¤ ë‚´ë¶€ì˜ <code class="language-plaintext highlighter-rouge">builder()</code> ë¡œ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">ErrorResponse</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">ex</span><span class="o">,</span> <span class="nc">HttpStatusCode</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">404</span><span class="o">),</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">())</span>
             <span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="s">"Resource Not Found"</span><span class="o">)</span>
             <span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"timestamp"</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">())</span>
             <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre></figure>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">ErrorResponse</code> ëŠ” Spring 6ë¶€í„° ë„ì…ë˜ì—ˆë‹¤. Spring í‘œì¤€ì¸ <code class="language-plaintext highlighter-rouge">ProblemDetail</code> ê¸°ë°˜ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">RFC 9457</code> ê·œê²©ì˜ JSON ì‘ë‹µì„ ë§Œë“œëŠ” ë°©ì‹ì´ë¼ ì›¹ ê·œì•½ì— ë§ì•„ ì ì ˆí•œ ì—ëŸ¬ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.</p>
</blockquote>

<p><strong>ì˜ˆì‹œ</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RestControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="o">{</span>

	<span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">ResourceNotFoundException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">ErrorResponse</span> <span class="nf">handleNotFound</span><span class="o">(</span>
			<span class="nc">ResourceNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nc">ErrorResponse</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="nc">HttpStatusCode</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">404</span><span class="o">),</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">())</span>
				<span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="s">"Resource Not Found"</span><span class="o">)</span>
				<span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"timestamp"</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">())</span>
				<span class="o">.</span><span class="na">build</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">ErrorResponse</span> <span class="nf">handleGeneral</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nc">ErrorResponse</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">ex</span><span class="o">,</span> <span class="nc">HttpStatusCode</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">500</span><span class="o">),</span> <span class="s">"Internal server error"</span><span class="o">)</span>
		                    <span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="s">"Server Error"</span><span class="o">)</span>
		                    <span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"timestamp"</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">())</span>
		                    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>


    </div><div id="disqus_thread" style="margin-top:25px"></div>
    <script>
    var disqus_config = function () {
        this.page.url = 'https://seonghun120614.github.io/seonghun120614/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC/%EB%A9%8B%EC%82%AC/%EB%B0%B1%EC%97%94%EB%93%9C/til/java/spring/2025/10/30/%EB%A9%8B%EC%82%AC-%EB%B0%B1%EC%97%94%EB%93%9C-19%EA%B8%B0-til-46%EC%9D%BC%EC%B0%A8-rest-api-2.html';
        this.page.identifier = 'https://seonghun120614.github.io/seonghun120614/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC/%EB%A9%8B%EC%82%AC/%EB%B0%B1%EC%97%94%EB%93%9C/til/java/spring/2025/10/30/%EB%A9%8B%EC%82%AC-%EB%B0%B1%EC%97%94%EB%93%9C-19%EA%B8%B0-til-46%EC%9D%BC%EC%B0%A8-rest-api-2.html';
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://seonghun.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
  </script>
    <noscript>Please enable JavaScript to view the <a
            href="https://disqus.com/?ref_noscript" rel="nofollow">comments
            powered by Disqus.</a></noscript></div>
<script>
    mermaid.initialize({startOnLoad:true});
    window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
</script>
            </section>
            <footer class="condensed">
                <ul class="social about-footer condensed"><li>
                        <a
                            href="https://github.com/seonghun120614"
                            target="_blank"
                            rel="noopener"
                            aria-label="github">
                            <i class="icon-github-circled"></i>
                        </a>
                    </li><li>
                        <a
                            href="mailto:seonghun120614@gmail.com"
                            target="_blank" rel="noopener" aria-label="email">
                            <i class="icon-mail-alt"></i>
                        </a>
                    </li></ul><nav class="navigation about-footer condensed">
                    <ul>
                        
                        <li>
                            <a href="/seonghun120614/about">About Me</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/computerscience">Computer Science</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/math">Math</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/softwareengineering">Software Engineering</a>
                        </li>
                        
                    </ul>
                </nav><p class="about-footer condensed">&copy;
                    2025</p><div class="about-footer condensed">
                    <p>Dark Mode
                        <i class="icon-moon"></i>
                        <label class="switch" for="dark-toggle">
                            <input id="dark-toggle" type="checkbox"
                                class="dark-mode-toggle"
                                aria-label="Toggle dark mode">
                            <span class="slider round"
                                onclick="toggleDarkMode()"></span>
                        </label>
                    </p>
                </div>
            </footer>
        </main>
        
        <script type="text/javascript" src="/seonghun120614/assets/js/darkmode.js"></script>
        
        <script src="/seonghun120614/assets/js/simple-jekyll-search.min.js"></script>
        <script src="/seonghun120614/assets/js/search.js"></script>
        
        <script>
            window.addEventListener('scroll', () => {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = (scrollTop / docHeight) * 100;
                document.getElementById('scroll-progress').style.width = scrollPercent + '%';
            });
        </script>
    </body>
</html>