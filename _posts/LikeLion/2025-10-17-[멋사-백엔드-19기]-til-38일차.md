---
layout: post
title:  "[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 38ì¼ì°¨ Spring MVC ì‹¬í™”"
date:   2025-10-17 13:12:51 +0900
categories: ë©‹ìŸì´ì‚¬ìì²˜ëŸ¼ ë©‹ì‚¬ ë°±ì—”ë“œ TIL Java Spring
---

<!--more-->

## ğŸ“‚ ëª©ì°¨
- [Cookie](#cookie)
    - [Cookie ì˜ êµ¬ì„±ìš”ì†Œ](#cookie-ì˜-êµ¬ì„±ìš”ì†Œ)
    - [Spring ì—ì„œ Cookie ë‹¤ë£¨ê¸°](#spring-ì—ì„œ-cookie-ë‹¤ë£¨ê¸°)
        - [setHttpOnly](#sethttponly)
        - [setSecure](#setsecure)
        - [setSameSite](#setsamesite)
- [Session](#session)
    - [Session ë™ì‘ ì›ë¦¬](#session-ë™ì‘-ì›ë¦¬)
        - [Session ìƒì„±](#session-ìƒì„±)
    - [Session êµ¬ì¡°](#session-êµ¬ì¡°)
    - [Session í™œìš© ì˜ˆì‹œ](#session-í™œìš©-ì˜ˆì‹œ)
- [Exception Handling](#exception-handling)
    - [ExceptionHandler ê·œì¹™](#exceptionhandler-ê·œì¹™)

---

## ğŸ“š ë³¸ë¬¸

### Cookie

ì›¹ ë¸Œë¼ìš°ì €ì™€ ì„œë²„ ì‚¬ì´ì—ì„œ ì •ë³´ë¥¼ ì‘ê³  ë‹¨ìˆœí•œ ë¬¸ìì—´ í˜•íƒœë¡œ ì €ì¥í•˜ê³  ì£¼ê³  ë°›ëŠ” ë°©ë²•ì´ë©°, ì„œë²„ê°€ ë¸Œë¼ìš°ì €ì— ë°ì´í„°ë¥¼ ì ê¹ ê¸°ì–µí•´ë‹¬ë¼ê³  ìš”ì²­í•˜ë©´ ë¸Œë¼ìš°ì €ëŠ” ì´ë¥¼ ë¡œì»¬ì— ì €ì¥í•˜ê³  ê°™ì€ ë„ë©”ì¸ìœ¼ë¡œ ìš”ì²­í•  ë•Œë§ˆë‹¤ ì„œë²„ì— ë‹¤ì‹œ ì „ë‹¬í•˜ê²Œ ëœë‹¤.

**ìš©ë„**
- ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€(Session ID ì €ì¥)
- ì‚¬ìš©ì ì„ í˜¸ ì„¤ì • ì €ì¥(ì–¸ì–´, í…Œë§ˆ)
- íŠ¸ë˜í‚¹ ë° ë¶„ì„(ë°©ë¬¸ ê¸°ë¡, ì¥ë°”êµ¬ë‹ˆ ì •ë³´)

ì„œë²„ì¸¡ì—ì„œëŠ” ì‘ë‹µìœ¼ë¡œ ë³´ë‚¼ë•Œ ì¿ í‚¤ë¥¼ ì €ì¥í•´ë‹¬ë¼ê³  ìš”ì²­í•  ìˆ˜ ìˆê³ , ê·¸ë•Œ HTTP ì—ëŠ” `Set-Cookie` í—¤ë”ê°€ í¬í•¨ë˜ê²Œ ëœë‹¤. ì´í›„ì— ë¸Œë¼ìš°ì €ê°€ ìš”ì²­ì„ ì„œë²„ì— í•œë‹¤ë©´ ìë™ìœ¼ë¡œ ì´ ì¿ í‚¤ë“¤ì´ ì „ì†¡ë˜ê²Œ ëœë‹¤.

**ì„œë²„ -> ë¸Œë¼ìš°ì € Set-Cookie í—¤ë”**
{% highlight text %}
Set-Cookie: userId=park123; Path=/; Max-Age=3600; HttpOnly; Secure
{% endhighlight %}

**ë¸Œë¼ìš°ì € -> ì„œë²„ Cookie**
{% highlight text %}
Cookie: userId=park123
{% endhighlight %}

> HTTP ìƒíƒœë¥¼ ë³´ì¡´í•˜ëŠ” ê°€ì¥ ë‚®ì€ ë ˆë²¨ì˜ ë©”ì»¤ë‹ˆì¦˜ì´ ë°”ë¡œ Cookie ì´ë‹¤.

#### Cookie ì˜ êµ¬ì„±ìš”ì†Œ

- `Name`: ì´ë¦„
- `Value`: ê°’
- `Domain`: ì¿ í‚¤ê°€ ì ìš©ë  ë„ë©”ì¸
- `Path`: ì¿ í‚¤ê°€ ì ìš©ë  ê²½ë¡œ
- `Max-Age`: ì¿ í‚¤ ìœ íš¨ê¸°ê°„(-1 ì´ë©´ ì°½ì„ ê»ë‹¤ í‚¤ë©´ ì‚¬ë¼ì§€ëŠ” ì˜µì…˜)
- `Secure`: HTTPS ì—ì„œë§Œ ì „ì†¡
- `HttpOnly`: JS ì—ì„œ ì ‘ê·¼ ë¶ˆê°€, XSS ë°©ì–´ìš©
- `SameSite`: CSRF ê³µê²© ë°©ì§€(`Strict`, `Lax`, `None`)

#### Spring ì—ì„œ Cookie ë‹¤ë£¨ê¸°

**@CookieValue ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ì½ì–´ì˜¤ê¸°**
{% highlight java %}
@GetMapping("/viewCookie")
public String viewCookie(@CookieValue(value = "userId", required = false) String userId,
                         Model model) {
    model.addAttribute("userId", userId);
    return "cookie_view";
}
{% endhighlight %}

> ë¸Œë¼ìš°ì €ì— ì¿ í‚¤ê°€ ì €ì¥ë˜ì–´ ìˆê³  `userId` ë¼ëŠ” ì´ë¦„ì˜ ì¿ í‚¤ê°€ ìˆë‹¤ë©´ ë“¤ê³ ì˜´ ì—†ìœ¼ë©´ `null`

**ì¿ í‚¤ ìƒì„± ë° ì €ì¥**
{% highlight java %}
@PostMapping("/addCookie")
public String addCookie(CookieRequest cookieRequest, /* @ModelAttribute ìƒëµ ê°€ëŠ¥ */
                        HttpServletResponse response) {

    Cookie cookie = new Cookie(cookieRequest.cookieName(), cookieRequest.cookieValue());
    cookie.setPath("/");
    cookie.setMaxAge(-1);

    response.addCookie(cookie);

    return "redirect:/viewCookie";
}
{% endhighlight %}

> `@ModelAttribute` ëŠ” í•˜ë‚˜ì˜ object ë§Œì´ ìš”ì²­ìœ¼ë¡œ ì˜¤ê²Œ ë˜ë©´ ìƒëµì´ ê°€ëŠ¥í•˜ë‹¤.

**ì¿ í‚¤ ì‚­ì œ**
{% highlight java %}
@GetMapping("/delCookie")
public String deleteCookie(HttpServletResponse response) {
    Cookie cookie = new Cookie("userId", null);
    cookie.setMaxAge(0); // ë§Œë£Œ
    cookie.setPath("/");
    response.addCookie(cookie);
    return "cookie_deleted";
}
{% endhighlight %}

> ë¸Œë¼ìš°ì €ì—ì„œ ì¿ í‚¤ë¥¼ ì œê±°í•˜ë ¤ë©´ ê°™ì€ ì´ë¦„, ê°™ì€ `Path`, `MaxAge=0` ìœ¼ë¡œ ë‹¤ì‹œ ë³´ë‚´ì•¼ í•¨

##### setHttpOnly

ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì¿ í‚¤ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ì°¨ë‹¨í•œë‹¤. ì¦‰, `document.cookie` ë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œ ëœë‹¤.

- `XSS` ê³µê²© ë°©ì§€ìš©
- `SessionID` ê°€ ë“œëŸ¬ë‚˜ì§€ ì•Šë„ë¡



##### setSecure

HTTPS ì—°ê²°ì—ì„œë§Œ ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ë„ë¡ ì œí•œì„í•˜ë©°, HTTP ìš”ì²­ì—ì„œëŠ” ì´ ì¿ í‚¤ê°€ ì „ì†¡ë˜ì§€ ì•ŠëŠ”ë‹¤.

- ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œ ì¿ í‚¤ê°€ ë…¸ì¶œë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê³ 
- HTTP ì˜ ì•”í˜¸í™” ë¶€ì¬ë¡œ, ëˆ„êµ°ê°€ íŠ¸ë˜í”½ ê°ì²­ ì‹œ ì„¸ì…˜ID ê°€ ë…¸ì¶œë˜ë©´ ì•ˆëœë‹¤

##### setSameSite

`CSRF` ê³µê²© ë°©ì§€ë¥¼ ìœ„í•´ ì¿ í‚¤ê°€ ì–´ë–¤ ìš”ì²­ ìƒí™©ì—ì„œ ì „ì†¡ë  ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì œí•œí•˜ëŠ” ì˜µì…˜ì´ë‹¤. ê¸°ë³¸ê°’ì€ `Lax` ì´ë‹¤.

> `CSRF` ëŠ” ìš”ì²­ì„ ë³´ë‚¸ í˜ì´ì§€ì˜ ë„ë©”ì¸ ê³¼ ìš”ì²­ì„ ë°›ëŠ” ì„œë²„ì˜ ë„ë©”ì¸ì´ ë‹¤ë¥¼ ìˆ˜ ìˆëŠ”ë° ì´ëŸ´ë•Œ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìš”ì²­ì´ë¼ê³  í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ì‚¬ì´íŠ¸ì˜ ìš”ì²­ì€ ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ì§€ ì•ŠëŠ”ë‹¤.

### Session

ì›¹ì—ì„œ `HTTP` ëŠ” `stateless` í”„ë¡œí† ì½œì´ë‹¤. ì¦‰, ìš”ì²­ -> ì‘ë‹µ ì‚¬ì´ì— ì„œë²„ëŠ” ì‚¬ìš©ìë¥¼ ê¸°ì–µí•˜ì§€ ëª»í•˜ëŠ”ë°, ëŒ€ë¶€ë¶„ì˜ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì‚¬ìš©ì ìƒíƒœ ìœ ì§€ê°€ í•„ìš”í•˜ë‹¤.

ì—¬ê¸°ì„œ ë“±ì¥í•˜ëŠ” ê²ƒì´ `session` ì´ë©°, ì„¸ì…˜ì€ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ ë³„ë¡œ ìœ ì§€í•˜ëŠ” ì¼ì‹œì  ë°ì´í„° ì €ì¥ ê³µê°„ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.

#### Session ë™ì‘ ì›ë¦¬

1. ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì €ë¡œ ìš”ì²­ì„ ë³´ëƒ„
2. ì„œë²„ëŠ” ì„¸ì…˜ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ê³ ìœ í•œ Session ID ë¥¼ ë°œê¸‰ ë°›ìŒ
3. ì„¸ì…˜ ID ëŠ” ì£¼ë¡œ ì¿ í‚¤(JSESSIONID) ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬ë¨
4. í´ë¼ì´ì–¸íŠ¸ëŠ” ì´í›„ ìš”ì²­ë§ˆë‹¤ ì„¸ì…˜ ID ë¥¼ ì„œë²„ì— ë³´ë‚´ê³ , ì„œë²„ëŠ” ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ì…˜ ì €ì¥ì†Œë¥¼ ì¡°íšŒí•˜ê²Œ ëœë‹¤.

##### Session ìƒì„±

Spring MVC ì—ì„œ Session ì€ `HttpSession` ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì œê³µë˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” `Servlet` ì»¨í…Œì´ë„ˆ(Tomcat, Jetty ë“±)ì—ì„œ ê´€ë¦¬í•œë‹¤. ì¦‰, Spring ì´ ì§ì ‘ ì„¸ì…˜ ê°ì²´ë¥¼ ë§Œë“œëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ìš”ì²­ ì‹œ `Servlet` ì»¨í…Œì´ë„ˆê°€ ì„¸ì…˜ì„ ì •í•˜ê³  Spring ì€ ê·¸ê±¸ í™œìš©í•œë‹¤.

ë”°ë¼ì„œ `DispatcherServlet` ì—ì„œ ë°›ì•„ì§„ `HttpServletRequest` ì•ˆì— `Session` ì´ ë“¤ì–´ìˆê²Œ ëœë‹¤.

1. `request.getSession()` í˜¸ì¶œ
    1. ìš”ì²­ ì¿ í‚¤ì— `JSESSIONID` ë¥¼ í™•ì¸
    2. ì—†ìœ¼ë©´ ìƒˆë¡œìš´ ì„¸ì…˜ ê°ì²´ ìƒˆì„±
    3. ê³ ìœ í•œ ì„¸ì…˜ ID ë¥¼ ìƒì„±(`UUID` ë˜ëŠ” ëœë¤ ë¬¸ìì—´)
    4. ì„œë²„ ë©”ëª¨ë¦¬(ê¸°ë³¸ì€ `HashMap` ë“±)ì— ì„¸ì…˜ ì €ì¥
    5. í´ë¼ì´ì–¸íŠ¸ì—ê²Œ `Set-Cookie: JSESSIONID=ëœë¤ê°’` ì „ì†¡
2. ì´í›„ ìš”ì²­ì—ì„œ ì„¸ì…˜ ì‚¬ìš©
    1. ë¸Œë¼ìš°ì €ê°€ `JSESSIONID` ì¿ í‚¤ë¥¼ ë³´ë‚´ë©´ ì»¨í…Œì´ë„ˆê°€ ì„¸ì…˜ ê°ì²´ë¥¼ ì¡°íšŒí•´ì„œ ë°˜í™˜
    2. Spring `Controller` ì—ì„œ ë°”ë¡œ `session.getAttribute("user")` ë“±ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥

#### Session êµ¬ì¡°

- `HttpSession`: ì¸í„°í˜ì´ìŠ¤
- `StandardSession` (Tomcat êµ¬í˜„)
    - `id`: ì„¸ì…˜ ì‹ë³„ì
    - `creationTime`: ì„¸ì…˜ ìƒì„± ì‹œê°„
    - `lastAccessedTime`: ë§ˆì§€ë§‰ ì ‘ê·¼ ì‹œê°„
    - `attributes`: ì„¸ì…˜ì— ì €ì¥ëœ key-value `Map`

> Servlet ì´ ìƒì„±í•¨ì„ ì•Œê³  ìˆì

#### Session í™œìš© ì˜ˆì‹œ

{% highlight java %}
@GetMapping("/login")
public String login(HttpSession session) {
    // ë¡œê·¸ì¸ ì„±ê³µ í›„ ì‚¬ìš©ì ì •ë³´ë¥¼ ì„¸ì…˜ì— ì €ì¥
    session.setAttribute("user", "park");
    session.setAttribute("role", "admin");
    return "home";
}
{% endhighlight %}

> ì´ë•Œ String, `Object` ë¡œ ë“¤ì–´ê°€ëŠ”ë°, `Object` ëŠ” `Serializable` í•´ì•¼ í•œë‹¤.

**SessionAttribute**

`@ModelAttribute` ì²˜ëŸ¼ ì—¬ê¸°ì„œë„ `@SessionAttribute` ì˜ `name` ì˜µì…˜ì€ ìƒëµ ê°€ëŠ¥í•˜ë‹¤.

{% highlight java %}
@GetMapping("/dashboard")
public String dashboard(@SessionAttribute(name="user", required=false) String user) {
    if (user == null) return "redirect:/login";
    return "dashboard";
}
{% endhighlight %}

**SessionAttributes**

ì´ ì–´ë…¸í…Œì´ì…˜ì€ ì‚´ì§ í—·ê°ˆë¦´ ìˆ˜ ìˆëŠ”ë°, ìƒˆë¡­ê²Œ ì ‘ì†í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ëŠ” ì“¸ë ¤ëŠ” `key` ê°€ `Session` ì— ì—†ê¸° ë•Œë¬¸ì— `@ModelAttribute` ë¡œ `key` ê°€ ìƒì„±ë˜ë©´ `@SessionAttributes` ë•ë¶„ì— ì´ ê°’ì´ ì„¸ì…˜ì—ë„ ì €ì¥ë˜ê²Œ ëœë‹¤. ì¦‰, HTTP Session ì´ ìƒì„±ë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ì €ì¥í•˜ë„ë¡ ì§€ì •í•œë‹¤.

{% highlight java %}
@SessionAttributes("visitCount")
public class SessionController {

	// HTTP Request ì—ì„œ ëª¨ë¸ì— ê°’ì´ ì—†ì„ ë•Œë§Œ í˜¸ì¶œë˜ëŠ” ì• ë„ˆí…Œì´ì…˜ì´ë‹¤.
    // í•˜ì§€ë§Œ, ìœ„ì—ì„œ SessionAttributes ë¡œ HTTP Session ë²”ìœ„ë¡œ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ key ëŠ” ì„¸ì…˜ì´ ëë‚ ë•Œê¹Œì§€ ê³„ì† ìœ ì§€
	@ModelAttribute("visitCount")
	public Integer initVisitCount() {
		System.out.println("initVisitCount");
		return 0;
	}

    ...
}
{% endhighlight %}

> ë§Œì•½ í´ë¼ì´ì–¸íŠ¸ê°€ ê°™ì€ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë‹¤ë¥¸ ìš”ì²­ì„ ë‹¤ì‹œ ë³´ë‚´ê²Œ ë˜ë©´ ì„¸ì…˜ì— ì´ë¯¸ `key` ê°€ ì¡´ì¬í•´ì„œ, ì´ ê°’ì„ ìë™ìœ¼ë¡œ `Model` ì— ì ìš©í•˜ê³ , ì´ ì–´ë…¸í…Œì´ì…˜ì€ `Controller` ë‹¨ìœ„ë¡œ ì ìš©ë˜ë¯€ë¡œ ë‹¤ë¥¸ ì»¨í‹€ë¡¤ëŸ¬ì—ì„œëŠ” í•´ë‹¹ `key-value` ë¥¼ ëª»ì“´ë‹¤. ë‹¤ë§Œ, ë‹¤ë¥¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë™ì¼ key ë¥¼ ìˆ˜ë™ìœ¼ë¡œ êº¼ë‚´ì„œ ì“°ëŠ”ê±´ ê°€ëŠ¥í•˜ë‹¤. ì„¸ì…˜ì€ ê³µìœ  ì˜ì—­ì´ê¸° ë•Œë¬¸

### Exception Handling

ë³´í†µ ìë°”ì—ì„œ ì—ëŸ¬ë¥¼ ë§Œë‚˜ê²Œ ë˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ try-catch ë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬ë¥¼ í•˜ê²Œ ëœë‹¤. í•˜ì§€ë§Œ ì´ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë©”ì„œë“œ í•˜ë‚˜í•˜ë‚˜ ë§ˆë‹¤ ìƒì„±ì‹œí‚¨ë‹¤ê³  í•œë‹¤ë©´ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì§„ë‹¤.

ì´ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ê²Œ `@ExceptionHandler` ì´ë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ ë‹¨ìœ„ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•´ì£¼ê³  ì˜ˆì™¸ë¥¼ í•œ ê³³ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ë§Œì•½ í•˜ë‚˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì— ëŒ€í•´ì„œ Exception Handling ì„ í•˜ê³  ì‹¶ë‹¤ë©´ ê·¸ ì»¨íŠ¸ë¡¤ëŸ¬ ë‚´ë¶€ì— `@ExceptionHandler` ê°€ ë¶™ì€ ë©”ì„œë“œë¥¼ ì •ì˜í•˜ë©´ ëœë‹¤.

{% highlight java %}
@Controller
public class UserController {

    @GetMapping("/user")
    public String getUser(@RequestParam(required = false) String name) {
        if (name == null) throw new IllegalArgumentException("ì´ë¦„ì´ ì—†ìŠµë‹ˆë‹¤!");
        return "user";
    }

    @ExceptionHandler(IllegalArgumentException.class)
    public String handleIllegalArgument(IllegalArgumentException e, Model model) {
        model.addAttribute("error", e.getMessage());
        return "error"; // error.html ë¡œ í¬ì›Œë”©
    }
}
{% endhighlight %}

ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ ì¦‰, ì „ì—­ì ì¸ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•˜ê³  ì‹¶ë‹¤ë©´ í´ë˜ìŠ¤ë¥¼ ë”°ë¡œ ë§Œë“¤ì–´ `@ControllerAdvice` ë¥¼ í´ë˜ìŠ¤ì— ë¶™ì—¬ì£¼ë©´ ëœë‹¤.

{% highlight java %}
@ControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(IllegalArgumentException.class)
    public String handleIllegalArgument(IllegalArgumentException e, Model model) {
        model.addAttribute("error", e.getMessage());
        return "error";
    }

    @ExceptionHandler(Exception.class)
    public String handleGeneral(Exception e, Model model) {
        model.addAttribute("error", "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        return "error";
    }
}
{% endhighlight %}

`ControllerAdvice` ëŠ” ë‹¤ìŒ ì˜µì…˜ì„ ì œê³µí•œë‹¤.

- `basePackages`: íŠ¹ì • íŒ¨í‚¤ì§€ í•˜ìœ„ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì—ë§Œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì ìš©í•  ë•Œ ì‚¬ìš©

{% highlight java %}
@ControllerAdvice(basePackages = "com.example.user")
public class UserExceptionHandler { ... }
{% endhighlight %}

- `basePackageClasses`: í´ë˜ìŠ¤ ê¸°ì¤€ìœ¼ë¡œ íŒ¨í‚¤ì§€ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì†í•œ íŒ¨í‚¤ì§€ê°€ ìë™ ì¸ì‹ëœë‹¤. ì•„ë˜ì™€ ê°™ì´ ì“°ë©´ `UserController` ê°€ ì†í•œ íŒ¨í‚¤ì§€ì˜ ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì— ì ìš©ë¨

{% highlight java %}
@ControllerAdvice(basePackageClasses = UserController.class)
public class UserExceptionHandler { ... }
{% endhighlight %}

- `assignableTypes`: íŠ¹ì • í´ë˜ìŠ¤ë‚˜ íƒ€ì…(ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ ë˜ëŠ” ì¸í„°í˜ì´ìŠ¤)ì—ë§Œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì ìš©, `basePackageClasses` ë‘ ë‹¤ë¥¸ ì ì€ ì†í•œ í´ë˜ìŠ¤ì˜ ì ìš© ìœ ë¬´ì´ë‹¤.

{% highlight java %}
@ControllerAdvice(assignableTypes = {AdminController.class, UserController.class})
public class SpecificControllerAdvice { ... }
{% endhighlight %}

- `annotations`: íŠ¹ì • ì• ë„ˆí…Œì´ì…˜ì´ ë¶™ì€ ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì—ë§Œ ì ìš©

{% highlight java %}
@ControllerAdvice(annotations = RestController.class)
public class RestApiExceptionHandler { ... }
{% endhighlight %}

> `RestControllerAdvice` ëŠ” REST API ìš© ì „ì—­ ì²˜ë¦¬

#### ExceptionHandler ê·œì¹™

ëª¨ë“  í¸ë¦¬í•œ ê²ƒì—ëŠ” ê·œì¹™ì´ ìˆìŒì„ ìŠì§€ ë§ê³  ì—¬ê¸°ì„œë„ ê·œì¹™ì„ ì§€í‚¤ë„ë¡ ì–´ë–¤ ê·œì¹™ì´ ìˆëŠ”ì§€ ë³´ì.

ë³´í†µ `@ExceptionHandler` ë©”ì„œë“œê°€ ìë™ìœ¼ë¡œ ì£¼ì… ë°›ì„ ìˆ˜ ìˆëŠ” ì¸ìëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì¼ë°˜ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì™€ ë™ì¼í•œ ê·œì¹™ìœ¼ë¡œ ì¸ìë¥¼ í•´ê²°í•œë‹¤. ì¦‰ `HandlerMethodArgumentResolver` ë“¤ì´ ì§€ì›í•˜ëŠ” ëª¨ë“  íƒ€ì…ì´ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

1. ì˜ˆì™¸ íƒ€ì…
2. HTTP ê´€ë ¨ í‘œì¤€ íƒ€ì…
    - `HttpServletRequest`
    - `HttpServletResponse`
    - `HttpSession`
    - `ServletRequest` / `ServletResponse`
    - `WebRequest`
3. Spring MVC ì˜ ì›¹ë ˆë²¨ ë„ìš°ë¯¸
    - `HttpEntity`
    - `Locale`
    - `Principal`
    - `InputStream` / `Reader` ë“±ë“±
4. ëª¨ë¸ ê´€ë ¨ íƒ€ì…(ë³´í†µ key-value ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ê±°-Map ë©´ ë‹¤ ëœë‹¤)
    - `Model`
    - `ModelMap`
    - `ModelAndView`
    - `Map<String, Object>`
5. ìš”ì²­ ë°”ì¸ë”© ê´€ë ¨
    - `@RequestParam`
    - `@RequestHeader`
    - `@RequestBody`
    - `@PathVariable`
    - `@ModelAttribute`
    - `@CookieValue`
    - `@SessionValue`
    - ...

ìœ„ íƒ€ì…ë“¤ì€ ìë™ìœ¼ë¡œ ì£¼ì… ë°›ëŠ”ë‹¤. ë”°ë¼ì„œ ë³´í†µ ì²« ì¸ìë¡œ `Exception` í•˜ìœ„ í´ë˜ìŠ¤ë¥¼ ì¸ìë¥¼ ì •ì˜í•´ì£¼ë©´ ë‚´ë¶€ì—ì„œ ì´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ë³´í†µ Error ì²˜ë¦¬ë¥¼ í•  ë•Œ, Status ì½”ë“œì™€ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì—´ê±°í˜•ìœ¼ë¡œ ì„ ì–¸í•˜ê³  ì´ë¥¼ ì‚¬ìš©í•´ì£¼ëŠ”ê²Œ ê¹”ë”í•  ê²ƒ ê°™ë‹¤.

{% highlight java %}
@ControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(ResourceNotFoundException.class)
    public ModelAndView handleNotFound(ResourceNotFoundException e) {
        ModelAndView mav = new ModelAndView("error/404");
        mav.addObject("message", e.getMessage());
        return mav;
    }

    @ExceptionHandler(ValidationException.class)
    public String handleValidation(ValidationException e, Model model) {
        model.addAttribute("errors", e.getErrors());
        return "error/validation";
    }

    @ExceptionHandler(DataAccessException.class)
    public String handleDatabaseError(DataAccessException e,
                                     Model model) {
        logger.error("Database error", e);
        model.addAttribute("error", "Database error occurred");
        return "error/500";
    }

    @ExceptionHandler(Exception.class)
    public String handleGeneral(Exception e, Model model) {
        logger.error("Unexpected error", e);
        model.addAttribute("error", "An unexpected error occurred");
        return "error/general";
    }
}

// Custom Exception
public class ResourceNotFoundException extends RuntimeException {
    public ResourceNotFoundException(String message) {
        super(message);
    }
}
{% endhighlight %}