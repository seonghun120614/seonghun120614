---
layout: post
title:  "[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 19ì¼ì°¨"
date:   2025-09-11 22:32:08 +0900
categories: ë©‹ìŸì´ì‚¬ìì²˜ëŸ¼ ë©‹ì‚¬ ë°±ì—”ë“œ TIL Database
---

<!--more-->


## ğŸ“‚ ëª©ì°¨
- [JOIN](#join)
    - [CROSS JOIN](#cross-join)
    - [INNER JOIN](#inner-join)
        - [JOIN ì„±ëŠ¥ ì¸¡ë©´](#join-ì„±ëŠ¥-ì¸¡ë©´)
    - [OUTER JOIN](#outer-join)
    - [SELF JOIN](#self-join)
- [Sub Query](#sub-query)
- [Correlated Subquery](#correlated-subquery)
- [ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤](#ë‹¤ì–‘í•œ-ê¸°ëŠ¥ë“¤)
    - [Set Operation](#set-operation)
    - [Window í•¨ìˆ˜](#window-í•¨ìˆ˜)
- [Schema](#schema)
    - [Relation Schema](#relation-schema)
    - [Key](#key)
        - [Candidate Key](#candidate-key)
        - [Primary Key](#primary-key)
        - [Foreign Key](#foreign-key)
- [Schema Diagrams](#schema-diagrams)
- [Relational Query Languages](#relational-query-languages)
    - [SQL Languages Parts](#sql-languages-parts)
- [SQL Data Definition](#sql-data-definition)
    - [Basic Types](#basic-types)
    - [Basic Schema Definition](#basic-schema-definition)

---

## ğŸ“š ë³¸ë¬¸

### JOIN

JOINì€ ì—¬ëŸ¬ í…Œì´ë¸”ì˜ ë°ì´í„°ë“¤ì„ ì—°ê²°ì‹œì¼œ í•˜ë‚˜ì˜ ê²°ê³¼ ì§‘í•©ìœ¼ë¡œ ë§Œë“œëŠ” ë°©ë²•ì´ë‹¤.

{% highlight sql %}
table_references:
    escaped_table_reference [, escaped_table_reference] ...

escaped_table_reference: {
    table_reference
  | { OJ table_reference }
}

table_reference: {
    table_factor
  | joined_table
}

table_factor: {
    tbl_name [PARTITION (partition_names)]
        [[AS] alias] [index_hint_list]
  | [LATERAL] table_subquery [AS] alias [(col_list)]
  | ( table_references )
}

joined_table: {
    table_reference {[INNER | CROSS] JOIN | STRAIGHT_JOIN} table_factor [join_specification]
  | table_reference {LEFT|RIGHT} [OUTER] JOIN table_reference join_specification
  | table_reference NATURAL [INNER | {LEFT|RIGHT} [OUTER]] JOIN table_factor
}

join_specification: {
    ON search_condition
  | USING (join_column_list)
}

join_column_list:
    column_name[, column_name] ...

index_hint_list:
    index_hint[ index_hint] ...

index_hint: {
    USE {INDEX|KEY}
      [FOR {JOIN|ORDER BY|GROUP BY}] ([index_list])
  | {IGNORE|FORCE} {INDEX|KEY}
      [FOR {JOIN|ORDER BY|GROUP BY}] (index_list)
}

index_list:
    index_name [, index_name] ...
{% endhighlight %}

MySQL ë¬¸ë²• ì •ì˜ì„œ ì¸ë°, FROM ì ˆì—ì„œ í…Œì´ë¸” ì°¸ì¡° ë¥¼ ì–´ë–»ê²Œ ì“¸ ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•œ ê·œì¹™ì„ ë‚˜ì—´í•œ ê²ƒì´ë‹¤. SELECT ë¬¸ì—ì„œë„ ë‹¹ì—°íˆ ë´¤ì„ ê²ƒì´ë‹¤.

#### CROSS JOIN

ì¹´í…Œì‹œì•ˆ ê³±ì´ë©°, ê·¸ëƒ¥ ê°€ëŠ¥í•œ ëª¨ë“  ì¡°í•©ì˜ ê²½ìš°ë¥¼ ê²°ê³¼ë¡œ ë‚´ë±‰ëŠ”ë‹¤. í•˜ì§€ë§Œ ì´ëŠ” ì˜ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©°, ì—¬ëŸ¬ ì—´ì´ ìˆë‹¤ë©´ êµ‰ì¥íˆ ë§ì€ í–‰ì´ ìƒì„±ë˜ë¯€ë¡œ ì„±ëŠ¥ì ìœ¼ë¡œ ë¬¸ì œê°€ ìˆë‹¤.

í¬ë¡œìŠ¤ ì¡°ì¸ì€ ê·¸ëƒ¥ ë‘ í…Œì´ë¸”ì„ FROM ì ˆì— ë†“ìœ¼ë©´ ëœë‹¤.

{% highlight sql %}
SELECT *
FROM customers c, orders o;  -- ì¡°ì¸ ì¡°ê±´ ì—†ìŒ
{% endhighlight %}

ë³´í†µì€ JOIN ì„ í•  ë•ŒëŠ” ê·¸ë˜ì„œ ì¡°ê±´ì„ ì£¼ëŠ”ê²Œ ì˜¤ë²„í—¤ë“œê°€ ì—†ë‹¤.

> ë§Œì•½ ì—¬ëŸ¬ í…Œì´ë¸”ì„ JOINí•œë‹¤ë©´, Nê°œì˜ í…Œì´ë¸”ì„ JOINí•  ë•Œ ìµœì†Œ (N-1)ê°œì˜ ì¡°ì¸ ì¡°ê±´ì´ í•„ìš”, ê·¸ë˜ì•¼ ë¶ˆí•„ìš”í•œ Cartesian Product ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

#### INNER JOIN

{% highlight sql %}
-- ì „í†µì ì¸ ì¡°ì¸ ë°©ì‹
SELECT 
    e.first_name,
    e.last_name,
    d.department_name
FROM 
    employees e, 
    departments d
WHERE 
    e.department_id = d.department_id;
{% endhighlight %}

ì˜ˆì „ì—ëŠ” ìœ„ì²˜ëŸ¼ ì½”ë”©ì„ í–ˆì§€ë§Œ, í…Œì´ë¸”ì„ FROM ì— ë‚˜ì—´í•˜ê³  WHERE ì¡°ê±´ì„ ì§€ì •í•˜ê²Œ ë˜ë©´ ì¡°ì¸ ì¡°ê±´ê³¼ í•„í„° ì¡°ê±´ì´ ì„ì—¬ ìˆì–´ì„œ í—·ê°ˆë¦´ ìˆ˜ê°€ ìˆë‹¤. ë˜í•œ ì‹¤ìˆ˜ë¡œ ì¡°ì¸ ì¡°ê±´ì„ ë¹¼ë¨¹ìœ¼ë©´ CROSS JOIN ì´ ë˜ì–´ë²„ë ¤ ëª¨ë“  ì¡°í•©ì˜ ë°ì´í„°ê°€ ë§Œë“¤ì–´ì§€ê²Œ ëœë‹¤.

ë”°ë¼ì„œ ì§€ê¸ˆì€ ANSI SQL í‘œì¤€ JOIN ë¬¸ë²•ì„ ì‚¬ìš©í•œë‹¤.

{% highlight sql %}
-- JOIN ~ ON
SELECT 
    e.first_name,
    e.last_name,
    d.department_name
FROM employees e
JOIN departments d ON e.department_id = d.department_id;

-- JOIN ~ USING (ë™ì¼í•œ ì»¬ëŸ¼ëª…ì¼ ë•Œ)
SELECT 
    e.first_name,
    e.last_name,
    d.department_name
FROM employees e
JOIN departments d USING(department_id);

-- NATURAL JOIN (ìë™ìœ¼ë¡œ ê°™ì€ ì´ë¦„ ì»¬ëŸ¼ ì¡°ì¸)
SELECT * FROM employees NATURAL JOIN departments;
{% endhighlight %}

##### JOIN ì„±ëŠ¥ ì¸¡ë©´

**INDEXING**
INNER JOIN ì€ ì¡°ê±´ì´ ì˜ ê±¸ë ¤ìˆìœ¼ë©´ íš¨ìœ¨ì ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ëŒ€ìƒ í…Œì´ë¸”ì˜ index ê°€ ê±¸ë ¤ìˆì—ˆë‹¤ê³  í•´ë³´ì. ì´ë•Œ í•„í„°ë§ì„ ì£¼ëŠ” í…Œì´ë¸”ì˜ ê°’ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ì´ë“¤ì„ ì°¾ì•„ë‚´ê¸°ë§Œ í•˜ë©´ ë˜ëŠ”ë°, ì°¾ì•„ë‚¼ ë•Œë„ searching ì‘ì—…ì´ í•„ìš”í•˜ê¸°ì— ì—¬ê¸°ì— index ë¥¼ ê±¸ì–´ì£¼ë©´ ë” ë¹ ë¥´ê²Œ ì°¾ì•„ë‚¼ ìˆ˜ ìˆê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

indexing ì´ ì•ˆê±¸ë ¤ ìˆì—ˆë‹¤ë©´ searching ì‘ì—…ì´ ëŠë ¤ì§€ê²Œ ë˜ì–´ì„œ ì„±ëŠ¥ ì´ì ì„ ë³¼ ìˆ˜ê°€ ì—†ê²Œ ëœë‹¤. ë˜í•œ JOIN ì—†ì´ ì“°ë©´ ê¸°ë³¸ì ìœ¼ë¡œ cartesian ì´ ìˆ˜í–‰ë˜ëŠ”ë° ì´ëŠ” êµ‰ì¥íˆ ëŠë¦¬ë‹¤. JOIN ì´ ìˆê¸°ì— ê°€ëŠ¥í•˜ë‹¤.

**í…Œì´ë¸” í¬ê¸°ì™€ ìˆœì„œì— ë”°ë¥¸ ì„±ëŠ¥**

ì¡°ì¸í•˜ëŠ” í…Œì´ë¸”ì´ í¬ë©´ í´ìˆ˜ë¡ ì„±ëŠ¥ ì˜í–¥ì´ í¬ë‹¤. ì¼ë¶€ DBMSëŠ” ì¡°ì¸ ìˆœì„œë¥¼ ë°”ê¿” ìµœì í™”í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆì–´ ìƒê´€ì´ ì—†ì§€ë§Œ, í° í…Œì´ë¸”ì„ ë¨¼ì € JOIN í•˜ë©´ ì„ì‹œ í…Œì´ë¸”ì´ ì»¤ì ¸ì„œ ëŠë ¤ì§ˆ ìˆ˜ ìˆê²Œ ëœë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ customers í…Œì´ë¸”ì— 1000 ê°œì˜ ë ˆì½”ë“œê°€ ìˆê³ , orders í…Œì´ë¸”ì— 1000000 ë ˆì½”ë“œê°€ ìˆë‹¤ê³  í•˜ì.

{% highlight sql %}
-- orders(100ë§Œ í–‰) ê¸°ì¤€ìœ¼ë¡œ ë¨¼ì € customers ì™€ JOIN
SELECT o.id, o.order_date, c.name
FROM orders o
JOIN customers c
ON o.customer_id = c.id;
{% endhighlight %}

ë¬´ì¡°ê±´ ëŒ€ìƒ í…Œì´ë¸”ì€ ì‘ì•„ì•¼ í•œë‹¤. ìœ„ì²˜ëŸ¼ order í…Œì´ë¸”ì„ ë¨¼ì € ê°€ì ¸ì™€ë²„ë¦¬ë©´ ë§ì´ ê°€ì ¸ì˜¨ í–‰ì— ëŒ€í•´ì„œ ê²€ìƒ‰í•´ì•¼ í•  ì–‘ì´ ëŠ˜ì–´ë‚˜ê²Œ ëœë‹¤. ë˜í•œ ì‘ì€ í…Œì´ë¸”ì„ index ë¥¼ ìƒì„±í•´ì•¼ index í¬ê¸°ê°€ ì‘ì•„ì ¸ì„œ ê²€ìƒ‰í•  ì–‘ì´ ì¤„ì–´ë“¤ê¸°ì— customers ì˜ í…Œì´ë¸”ì´ ë¨¼ì € ì‘ì„±ë˜ì–´ì•¼ í•˜ëŠ” ê²ƒì´ë‹¤.

{% highlight sql %}
SELECT o.id, o.order_date, c.name
FROM customers c
JOIN orders o
ON c.id = o.customer_id
{% endhighlight %}

ìœ„ì²˜ëŸ¼ ì‘ì„±í•´ì£¼ë©´ ë˜ê² ë‹¤. ê·¸ë¦¬ê³  WHERE ì„ ì¨ì„œ ë„£ëŠ”ë‹¤ë©´ ëŒ€ìƒ í…Œì´ë¸” í¬ê¸°ê°€ ë” ì‘ì•„ì ¸ì„œ ë” íš¨ìœ¨ì ì´ê²Œ ë˜ê² ë‹¤. ë°‘ì€ ê·¸ ì˜ˆì‹œë‹¤.

{% highlight sql %}
-- íŠ¹ì • VIP ê³ ê°ì˜ ì£¼ë¬¸ë§Œ ì°¾ê³  ì‹¶ì„ ë•Œ
SELECT o.id, o.order_date, c.name
FROM customers c
JOIN orders o
ON c.id = o.customer_id
WHERE c.vip = true;
{% endhighlight %}

**Sub Query, CTE** 


#### OUTER JOIN

ì•„ìš°í„° ì¡°ì¸ì—ëŠ” LEFT JOIN ê³¼ RIGHT JOIN ì´ ìˆëŠ”ë° ê¸°ì¤€ë§Œ ë‹¤ë¥¼ ë¿ ë‘˜ì˜ ë™ì‘ ë°©ì‹ì€ ë™ì¼í•˜ë‹¤.

LEFT JOIN ì€ ì™¼ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ì´ ì „ë¶€ ê²°ê³¼ í…Œì´ë¸”ì— í¬í•¨ë˜ì–´ì•¼ ë˜ë©° RIGHT JOIN ì€ ê·¸ ë°˜ëŒ€ë‹¤.

**LEFT JOIN**
{% highlight sql %}
-- ë¶€ì„œê°€ ì—†ëŠ” ì§ì›ë„ í¬í•¨
SELECT 
    e.employee_id,
    e.first_name,
    d.department_name
FROM employees e
LEFT OUTER JOIN departments d 
ON e.department_id = d.department_id;

-- LEFT JOINìœ¼ë¡œ ì¶•ì•½ ê°€ëŠ¥
SELECT 
    e.employee_id,
    e.first_name,
    d.department_name
FROM employees e
LEFT JOIN departments d 
ON e.department_id = d.department_id;
{% endhighlight %}

**RIGHT JOIN**

{% highlight sql %}
-- ì§ì›ì´ ì—†ëŠ” ë¶€ì„œë„ í¬í•¨
SELECT 
    e.employee_id,
    e.first_name,
    d.department_name
FROM employees e
RIGHT OUTER JOIN departments d 
ON e.department_id = d.department_id;
{% endhighlight %}

ê°€ë ¹ ë‘ í…Œì´ë¸”ì˜ íŠœí”Œë“¤ ì „ë¶€ë¥¼ ê²°ê³¼ í…Œì´ë¸”ì— ë‚˜ì˜¤ë„ë¡, ì¦‰ LEFT, RIGHT ë‘˜ ë‹¤ ë˜ë„ë¡ í•˜ê²Œ í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆë‹¤. ì´ë¥¼ FULL OUTER JOIN ì´ë¼ê³  í•˜ëŠ”ë° ì´ëŠ” MySQL ì—ì„œëŠ” ì§€ì›í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— LEFT JOIN, RIGHT JOIN, UNION ì„ í•©ì³ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê² ë‹¤.

{% highlight sql %}
-- ë°©ë²• 1: LEFT JOIN + RIGHT JOIN + UNION
SELECT 
    e.employee_id,
    e.first_name,
    d.department_name
FROM employees e
LEFT JOIN departments d ON e.department_id = d.department_id
UNION
SELECT 
    e.employee_id,
    e.first_name,
    d.department_name
FROM employees e
RIGHT JOIN departments d ON e.department_id = d.department_id
WHERE e.department_id IS NULL;  -- ì¤‘ë³µ ì œê±°ë¥¼ ìœ„í•´ ì¶”ê°€
{% endhighlight %}

**Postgres, Oracle ë“±ë“±**
{% highlight sql %}
-- PostgreSQL, SQL Server, Oracleì—ì„œ ê°€ëŠ¥í•œ êµ¬ë¬¸
SELECT 
    e.employee_id,
    e.first_name,
    d.department_name
FROM employees e
FULL OUTER JOIN departments d 
ON e.department_id = d.department_id;
{% endhighlight %}

#### SELF JOIN

ìê¸° ìì‹ ì„ ê·¸ëƒ¥ JOIN ì ˆì˜ í…Œì´ë¸”ë¡œ ë„£ì–´ë²„ë¦¬ë©´ ëœë‹¤.

{% highlight sql %}
-- ì§ì›ê³¼ ìƒì‚¬ ì •ë³´ ì¡°íšŒ
SELECT 
    e.employee_id AS ì‚¬ì›ID,
    e.first_name AS ì‚¬ì›ì´ë¦„,
    m.employee_id AS ìƒì‚¬ID,
    m.first_name AS ìƒì‚¬ì´ë¦„
FROM employees e
JOIN employees m ON e.manager_id = m.employee_id;
{% endhighlight %}

### Sub Query

nested class ì²˜ëŸ¼ ì—¬ê¸°ì„œëŠ” ì¿¼ë¦¬ë¥¼ ì¤‘ì²©ì‹œí‚¤ë„ë¡ í•  ìˆ˜ ìˆë‹¤. ë³´í†µ sub query ëŠ” ì˜ ì“°ì§€ëŠ” ì•ŠëŠ”ë‹¤. ê·¸ëƒ¥ Join ì´ ë” ìµœì í™”ì— ì¢‹ê³ , ì¬ì‚¬ìš©ì´ ì–´ë ¤ìš°ë©°, ë””ë²„ê¹…ì´ ë¶ˆí¸í•˜ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  ë‹¨ì¼ ê°’ë§Œì„ ê°€ì ¸ì˜¤ê³  ì‹¶ì„ ë•ŒëŠ” sub query ë¥¼ ì“°ëŠ”ê²Œ ë” ì¢‹ì„ ìˆ˜ë„ ìˆê³ , ìƒí™©ë§ˆë‹¤ ê°€ë” ì“°ê¸´ í•œë‹¤.

**Single-row Subquery**
{% highlight sql %}
-- í‰ê·  ê¸‰ì—¬ë³´ë‹¤ ì ì€ ê¸‰ì—¬ë¥¼ ë°›ëŠ” ì‚¬ì›
SELECT ename, sal
FROM emp
WHERE sal < (
    SELECT AVG(sal)
    FROM emp
);

-- ê°€ì¥ ë¨¼ì € ì…ì‚¬í•œ ì‚¬ì›
SELECT ename, hiredate
FROM emp
WHERE hiredate = (
    SELECT MIN(hiredate)
    FROM emp
);
{% endhighlight  %}

**Multi-row Subquery**

{% highlight sql %}
-- IN ì—°ì‚°ì ì‚¬ìš©
SELECT ename, sal, deptno
FROM emp
WHERE deptno IN (
    SELECT deptno
    FROM dept
    WHERE loc IN ('NEW YORK', 'DALLAS')
);

-- ANY ì—°ì‚°ì ì‚¬ìš©
SELECT ename, sal
FROM emp
WHERE sal > ANY (
    SELECT sal
    FROM emp
    WHERE deptno = 30
);

-- ALL ì—°ì‚°ì ì‚¬ìš©
SELECT ename, sal
FROM emp
WHERE sal > ALL (
    SELECT sal
    FROM emp
    WHERE deptno = 30
);
{% endhighlight %}

#### Correlated Subquery

ì™¸ë¶€ ì¿¼ë¦¬ì™€ ë‚´ë¶€ ì¿¼ë¦¬ê°€ ì„œë¡œ ì—°ê´€ë˜ì–´ ìˆëŠ” ì„œë¸Œì¿¼ë¦¬ì´ë‹¤.

{% highlight sql %}
-- ìì‹ ì´ ì†í•œ ë¶€ì„œì˜ í‰ê·  ê¸‰ì—¬ë³´ë‹¤ ë§ì´ ë°›ëŠ” ì‚¬ì›
SELECT o.ename, o.sal, o.deptno
FROM emp o
WHERE o.sal > (
    SELECT AVG(i.sal)
    FROM emp i
    WHERE i.deptno = o.deptno
);
{% endhighlight %}

ë³„ íŠ¹ë³„í• ê±´ ì—†ë‹¤.

### ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤

#### Set Operation

- UNION
- MINUS
- INTERSECT

#### Window í•¨ìˆ˜

ë³´í†µ OVER ê³¼ í•¨ê»˜ ë™ë°˜ë˜ë©°, ì‚¬ìš©í•  ë•ŒëŠ” ê²€ìƒ‰ í›„ì— ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ë‹¤.

- RANK
- ROW_NUMBER
- DENSE_RANK

### Schema

ì´ì œ ì´ë¡ ì„ ë“¤ì–´ê°€ë³´ì.

ë°ì´í„°ë¥¼ DBì— ì €ì¥í•  ë•Œ ê·¸ëŸ¬ë©´ í…Œì´ë¸”ì„ ê°ê° ë§Œë“¤ì–´ì¤˜ì•¼ í•˜ëŠ”ë°, ì´ í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ì „ ì‘ì—…ë“¤(ì„¤ê³„)ì´ ë§ì´ ë“¤ì–´ê°„ë‹¤.

ë§Œì•½ ì´ë¥¼ ì˜ëª» ì„¤ê³„í•˜ë©´ ë‚˜ì¤‘ì—ëŠ” ë°ì´í„° êµ¬ì¡° ìì²´ë¥¼ ë³€ê²½í•˜ëŠ”ë° êµ‰ì¥íˆ ë§ì€ ë¹„ìš©ì´ ë“¤ì–´ê°€ê²Œ ëœë‹¤(ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆëŠ” ë°ì´í„° êµ¬ì¡°ë¥¼ ë‹¤ë¥¸ ë°ì´í„° êµ¬ì¡°ë¡œ ë°”ê¿”ì•¼ í•˜ê¸° ë•Œë¬¸). ë”°ë¼ì„œ ì´ˆê¸° ì„¤ê³„ê°€ ì¤‘ìš”í•˜ë‹¤. ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” Schema ë¶€í„° ë³¸ë‹¤.

ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì–˜ê¸°í•  ë•ŒëŠ” í•­ìƒ ìŠ¤í‚¤ë§ˆ ì™€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ë¶„í•´ì•¼ í•œë‹¤. ìŠ¤í‚¤ë§ˆëŠ” DB ì˜ ë…¼ë¦¬ì ì¸ ì„¤ê³„ë¥¼ ì˜ë¯¸í•˜ë©°, DB ì¸ìŠ¤í„´ìŠ¤ëŠ” íŠ¹ì • ì‹œì ì— DB ì•ˆì— ë‹´ê¸´ ë°ì´í„°ì˜ snapshot ì„ ì˜ë¯¸í•œë‹¤.

ë°ì´í„°ë¥¼ ì €ì¥í•  ë•ŒëŠ” relation ì— ì €ì¥í•˜ê²Œ ë˜ëŠ”ë° relation ì˜ schema ë¥¼ ë³´ì.

#### Relation Schema

relation ì´ë¼ëŠ” ê°œë…ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œ ë³€ìˆ˜ ê°œë…ê³¼ ëŒ€ì‘ë˜ê²Œ ë˜ë©°, ë¦´ë ˆì´ì…˜ ìŠ¤í‚¤ë§ˆì˜ ê°œë…ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œì˜ íƒ€ì… ì •ì˜ì™€ ëŒ€ì‘ë˜ê²Œ ëœë‹¤.

- Relation - Variable
- Relation Schema - Type Definition

ì—¬ê¸°ì„œ relation schema ë¼ëŠ” ê°œë…ì€ ì†ì„±ë“¤ê³¼ ê·¸ì— ëŒ€ì‘ë˜ëŠ” ë„ë©”ì¸ë“¤ì˜ ëª©ë¡ìœ¼ë¡œ êµ¬ì„±ë˜ê²Œ ëœë‹¤. ê° ì†ì„±ì˜ ë„ë©”ì¸ì— ëŒ€í•œ ì •í™•í•œ ì •ì˜ëŠ” ì¶”í›„ì— ë‹¤ë£¬ë‹¤.

relation instances ì˜ ê°œë…ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œ ë³€ìˆ˜ì˜ ê°’ì— í•´ë‹¹í•˜ê²Œ ëœë‹¤.

> relation schema: section (course_id, sec_id, semester, ...)  
> relation instance: (CS-101, 1, Fall, ...)

#### Key

ê´€ê³„ë“¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë“¤ì„ ë³´ë©´ ëª¨ë“  í–‰ë“¤ì€ ì„œë¡œ ë‹¤ ë‹¬ë¼ì•¼ í•œë‹¤. ì¤‘ë³µëœ ê°’ì´ ê³„ì†í•´ì„œ ë“¤ì–´ê°€ê²Œ ë˜ë©´ ì´ëŠ” ìì› ë‚­ë¹„ì´ê³  ë°ì´í„°ê°€ ìš°ë¦¬ì—ê²Œ í˜¼ë™ì„ ì¤„ ìˆ˜ ìˆë‹¤.

ë”°ë¼ì„œ ê´€ê²ŒëŠ” íŠœí”Œì„ êµ¬ë³„í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ë°˜ë“œì‹œ ê°€ì ¸ì•¼ í•˜ê³ , ì´ëŠ” **Super Key** ë¼ëŠ” í•˜ë‚˜ ì´ìƒì˜ ì†ì„± ì§‘í•©ì„ ì¨ì„œ ê° íŠœí”Œì„ ìœ ì¼í•˜ê²Œ ì‹ë³„ ê°€ëŠ¥í•˜ë‹¤.

> $t1 \neq t2 \implies t1.K \neq t2.K$

##### Candidate Key

ìŠˆí¼í‚¤ëŠ” ë¶ˆí•„ìš”í•œ ì†ì„±ë“¤ì„ í¬í•¨ í•  ìˆ˜ê°€ ìˆë‹¤. ì˜ˆë¥¼ë“¤ì–´ ID ì™€ name ì´ë¼ëŠ” attr. ë¥¼ ê°€ì§€ëŠ” í…Œì´ë¸” t1 ì´ ìˆë‹¤ê³  í•˜ì.

ìŠˆí¼í‚¤ëŠ” IDë¡œ ë‘ê²Œ ëœë‹¤ë©´ ëª¨ë“  í–‰ë“¤ì„ ê³ ìœ í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ìˆì§€ë§Œ, (ID, name) ìœ¼ë¡œ ë‘¬ë„ ëª¨ë“  í–‰ë“¤ì„ ê³ ìœ í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ìˆë‹¤.

ë”°ë¼ì„œ ë§Œì•½ Kê°€ ìŠˆí¼í‚¤ë¼ë©´, Kì˜ ì–´ë–¤ superset ë˜í•œ ì—­ì‹œ ìŠˆí¼í‚¤ê°€ ëœë‹¤. ë³´í†µ superset ë³´ë‹¤ëŠ” ë” ì´ìƒ ì¤„ì¼ ìˆ˜ ì—†ëŠ” ìµœì†Œ ìŠˆí¼í‚¤(**Minimal Superkey**) ì— ë” ê´€ì‹¬ì„ ê°€ì§€ê³ , ì´ëŸ¬í•œ ìµœì†Œ ìŠˆí¼í‚¤ë¥¼ **Candidate Key** ë¼ê³  ë¶€ë¥´ê²Œ ëœë‹¤.

ì—¬ê¸°ì„œ ë˜ ë‹¤ë¥¸ í›„ë³´í‚¤ì˜ ì˜ˆì‹œë¡œëŠ” ì„œë¡œ ë‹¤ë¥¸ ì—¬ëŸ¬ ì†ì„± ì§‘í•©ì´ í›„ë³´í‚¤ê°€ ë  ìˆ˜ë„ ìˆëŠ”ë°, ì˜ˆë¥¼ë“¤ì–´ (name, dept_name) ê³¼ ID ë‘ ì¡°í•©ì´ ìˆ˜í¼í‚¤ê°€ ë  ìˆ˜ ìˆë‹¤ê³  í•´ë³´ì. ê·¸ëŸ¬ë©´ ë‘˜ ë‹¤ í›„ë³´í‚¤ê°€ ë˜ëŠ” ì…ˆì´ë‹¤.

##### Primary Key

ì´ëŸ¬í•œ í›„ë³´í‚¤ ì¤‘ì—ì„œ DB Designer ê°€ relation ë‚´ì˜ tuple ì„ ì‹ë³„í•˜ëŠ” ì£¼ìš” ìˆ˜ë‹¨ìœ¼ë¡œ ì„ íƒí•œ ê²ƒì„ **Primary Key** ë¡œ ë¶€ë¥´ê²Œ ëœë‹¤.

> $Super Key \subset Candidate Key \subset Primary Key$

ê·¸ë¦¬ê³  Primary Key ë¥¼ Relation Schema ë¡œ í‘œê¸°í•  ë•Œ ë°‘ì¤„ì„ í†µí•´ í‘œí˜„í•˜ê²Œ ëœë‹¤.

> *classroom* (<u>building</u>, <u>room_number</u>, capacity)

ì´ëŸ¬í•œ ê¸°ë³¸í‚¤ëŠ” ì‹ ì¤‘í•˜ê²Œ ì„ íƒí•´ì•¼ í•˜ëŠ”ë°, primary key ê°€ ë§¤ìš° ë“œë¬¼ê²Œ ë³€ê²½ë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë³€ê²½ì´ ëœë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ìƒê¸´ë‹¤.

- ì°¸ì¡° ë¬´ê²°ì„±: ê¸°ë³¸í‚¤ëŠ” ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¡œ ì°¸ì¡°ë  ìˆ˜ ìˆëŠ”ë° ê°’ì´ ë°”ë€Œë©´ ì°¸ì¡° ê´€ê³„ê°€ ê¹¨ì§ˆ ìˆ˜ë„ ìˆë‹¤. ê·¸ë ‡ë‹¤ê³  ê¸°ë³¸í‚¤ ê°’ì„ ì—…ë°ì´íŠ¸í•˜ë©´ ë‹¤ë¥¸ ì°¸ì¡°í•˜ê³  ìˆëŠ” ì™¸ë˜í‚¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´ ë˜ì§€ ì•Šëƒê³  í•˜ëŠ”ë° ì´ëŸ¬ë©´ ë¹„ìš©ì ìœ¼ë¡œ ë¶€ë‹´ì´ë‹¤.
- ë°ì´í„° ì¼ê´€ì„±: ì—¬ëŸ¬ í…Œì´ë¸”, ì¸ë±ìŠ¤, ë·°, ì–´í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë“±ì—ì„œ í•´ë‹¹ í‚¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì°¾ëŠ”ë°, ê³„ì† ê°’ì´ ë°”ë€Œë©´ ì‹œìŠ¤í…œ ì „ì²´ì—ì„œ ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
- ì„±ëŠ¥ ì €í•˜: ê¸°ë³¸í‚¤ëŠ” ë³´í†µ ì¸ë±ìŠ¤ë¡œ ê´€ë¦¬ë˜ëŠ”ë°, ê¸°ë³¸í‚¤ ê°’ì´ ë³€ê²½ë˜ë©´ ì¸ë±ìŠ¤ë„ ë‹¤ì‹œ ê°±ì‹ í•´ì•¼ë˜ë©°, ëŒ€ëŸ‰ ì—…ë°ì´íŠ¸ ì‹œì— ì„±ëŠ¥ì— í° ì˜í–¥ì„ ì£¼ê²Œ ëœë‹¤.
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í˜¼ë€: ê¸°ë³¸ í‚¤ëŠ” "ë³€í•˜ì§€ ì•ŠëŠ” ì‹ë³„ì" ë¼ëŠ” ì „ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì—¬ëŸ¬ ë¡œì§ì´ ì„¤ê³„ë˜ê¸° ë•Œë¬¸ì—, ê°’ì´ ë°”ë€ë‹¤ë©´ ì „ì œê°€ ë¬´ë„ˆì ¸ í˜¼ë€ì„ ì´ˆë˜í•  ìˆ˜ ìˆë‹¤.

primary key ëŠ” ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì œì•½ì¡°ê±´ì´ í•„ìš”í•˜ë‹¤.

- UNIQUE: í…Œì´ë¸”ì— ì˜¤ì§ í•˜ë‚˜ë§Œ ì¡´ì¬
- NOT NULL: NULL ê°’ X
- INDEX: ê¸°ë³¸í‚¤ë¡œ ë“±ë¡ë˜ë©´ ìë™ìœ¼ë¡œ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.

##### Foreign Key

Foreign-key Constraints ë¥¼ ì‚´í´ë³´ì. t2 í…Œì´ë¸”ì—ì„œ t1 í…Œì´ë¸”ì˜ ì†ì„± ê°’ì´ í•„ìš”í•˜ë‹¤ê³  í•´ë³´ì. ê·¸ëŸ°ë° í•´ë‹¹ ê°’ì´ t1 ì˜ ì–´ë””ì—ë„ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì´ëŠ” íƒ€ë‹¹í•˜ì§€ ì•Šë‹¤. ì¦‰ t2ëŠ” t1ì— ì¡´ì¬í•˜ëŠ” ê°’ì„ ê°€ì ¸ì•¼ í•œë‹¤.

ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ì€ ë¦´ë ˆì´ì…˜ r1 ì†ì„± A ê°€ ë¦´ë ˆì´ì…˜ r2 ì˜ ê¸°ë³¸í‚¤ Bë¥¼ ì°¸ì¡°í•œë‹¤ê³  í•  ë•Œ, ì–´ë–¤ ë°ì´í„°ë² ì´ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì—ì„œë„ r1 ì˜ ê° íŠœí”Œì´ ê°€ì§€ëŠ” A ê°’ì€ ë°˜ë“œì‹œ r2 ì˜ ì–´ë–¤ íŠœí”Œì˜ B ê°’ê³¼ ì¼ì¹˜í•´ì•¼ í•¨ì„ ì˜ë¯¸í•œë‹¤.

- Referential Integerity:
- NULLITY: NULL ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ
- CASCADE, RESTRICT, SET NULL: ì°¸ì¡° ëŒ€ìƒì´ ì‚­ì œë˜ê±°ë‚˜ ë³€ê²½ë  ê²½ìš° ë™ì‘ì„ ì„¤ì •í•  ìˆ˜ ìˆìŒ

### Schema Diagrams

- ê¸°ë³¸í‚¤ëŠ” ë°‘ì¤„ë¡œ
- ë¦´ë ˆì´ì…˜ì˜ ì™¸ë˜í‚¤ëŠ” ì°¸ì¡°ë˜ëŠ” ë¦´ë ˆì´ì…˜ì˜ ê¸°ë³¸í‚¤ë¡œ í–¥í•˜ëŠ” í™”ì‚´í‘œë¡œ
- ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ì´ ì•„ë‹Œ ì°¸ì¡° ë¬´ê²°ì„± ì œì•½ì¡°ê±´ì„ í‘œí˜„í•  ë•ŒëŠ” ì–‘ìª½ í™”ì‚´í‘œë¡œ

> í˜„ì¬ëŠ” E-R ë‹¤ì´ì–´ê·¸ë¨ì„ ë§ì´ ì“´ë‹¤.

### Relational Query Languages

ì¿¼ë¦¬ ì–¸ì–´ëŠ” ì‚¬ìš©ìê°€ DB ë¡œ ë¶€í„° ì •ë³´ë¥¼ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì–¸ì–´ë¥¼ ë§í•˜ëŠ”ë°, ì´ëŸ¬í•œ ì–¸ì–´ë“¤ì€ ì¼ë°˜ì ì¸ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë³´ë‹¤ ë†’ì€ ìˆ˜ì¤€ì—ì„œ ë™ì‘í•œë‹¤.

ì¿¼ë¦¬ì–¸ì–´ëŠ”
- imperative(ëª…ë ¹í˜•): ì‚¬ìš©ìê°€ DBì—ì„œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ íŠ¹ì • ì—°ì‚°ì˜ ìˆœì„œë¥¼ ì‹œìŠ¤í…œì— ì§€ì‹œí•  ìˆ˜ ìˆìŒ(ì¼ë°˜ì ìœ¼ë¡œ ìƒíƒœ ë³€ìˆ˜ë¥¼ ê°€ì§)
- functional(í•¨ìˆ˜í˜•): DBì˜ ë°ì´í„°ë‚˜ ë‹¤ë¥¸ í•¨ìˆ˜ì˜ ê²°ê³¼ì— ëŒ€í•´ ë™ì‘í•˜ëŠ” í•¨ìˆ˜ë“¤ì˜ í‰ê°€(evaluation) ìœ¼ë¡œ í‘œí˜„ëœë‹¤. side-effect ê°€ ê±°ì˜ ì—†ì–´ í”„ë¡œê·¸ë¨ ìƒíƒœë¥¼ ê°±ì‹ í•˜ì§€ ì•ŠëŠ”ë‹¤.
- declarative(ì„ ì–¸í˜•): êµ¬ì²´ì ì¸ ì—°ì‚° ìˆœì„œë‚˜ í•¨ìˆ˜ í˜¸ì¶œì„ ëª…ì‹œí•˜ì§€ ì•Šê³ , ë‹¨ìˆœíˆ ì›í•˜ëŠ” ì •ë³´ë§Œì„ ê¸°ìˆ í•œë‹¤.

ìœ¼ë¡œ ë¶„ë¥˜í•  ìˆ˜ ìˆë‹¤.

#### SQL Languages Parts

- DDL
- DML
- Integrity
- View Definition
- Transaction Control
- Embedded SQL & Dynamic SQL
- Authorization

### SQL Data Definition

DB ì˜ ê´€ê³„ë“¤ì˜ ì§‘í•©ì€ DDL ì„ ì‚¬ìš©í•˜ì—¬ ì§€ì •ë˜ëŠ”ë°, SQL DDL ì€ ë‹¨ìˆœíˆ ë¦´ë ˆì´ì…˜ ì§‘í•©ë¿ ì•„ë‹ˆë¼ ê° ë¦´ë ˆì´ì…˜ì— ëŒ€í•œ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.

- relation schema
- attribute type
- integrity constraints
- index set
- physical storage structure

ì—¬ê¸°ì„œëŠ” ìŠ¤í‚¤ë§ˆì™€ ë°ì´í„°íƒ€ì…ë§Œ ë³´ì.

#### Basic Types

- char(n): ë¬´ì¡°ê±´ n byte ì˜ ë¬¸ìì—´ì´ í• ë‹¹, "ABC" ë¥¼ ì €ì¥ì‹œ ë’¤ì— ê³µë°± 7ê°œ ë¬¸ìê°€ ì¶”ê°€ë¨
- varchar(n): ê³µë°±ì´ ì¶”ê°€ë˜ì§€ ì•ŠìŒ n ì´í•˜ì˜ ë¬¸ìì—´ë¡œ ì €ì¥ ê°€ëŠ¥

> char, varchar íƒ€ì…ì„ ë¹„êµí•  ë•Œ ì‚¬ìš©í•˜ëŠ” DB ì— ë”°ë¼ ì§ê´€ì ìœ¼ë¡œëŠ” ê²°ê³¼ê°€ ê°™ì•„ ë³´ì—¬ë„ ì‹¤ì œë¡œëŠ” false, true ê°€ ë  ìˆ˜ë„ ìˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œ ë•Œë¬¸ì— varchar ë¥¼ ê¶Œì¥í•˜ëŠ” í¸ì´ë‹¤. ë˜í•œ ë‹¤êµ­ì–´ ë°ì´í„° ì €ì¥ì„ ìœ„í•´ **nvarchar** ë„ ìˆë‹¤. 

- int
- smallint
- numeric(p, d): pìë¦¬.dìë¦¬
- real, double precision
- float(n)

> ê° íƒ€ì…ì€ null ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

#### Basic Schema Definition

{% highlight sql %}
create table department
(dept_name varchar(20),
 building varchar(15),
 budget numeric(12,2),
 primary key (dept_name));
{% endhighlight %}

ìë°”ë‘ ë™ì¼í•˜ê²Œ sql ë¬¸ì€ í•­ìƒ ë¬¸ì¥ì˜ ëì— ;ê°€ ë¶™ìœ¼ë©°, ë§¨ ë§ˆì§€ë§‰ì— integrity constraints ë“¤ì„ ë” ë„£ì„ ìˆ˜ ìˆë‹¤(primary key ì²˜ëŸ¼). ì´ëŸ¬í•œ ìì£¼ ì“°ì´ëŠ” constriaints ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:

- primary key ($A_1, A_2, ..., A_m$)
- foreign key ($A_1, A_2, ..., A_m$) references
- not null

ë‹¤ìŒ ì¥ì—ì„œ DDL ì„ ë” ìì„¸íˆ ë‹¤ë£¨ì.