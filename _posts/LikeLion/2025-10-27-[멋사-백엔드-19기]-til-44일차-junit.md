---
layout: post
title:  "[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 44ì¼ì°¨ JUnit"
date:   2025-10-27 09:03:55 +0900
categories: ë©‹ìŸì´ì‚¬ìì²˜ëŸ¼ ë©‹ì‚¬ ë°±ì—”ë“œ TIL Java Spring
---

<!--more-->

## ğŸ“‚ ëª©ì°¨
- [TDD](#tdd)
    - [Red-Green-Refactor](#red-green-refactor)
    - [ë‹¨ìœ„ í…ŒìŠ¤íŠ¸](#ë‹¨ìœ„-í…ŒìŠ¤íŠ¸)
        - [Test Coverage](#test-coverage)
    - [í†µí•© í…ŒìŠ¤íŠ¸](#í†µí•©-í…ŒìŠ¤íŠ¸)
    - [ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸](#ì‹œìŠ¤í…œ-í…ŒìŠ¤íŠ¸)
- [SpringBootTest](#springboottest)
    - [SpringBoot Web Test](#springboot-web-test)
    - [JUnit 5](#junit-5)
    - [ì£¼ìš” ì–´ë…¸í…Œì´ì…˜](#ì£¼ìš”-ì–´ë…¸í…Œì´ì…˜)
        - [@RepeatedTest](#repeatedtest)
        - [@ParameterizedTest](#parameterizedtest)
        - [@TestFactory](#testfactory)
    - [ë¼ì´í”„ì‚¬ì´í´ ê´€ë ¨](#ë¼ì´í”„ì‚¬ì´í´-ê´€ë ¨)
    - [Assertions](#assertions)
- [Mockito](#mockito)
    - [@Mock](#mock)
    - [@InjectMocks](#injectmocks)
    - [@Spy](#spy)
    - [@Captor](#captor)

---

## ğŸ“š ë³¸ë¬¸

### TDD

í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ì‘ì„±í•˜ê³  í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ” ì½”ë“œë¥¼ êµ¬í˜„í•˜ëŠ” ê°œë°œ ë°©ë²•ë¡ ì´ë‹¤.

- ì½”ë“œ í’ˆì§ˆ í–¥ìƒ
- ë²„ê·¸ ì¡°ê¸° ë°œê²¬
- ì„¤ê³„ ë‹¨ìˆœí™” ë° ìœ ì§€ë³´ìˆ˜ ìš©ì´
- ì½”ë”© ëª©í‘œì˜ ëª…í™•ì„±

#### Red-Green-Refactor

í…ŒìŠ¤íŒ…ì˜ ìƒíƒœëŠ” ë‹¤ìŒê³¼ ê°™ì´ í˜ëŸ¬ê°€ê²Œ ëœë‹¤.

1. Red: ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‘ì„±
    - ì•„ì§ ê¸°ëŠ¥ì´ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨
2. Green: ìµœì†Œí•œì˜ ì½”ë“œ ì‘ì„±ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í†µê³¼
    - ê¸°ëŠ¥ êµ¬í˜„
3. Refactor: ì½”ë“œ ë¦¬íŒ©í† ë§
    - í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ë¯€ë¡œ ì•ˆì „í•˜ê²Œ êµ¬ì¡° ê°œì„  ê°€ëŠ¥

#### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

í”„ë¡œê·¸ë¨ì˜ ê°€ì¥ ì‘ì€ ë‹¨ìœ„(ì£¼ë¡œ ë©”ì„œë“œ) ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸, ì¦‰ Bottom-Up ë°©ë²•ì´ë©°, ë‹¤ìŒ íŠ¹ì§•ì´ ìˆë‹¤.

- ë…ë¦½ì ì´ì–´ì•¼ í•¨
- ë¹ ë¥´ê²Œ ì‹¤í–‰ ê°€ëŠ¥
- ì‘ì€ ë‹¨ìœ„ì— ì§‘ì¤‘í•˜ì—¬ ê°€ì¥ ë¹„ìš©ì´ ì ìŒ

ë”°ë¼ì„œ ë³´í†µ ê°œë°œ ë‹¨ê³„ì—ì„œ ì±„íƒí•  ìˆ˜ ìˆëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤.

##### Test Coverage

ìµœì†Œ ìˆ˜ì¤€ ë¶€í„° 100% ì˜ í…ŒìŠ¤íŠ¸ ë²”ìœ„ ê¹Œì§€ ë§¤ ìˆ˜ì¤€ë§ˆë‹¤ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤ì‹œí•´ì•¼ í•œë‹¤.

ê°€ì¥ ìµœì†Œ ìˆ˜ì¤€ì˜ Coverage ëŠ” ë©”ì„œë“œ/í´ë˜ìŠ¤ ë‹¨ìœ„ì¼ ê²ƒì´ë‹¤.

#### í†µí•© í…ŒìŠ¤íŠ¸

ì—¬ëŸ¬ ëª¨ë“ˆ/ì»´í¬ë„ŒíŠ¸ê°€ í•¨ê»˜ ë™ì‘í•˜ëŠ”ì§€ë¥¼ í…ŒìŠ¤íŠ¸ í•œë‹¤.

- ëª¨ë“ˆ í˜¹ì€ í´ë˜ìŠ¤ ê°„ ìƒí˜¸ì‘ìš© í™•ì¸
- ì‹¤ì œ ì„œë¹„ìŠ¤ í™˜ê²½ê³¼ ìœ ì‚¬í•˜ê²Œ ê²€ì¦í•´ì•¼ í•œë‹¤

#### ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸

ì „ì²´ ì‹œìŠ¤í…œì„ í…ŒìŠ¤íŠ¸í•˜ë©°, ì–´í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ê°€ coverage ê°€ ëœë‹¤. ì´ë•ŒëŠ” ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê¸° ë•Œë¬¸ì— ì‹œë‚˜ë¦¬ì˜¤ ëª…ì„¸ì„œë¥¼ í†µí•´ í•˜ë‚˜í•˜ë‚˜ í…ŒìŠ¤íŠ¸ê°€ ì§„í–‰ë˜ëŠ” ë“¯í•˜ë‹¤.

> ì´ ì™¸ì—ë„ ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ë“¤ì´ ìˆê¸° ë•Œë¬¸ì— ì°¾ì•„ë³´ê¸°ë¥¼ ë°”ë€ë‹¤.

### SpringBootTest

ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë©´, ìŠ¤í”„ë§ ìì²´ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ê²Œ ë˜ëŠ”ë°, ì´ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì—ì„œ ì‚¬ìš©ë˜ê²Œ ëœë‹¤.

ì´ë¥¼ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œë„ ì‘ì„±í•˜ê¸° ìœ„í•´ ë˜ í…ŒìŠ¤íŠ¸ ì½”ë“œì™€ ì‹¤ì œ ê°œë°œ ì½”ë“œë¥¼ ë¶„ë¦¬ì‹œí‚¤ê¸° ìœ„í•´ Spring Initializer ì—ì„œ ìƒì„±ëœ í”„ë¡œì íŠ¸ì—ëŠ” `src/test` ë„ ìˆì—ˆë‹¤. ì—¬ê¸°ì„œëŠ” java ìª½ í´ë”ì™€ ë°ì¹¼ì½”ë§ˆë‹ˆì²˜ëŸ¼ í´ë˜ìŠ¤ë“¤ì„ ìƒì„±í•˜ì—¬ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ í•´ë†¨ë‹¤.

í•˜ì§€ë§Œ ì´ë ‡ê²Œ í…ŒìŠ¤íŠ¸í•  ë•Œ ìš°ë¦¬ëŠ” ì»¨í…ìŠ¤íŠ¸ë¥¼ ë“¤ê³ ì™€ì•¼ í•œë‹¤. í…ŒìŠ¤íŠ¸ ìª½ì—ì„œëŠ” ìŠ¤í”„ë§ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ì½”ë“œê°€ ì–´ë””ì—ë„ ì—†ì§€ë§Œ, ì–´ë…¸í…Œì´ì…˜ í•˜ë‚˜ë§Œìœ¼ë¡œ ìš°ë¦¬ê°€ java í´ë”ì— ê°œë°œí•œ í•´ë‹¹ `Spring Bean` ë“¤ì„ ë‹¤ ë“¤ê³  ì˜¨ë‹¤.

{% highlight java %}
@SpringBootTest
class UserServiceIntegrationTest {
    @Autowired
    UserService userService;
    @Autowired
    UserRepository userRepository;

    @Test
    void createUserTest() {
        User user = userService.createUser("hong", "hong@email.com");
        assertNotNull(userRepository.findById(user.getId()));
    }
}
{% endhighlight %}

**íŠ¹ì§•**
- ëª¨ë“  Spring Bean ì„ ë¡œë“œ -> ì˜ì¡´ì„± ì£¼ì…ì´ ê°€ëŠ¥
- ì‹¤ì œ DB, JPA Repository, Service ë“±ë“± ì„ í¬í•¨í•œ í†µí•© í…ŒìŠ¤íŠ¸ë„ ê°€ëŠ¥
- ì¼ë°˜ì ì¸ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(`@Test`) ë³´ë‹¤ ëŠë¦´ ìˆ˜ ìˆìŒ

> ë‹¨ìˆœíˆ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë§Œ í•˜ê³  ì‹¶ë‹¤ë©´ êµ³ì´ ì‚¬ìš©í•  í•„ìš”ëŠ” ì—†ê³ , Bean ì˜ ë²”ìœ„ë¥¼ ì¤„ì—¬ì£¼ëŠ” `@WebMvcTest`, `@DataJpaTest` ë“±ìœ¼ë¡œ ë²”ìœ„ë¥¼ ì¢íŒë‹¤.

ë”°ë¼ì„œ `@SpringBootTest` ëŠ” í´ë˜ìŠ¤ ìˆ˜ì¤€ì˜ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ì‘ì„±ë˜ë©°, `webEnvironment` ì†ì„±ì„ ì§€ì›í•œë‹¤. ì´ webEnvironment ëŠ” ë‹¤ìŒ 4ê°€ì§€ ì˜µì…˜ì´ ìˆë‹¤:

- `MOCK` <- ê¸°ë³¸ê°’
- `RANDOM_PORT`
- `DEFINED_PORT`
- `NONE`

MOCK ê¸°ëŠ¥ì€ ì˜ˆë¥¼ ë“¤ì–´ ì›¹ í™˜ê²½ì´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ **í´ë˜ìŠ¤ ê²½ë¡œì— ìˆëŠ” ê²½ìš°ì—ë§Œ ë‚´ì¥ ì„œë²„ë¥¼ ì‹œì‘í•˜ëŠ” ëŒ€ì‹  mock ì›¹ í™˜ê²½ì„ í™œìš©**í•˜ê²Œ ëœë‹¤. í•˜ì§€ë§Œ ì›¹ ê¸°ëŠ¥ì´ ì—†ë‹¤ë©´ ì¼ë°˜ `ApplicationContext` ë¥¼ ë¡œë”©í•˜ê²Œ ëœë‹¤.

ì´ ì™¸ì—ë„ ë‹¤ë¥¸ ì˜µì…˜ì—ëŠ” `RANDOM_PORT` ëŠ” ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¡œë”©í•˜ê³  ë‚´**ì¥ì„œë²„ë¥¼ ì‹œì‘í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥í•œ ì„ì˜ì˜ í¬íŠ¸ì— ë…¸ì¶œëœ ì‹¤ì œ ì›¹ í™˜ê²½**ì„ ì œê³µ, `DEFINED_PORT` ëŠ” í”„ë¡œí¼í‹°ì— ì •ì˜ëœ í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

ë³´í†µì€ `NONE` ì„ ë” ë§ì´ ì‚¬ìš©í–ˆì„í…ë°, ì´ ê°’ì´ ë°”ë¡œ ëª¨ì˜ ì›¹ í™˜ê²½ ì´ë‚˜ ì›¹ í™˜ê²½ì´ ì „í˜€ ì—†ëŠ” `ApplicationContext` ê°€ ìƒì„±ë˜ëŠ” ê²ƒì´ê³  ë‚´ì¥ ì„œë²„ë„ ì‹œì‘ë˜ì§€ ì•ŠëŠ”ë‹¤.

#### SpringBoot Web Test

ìœ„ì—ì„œ `SpringBootTest.WebEnvironment.MOCK` ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ì˜ ì›¹ í™˜ê²½ì„ í† ëŒ€ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ë¨ì„ ë³´ì•˜ë‹¤. ë³´í†µ ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í´ë˜ìŠ¤ ìˆ˜ì¤€ ì–´ë…¸í…Œì´ì…˜ê³¼ ê°™ì´ ì“´ë‹¤.

- `@AutoConfigureMockMVC`: Spring MVC ì›¹ ê³„ì¸µì„ Mock í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•  ë•Œ ì‚¬ìš©
    - ì´ê±¸ ë¶™ì´ë©´ ì‹¤ì œ ì„œë²„ë¥¼ ë„ìš°ì§€ ì•Šê³  DispatcherServlet, ì»¨íŠ¸ë¡¤ëŸ¬, í•„í„°, ì¸í„°ì…‰í„° ë“± MVC êµ¬ì„±ì„ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆìŒ
    - ë¦¬ì—‘í‹°ë¸ŒëŠ” ì§€ì›í•˜ì§€ ì•Šìœ¼ë©°, **Spring MVC** ì—ì„œë§Œ ì‚¬ìš©
- `@AutoConfigureWebTestClient`: 
    - **Spring WebFlux** í™˜ê²½ì—ì„œ ë¹„ë™ê¸° ì›¹ ê³„ì¸µì„ í…ŒìŠ¤íŠ¸
    - ì‹¤ì œ ì„œë²„ ë˜ëŠ” WebFlux ì»¨í…ìŠ¤íŠ¸ë¥¼ ë„ì›Œì„œ WebTestClient ë¡œ ìš”ì²­/ì‘ë‹µ ê²€ì¦ì„ í•œë‹¤ê³  í•œë‹¤(ìì„¸í•œê±´ ëª¨ë¥¸ë‹¤).
    - MVC ê¸°ë°˜ì—ì„œëŠ” ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©°, **Spring WebFlux** ì—ì„œë§Œ ì‚¬ìš©

ì¦‰ ë‘ ì–´ë…¸í…Œì´ì…˜ì˜ ì‚¬ìš©ì€ ê°ì ë¦¬ì•¡í‹°ë¸Œëƒ, MVC ëƒì— ë‹¬ë ¤ìˆë‹¤. ì•„ë˜ëŠ” ì˜ˆì‹œì´ë‹¤.

**Spring MVC Test**
{% highlight java %}
@SpringBootTest
@AutoConfigureMockMvc
class UserControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    void getUserTest() throws Exception {
        mockMvc.perform(get("/users/1"))
               .andExpect(status().isOk())
               .andExpect(jsonPath("$.name").value("hong"));
    }
}
{% endhighlight %}

**Spring WebFlux Test**
{% highlight java %}
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@AutoConfigureWebTestClient
class UserControllerWebFluxTest {

    @Autowired
    private WebTestClient webTestClient;

    @Test
    void getUserTest() {
        assert webTestClient.get().uri("/users/1")
                            .exchange()
                            .expectStatus().isOk()
                            .expectBody()
                            .jsonPath("$.name").isEqualTo("hong");
    }

    @Test
    void test(@Autowired WebTestClient client) {
        assert client.get() // GET ìš”ì²­ ë³´ë‚´ê² ë‹¤.
                     .uri("/aircraft") // í•´ë‹¹ URI ë¡œ ì—”ë“œí¬ì¸íŠ¸ ì„¤ì •
                     .exchange() // request / response ì˜ êµí™˜ì´ ì¼ì–´ë‚¬ë‹¤ë©´,
                     .expectStatus().isOk() // HTTP 200 ì˜ ì‘ë‹µì„ í™•ì¸ í›„ Response Body ë°˜í™˜
                     .expectBody(Iterable.class) // ë°”ë””ì— Iterable ì´ í¬í•¨ëëŠ”ì§€ í™•ì¸
                     .returnResult() // Iterable ì— í•´ë‹¹í•˜ëŠ” response íšŒìˆ˜
                     .getResponseBody() // response ì˜ ì‘ë‹µ ë°”ë”” ë°˜í™˜
                     .iterator() // iterator ë¡œ í˜• ë³€í™˜
                     .hasNext(); // ê°’ì´ í•˜ë‚˜ë¼ë„ ìˆë‹¤ë©´ true
    }
}
{% endhighlight %}

Flux ê¹Œì§€ëŠ” ë³´ì§€ ì•Šê³ , ìš°ì„  JUnit 5 ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ìµíˆì.

### JUnit 5

í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ì´ë‹¤. ê²€ì¦í•˜ëŠ” ì½”ë“œëŠ” ì£¼í”¼í„° ì—”ì§„ì´ í¬í•¨ëœ **JUnit 5**ë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìœ¼ë©°, ë‹¤ìŒ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•œë‹¤:

- ì´ì „ ë²„ì „ì— ë¹„í•´ ê°œì„ ëœ ì½”í‹€ë¦° ì½”ë“œ í…ŒìŠ¤íŠ¸
- `@BeforeAll`, `@AfterAll` ì‚¬ìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤í™”/ì„¤ì • ì„ í•œêº¼ë²ˆì— ê°€ëŠ¥
- JUnit 4 ì½”ë“œë„ í…ŒìŠ¤íŠ¸ì— ì§€ì›

JUnit ì€ 3ê°€ì§€ ëª¨ë“ˆë¡œ êµ¬ì„±ë˜ëŠ”ë° `JUnit Platform`, `JUnit Jupiter`, `JUnit Vintage` ë¡œ JUnit 5 ëŠ” `Jupiter + Platform` ì´ ë˜ê² ë‹¤(Vintage ëŠ” JUnit 3, 4 í…ŒìŠ¤íŠ¸ í˜¸í™˜ ëª¨ë“ˆì´ë¼ê³  ë³´ë©´ ëœë‹¤).

#### ì£¼ìš” ì–´ë…¸í…Œì´ì…˜

ê¸°ë³¸ì ìœ¼ë¡œ `@SpringBootTest` ë¥¼ í†µí•´ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰í• ë•Œ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì„ì„ ì„¤ì •í•˜ê³ , ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤. ë‚´ë¶€ì˜ ë©”ì„œë“œë“¤ì€ ì „ë¶€ `@Test` ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì„œë“œ ìˆ˜ì¤€ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œëŠ” ê·¸ ì™¸ì˜ ë‹¤ì–‘í•œ ì–´ë…¸í…Œì´ì…˜ì„ ë³¸ë‹¤.

##### @RepeatedTest

ë™ì¼í•œ ê¸°ëŠ¥ì„ ë°ì´í„°ë§Œ ë°”ê¿”ê°€ë©´ì„œ ì‹¤í–‰í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆë‹¤.

{% highlight java %}
class RepeatedTestExample {
    @RepeatedTest(5)
    @DisplayName("ë°˜ë³µ í…ŒìŠ¤íŠ¸ ê¸°ë³¸ ì˜ˆì‹œ")
    void repeatFiveTimes() {
        System.out.println("í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...");
        assertTrue(Math.random() >= 0); // ë‹¨ìˆœ ê²€ì¦
    }
}
{% endhighlight %}

##### @ParameterizedTest

ìœ„ì™€ ë°˜ë³µ ì‹¤í–‰ì€ ë˜‘ê°™ì§€ë§Œ, ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ë„£ë„ë¡ í•  ìˆ˜ ìˆë‹¤.

**@ValueSource ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤ ë„£ê¸°**
{% highlight java %}
@ParameterizedTest
@ValueSource(ints = {1, 2, 3})
void testPositiveNumbers(int number) {
    assertTrue(number > 0);
}
{% endhighlight %}

> ì§€ì› íƒ€ì…: `ints`, `longs`, `doubles`, `strings`, `classes`, ëª¨ë¥´ë©´ ë‚´ë¶€ ë³´ì

**@EnumSource ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤ ë„£ê¸°**
{% highlight java %}
enum Color { RED, GREEN, BLUE }

@ParameterizedTest
@EnumSource(Color.class)
void testEnum(Color color) {
    assertNotNull(color);
}
{% endhighlight %}

**@CsvSource ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤ ë„£ê¸°**
{% highlight java %}
@ParameterizedTest
@CsvSource({
    "apple, 1",
    "banana, 2",
    "orange, 3"
})
void testFruit(String name, int quantity) {
    assertNotNull(name);
    assertTrue(quantity > 0);
}
{% endhighlight %}

**@CsvFileSource ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤ ë„£ê¸°**
{% highlight java %}
@ParameterizedTest
@CsvSource({
    "apple, 1",
    "banana, 2",
    "orange, 3"
})
void testFruit(String name, int quantity) {
    assertNotNull(name);
    assertTrue(quantity > 0);
}
{% endhighlight %}

**@MethodSource ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤ ë„£ê¸°**
{% highlight java %}
static Stream<Arguments> provideNumbers() {
    return Stream.of(
        Arguments.of(1, 2, 3),
        Arguments.of(2, 3, 5)
    );
}

@ParameterizedTest
@MethodSource("provideNumbers")
void testAddition(int a, int b, int expected) {
    assertEquals(expected, a + b);
}
{% endhighlight %}

> ì¥ì : ë™ì , ë³µì¡í•œ ê°ì²´ ì œê³µ ê°€ëŠ¥

**@ArgumentsSource ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤ ë„£ê¸°**
{% highlight java %}
class MyArgumentsProvider implements ArgumentsProvider {
    @Override
    public Stream<? extends Arguments> provideArguments(ExtensionContext context) {
        return Stream.of(Arguments.of(1,2), Arguments.of(3,4));
    }
}

@ParameterizedTest
@ArgumentsSource(MyArgumentsProvider.class)
void testCustomProvider(int a, int b) {
    assertTrue(a < b);
}
{% endhighlight %}

> ì¥ì : ë§¤ìš° ìœ ì—°, ì™¸ë¶€ API ì—°ë™ ê°€ëŠ¥

**ì¥ì ì„ ì´ìš©í•˜ê¸° ìœ„í•´ì„œ ArgumentsSource, MethodSource ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„£ì–´ì£¼ì.** ë‚˜ë¨¸ì§€ëŠ” ë‹¤ì–‘í•˜ê²Œ ë„£ëŠ”ê±° ë¿ì´ë‹¤.

##### @TestFactory

ì‹¤í–‰ ì‹œì ì— í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ë©”ì„œë“œì— ë¶™ì´ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë©°, ì—¬ëŸ¬ ê°œì˜ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë“¤ì„ ë„£ì–´ ê²°ê³¼ë¡œ `Collection` í˜¹ì€ `Stream` ì˜ í˜•íƒœë¡œ ë°˜í™˜ë˜ê²Œ ëœë‹¤. ì˜ˆì‹œë¥¼ ë³´ì.

{% highlight java %}
class DynamicTestExample {
    @TestFactory
    Stream<DynamicTest> dynamicTestsFromStream() {
        return Stream.of(1, 2, 3)
                .map(n -> dynamicTest("test for " + n,
                        () -> assertTrue(n > 0)));
    }

    @TestFactory
    Stream<DynamicTest> dynamicStringTests() {
        String[] words = {"apple", "banana", "cherry"};

        return Stream.of(words)
                .map(word -> dynamicTest("Length > 0 for " + word,
                        () -> assertTrue(word.length() > 0)));
    }

    @TestFactory
    Stream<DynamicTest> dynamicTestsFromRandom() {
        return Stream.generate(() -> (int)(Math.random()*100))
                    .limit(5)
                    .map(n -> dynamicTest("test for " + n,
                                            () -> assertTrue(n >= 0)));
    }
}
{% endhighlight %}

`dynamicTest("ì´ë¦„", Executable)` ì„ í†µí•´ í…ŒìŠ¤íŠ¸ ì´ë¦„ê³¼ ë¡œì§ì„ ì§€ì •í•˜ë©°, ì´ë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ ì´ë¦„ì„ ëŸ°íƒ€ì„ì— ë™ì ìœ¼ë¡œ ì§€ì •í•  ìˆ˜ ìˆê²Œ ë˜ë©°, ëœë¤ê³¼ í•¨ê»˜ ì‚¬ìš©í•œë‹¤ë©´ ë” ê°•ë ¥í•œ í…ŒìŠ¤íŠ¸ ë²”ìœ„ê¹Œì§€ í™•ì¥ì‹œí‚¬ ìˆ˜ ìˆê³  ë°ì´í„°ê°€ ë™ì ì´ê²Œ ëœë‹¤.


#### ë¼ì´í”„ì‚¬ì´í´ ê´€ë ¨

ëª¨ë“  ê²ƒì€ í•¨ìˆ˜ ìˆ˜ì¤€ì´ë‹¤.

- `@BeforeEach`: non-static ìœ¼ë¡œ ê° í…ŒìŠ¤íŠ¸ ì „ì— ì‹¤í–‰
- `@AfterEach`: non-static ìœ¼ë¡œ ê° í…ŒìŠ¤íŠ¸ í›„ì— ì‹¤í–‰
- `@BeforeAll`: static ë©”ì„œë“œë¡œ í´ë˜ìŠ¤ ì „ì²´ í…ŒìŠ¤íŠ¸ ì „ í•œ ë²ˆ ì‹¤í–‰
- `@AfterAll`: static ë©”ì„œë“œë¡œ í´ë˜ìŠ¤ ì „ì²´ í…ŒìŠ¤íŠ¸ í›„ í•œ ë²ˆ ì‹¤í–‰

**ì¡°ê±´ë¶€ ì‹¤í–‰**
- `@EnabledOnOs`, `@DisabledOnOs`: íŠ¹ì • OS ì—ì„œë§Œ í™œì„±í™” / ë¹„í™œì„±í™”
- `@EnabledOnJre`, `@DisabledOnJre`: íŠ¹ì • JRE ì—ì„œë§Œ ì‹¤í–‰
- `@EnabledIf`, `@DisabledIf`: ì»¤ìŠ¤í…€ ì¡°ê±´`SpEL` ì— ë”°ë¼ ì‹¤í–‰/ë¹„í™œì„±í™” 

**ì˜ˆì™¸ ë° ì‹œê°„ ì§€ì •**
- `@Timeout`: `@Timeout(500, unit = TimeUnit.MILLISECONDS)`
- `assertThrows`

**í…ŒìŠ¤íŠ¸ ê·¸ë£¹í™”**
- `@Tag("fast")`: í…ŒìŠ¤íŠ¸ ê·¸ë£¹ì„ ì§€ì •í•˜ë©°, íŠ¹ì • ì§€ì • íƒœê·¸ë§Œ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.

#### Assertions

`Assertions` í´ë˜ìŠ¤ëŠ” ë‹¤ì–‘í•œ ê²€ì¦ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤ì´ë‹¤.

{% highlight java %}
assertEquals(expected, actual);
assertNotEquals(expected, actual);
assertTrue(condition);
assertFalse(condition);
assertNull(object);
assertNotNull(object);
assertThrows(Exception.class, () -> {...});
assertAll(() -> {...}, () -> {...}); // ì—¬ëŸ¬ ê²€ì¦ ë™ì‹œì—
assertArrayEquals(expected, actual);
assertIterableEquals(expected, actual);
assertLinesMatch(expectedLines, actualLines); // ë¬¸ìì—´ ë¼ì¸ ë‹¨ìœ„ ë¹„êµ
{% endhighlight %}

ì—¬ê¸°ì„œ ì£¼ì˜í•  ì ì€ expected ê°€ ìš°ë¦¬ê°€ ê¸°ëŒ€í•  ê°’ì´ ë“¤ì–´ê°€ì•¼ í•˜ì§€ ì‹¤ì œ ê°’ì´ ë“¤ì–´ê°€ë©´ ì•ˆëœë‹¤. ë‘˜ì€ ìë¦¬ê°€ ì •í•´ì ¸ ìˆë‹¤. ì´ëŸ° ë©”ì„œë“œë“¤ì„ `@Test` ì˜ ë‹¨ìœ„ì— ë§ê²Œ ë„£ì–´ì£¼ì–´ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

### Mockito

Spring í…ŒìŠ¤íŠ¸ì—ì„œ ìì£¼ ì“°ì´ëŠ” ê°€ì§œ ê°ì²´ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” íŒ¨í‚¤ì§€ì´ë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ í•  ëŒ€ìƒ ê°ì²´ê°€ ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ ì™¸ë¶€ ê°ì²´ë¥¼ í•„ìš”ë¡œ í•  ë•Œ ìš°ë¦¬ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì„£ë¶ˆë¦¬ ëª»í•˜ê²Œ ë˜ì§€ë§Œ, `Mockito` ë¥¼ í™œìš©í•˜ë©´ ê°€ì§œ ê°ì²´ë¥¼ ë¶€ì—¬í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í•  ìˆ˜ ìˆë‹¤.

#### @Mock

ê°€ì§œ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë©°, í•„ë“œì— ë¶™ì—¬ì£¼ê²Œ ëœë‹¤. í´ë˜ìŠ¤ì— `@ExtendWith(MockitoExtension.class)` ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ë©´ `Mockito` ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

Mock ì€ ë§ ê·¸ëŒ€ë¡œ ê°€ì§œì´ê¸° ë•Œë¬¸ì— íŠ¹ì§•ìœ¼ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:

- Mock ê°ì²´ëŠ” ì‹¤ì œ êµ¬í˜„ì²´ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³  í…ŒìŠ¤íŠ¸ì—ì„œ ì§€ì •í•œ ë™ì‘ë§Œ ìˆ˜í–‰
- Mock ê°ì²´ëŠ”` when(...).thenReturn(...)` ë˜ëŠ” `doReturn(...).when(...)` ê°™ì€ êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ í˜¸ì¶œ ì‹œ ë°˜í™˜ê°’ê³¼ ë™ì‘ì„ ì •ì˜ ê°€ëŠ¥
- Mock ê°ì²´ì˜ ë©”ì„œë“œ í˜¸ì¶œ ì—¬ë¶€, í˜¸ì¶œ íšŸìˆ˜ ë“±ì„ `verify(...)` ë©”ì„œë“œë¡œ ê²€ì¦ ê°€ëŠ¥

#### @InjectMocks

Mock ê°ì²´ë¥¼ ì£¼ì…í•  ëŒ€ìƒ í´ë˜ìŠ¤ë¥¼ ì§€ì •í•´ì•¼ í•œë‹¤. ì¦‰ ìœ„ì˜ `@Mock` ë§Œ ì‚¬ìš©í•´ì„œëŠ” ì•ˆë˜ë©°, ì´ë¥¼ ì–´ë””ì— ì£¼ì…ì‹œì¼œì¤„ì§€ë¥¼ ì§€ì •í•´ì¤˜ì•¼ í•˜ëŠ”ë° ì´ë¥¼ `@InjectMocks` ë¡œ í•œë‹¤. ê·¸ë˜ì„œ ë³´í†µ í´ë˜ìŠ¤ì— í•˜ë‚˜ë§Œ ì´ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¼ë°˜ì ì´ë©°, ì—¬ê¸°ì— `@Mock`, `@Spy` ê°€ ìë™ ì£¼ì…ì´ ë˜ê²Œ ëœë‹¤.

**ì˜ˆì‹œ**
{% highlight java %}
@ExtendWith(MockitoExtension.class)
class UserServiceTest {

    @Mock
    private UserRepository userRepository; // Mock ê°ì²´ ìƒì„±

    @InjectMocks
    private UserService userService; // Mock ì£¼ì…

    @Test
    void createUserTest() {
        User mockUser = new User("hong");
        when(userRepository.save(any(User.class))).thenReturn(mockUser);

        User user = userService.createUser("hong");
        assertEquals("hong", user.getName());

        verify(userRepository).save(any(User.class)); // í˜¸ì¶œ ì—¬ë¶€ ê²€ì¦
    }
}
{% endhighlight %}

#### @Spy

ì‹¤ì œ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ì¼ë¶€ ë©”ì„œë“œë§Œ Mock ì²˜ë¦¬ë¥¼ í•œë‹¤. ê°€ì§œë¡œ ì²˜ë¦¬í•˜ê³  ì‹¶ì€ ë©”ì„œë“œëŠ” `when(...).thenReturn(...)` ìœ¼ë¡œ ê°€ì§œ ë™ì‘ì„ ë®ì–´ì”Œìš¸ ìˆ˜ ìˆë‹¤.

{% highlight java %}
@Spy
private UserService userService = new UserService();

@Test
void testSpy() {
    when(userService.getUserName()).thenReturn("mocked name");

    // getUserName ì€ Mock ë™ì‘, ë‹¤ë¥¸ ë©”ì„œë“œëŠ” ì‹¤ì œë¡œ ì‹¤í–‰ë¨
    assertEquals("mocked name", userService.getUserName());
}
{% endhighlight %}

> Stub: í˜¸ì¶œë˜ë©´ ì •í•´ì§„ ê°’ì„ ëŒë ¤ì£¼ëŠ” ê°€ì§œ ê°ì²´

#### @Captor

`ArgumentCaptor` ë¥¼ ìƒì„±í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤. í…ŒìŠ¤íŠ¸ì—ì„œ **ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ì „ë‹¬ëœ ì¸ì(argument)** ë¥¼ ìº¡ì²˜(capture)í•˜ì—¬ ê²€ì¦í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.

- ë©”ì„œë“œê°€ í˜¸ì¶œë  ë•Œ ì „ë‹¬ëœ ì‹¤ì œ ì¸ì ê°’ì„ êº¼ë‚´ì„œ í™•ì¸í•  ìˆ˜ ìˆìŒ
- `verify()` ì™€ í•¨ê»˜ ì‚¬ìš©
- ì—¬ëŸ¬ ì¸ìë¥¼ ìˆœì„œëŒ€ë¡œ ê²€ì¦í•  ìˆ˜ ìˆìŒ

{% highlight java %}
@Mock
private UserRepository userRepository;

@InjectMocks
private UserService userService;

@Captor
private ArgumentCaptor<User> userCaptor; // ì¸ì ìº¡ì³ìš©

@Test
void createUser_capturesArgument() {
    userService.createUser("hong");

    verify(userRepository).save(userCaptor.capture()); // save()ì— ì „ë‹¬ëœ User ê°ì²´ ìº¡ì²˜

    User capturedUser = userCaptor.getValue();

    assertEquals("hong", capturedUser.getName()); // ì „ë‹¬ëœ ê°ì²´ì˜ ê°’ ê²€ì¦
}
{% endhighlight %}
