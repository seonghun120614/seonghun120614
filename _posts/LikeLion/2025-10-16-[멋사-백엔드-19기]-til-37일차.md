---
layout: post
title:  "[ë©‹ì‚¬ ë°±ì—”ë“œ 19ê¸°] TIL 37ì¼ì°¨"
date:   2025-10-16 13:55:33 +0900
categories: ë©‹ìŸì´ì‚¬ìì²˜ëŸ¼ ë©‹ì‚¬ ë°±ì—”ë“œ TIL Java Spring
---

<!--more-->

## ğŸ“‚ ëª©ì°¨
- [Spring MVC](#spring-mvc)
    - [Controller ì„¤ê³„](#controller-ì„¤ê³„)
        - [@RequestMapping](#requestmapping)
        - [@PathVariable](#pathvariable)
        - [@RequestParam](#requestparam)
        - [@RequestBody](#requestbody)
        - [â­ï¸ RequestHeader](#ï¸-requestheader)
        - [ê³ ê¸‰ ì˜µì…˜](#ê³ ê¸‰-ì˜µì…˜)
    - [Model & View](#model--view)
        - [Thymeleaf](#thymeleaf)
        - [Thymeleaf ì—ëŸ¬ ë©”ì‹œì§€ ì²˜ë¦¬](#thymeleaf-ì—ëŸ¬-ë©”ì‹œì§€-ì²˜ë¦¬)
        - [Forwarding ê³¼ì •](#forwarding-ê³¼ì •)
        - [Redirecting ê³¼ì •](#redirecting-ê³¼ì •)
        - [Forward vs Redirect ë¹„êµ ìš”ì•½](#forward-vs-redirect-ë¹„êµ-ìš”ì•½)

---

## ğŸ“š ë³¸ë¬¸

### Spring MVC

`Model-View-Controller` íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë ˆì„ì›Œí¬

- Model: ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„° + ë¡œì§
- View: ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ëŠ” í™”ë©´ (HTML, JSON ë“±)
- Controller: ìš”ì²­ì„ ë°›ê³  Modelê³¼ View ë¥¼ ì—°ê²°

![spring-mvc-pattern.png]({{ site.baseurl }}/img/spring-mvc-pattern.png)

Spring ì€ MVC 2.0 ë²„ì „ íŒ¨í„´ìœ¼ë¡œ ìœ„ì™€ ê°™ì´ ì ìš©í•˜ê³  ìˆë‹¤. DispatcherServlet ì€ ëª¨ë“  HTTP ìš”ì²­ì˜ ì§„ì…ì ì´ë©°, í†°ìº£ê³¼ ë””ìŠ¤íŒ¨ì³ê°€ ì—°ê²°ë˜ì–´ ìˆë‹¤. ì²˜ë¦¬ ê³¼ì •ì„ ìì„¸íˆ ì‚´í´ë³´ì.

1. ë¸Œë¼ìš°ì €ì—ì„œ ìš”ì²­, `DispatcherServlet` ì´ ë°›ìŒ
2. `HandlerMapping`ê°€ ì–´ë–¤ `Controller` ê°€ ì´ ìš”ì²­ì„ ì²˜ë¦¬í• ì§€ ì°¾ìŒ
3. `HandlerAdapter`ê°€ ì•Œë§ì€ `Controller` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•¨
4. `Controller` ëŠ” ë©”ì„œë“œ í˜¸ì¶œ ë°›ì•˜ì„ ë•Œ, `Model` ë°ì´í„°ë¥¼ ë§Œë“¤ê³  `View` ì´ë¦„ì„ ë°˜í™˜í•˜ê²Œ ëœë‹¤.
    - ëª¨ë¸ì„ ì–´ë–¤ view ì— ì ìš©ì‹œì¼œì¤„ì§€ë¥¼ ì•Œë ¤ì£¼ì–´ì•¼ í•˜ë‹ˆ view ì´ë¦„ì„ ë°˜í™˜í•˜ëŠ” ê²ƒì´ë‹¤.
5. `ViewResolver` ê°€ `View` ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
6. `View` ëŠ” ìƒì„±ëœ Model ì„ ì½ì–´ë“¤ì—¬ì„œ ë°ì´í„°ë¥¼ ì ìš©í•œë‹¤
7. `View` ê°€ ì‚¬ìš©ìì—ê²Œ ê²°ê³¼ë¥¼ ì „ë‹¬í•œë‹¤.

{% highlight text %}
Browser Request
      â†“
DispatcherServlet
      â†“
HandlerMapping â†’ ì–´ë–¤ Controllerì¸ì§€ ê²°ì •
      â†“
HandlerAdapter â†’ Controller í˜¸ì¶œ
      â†“
Controller â†’ Model ìƒì„± / View ì´ë¦„ ë°˜í™˜
      â†“
ViewResolver â†’ View ê°ì²´ ìƒì„±
      â†“
View â†’ ì‚¬ìš©ìì—ê²Œ HTML / JSON ì‘ë‹µ
{% endhighlight %}

ê°œë°œìê°€ ê´€ì—¬í•  ê²ƒì€ ë³´ë¼ìƒ‰ ë¿ì´ë‹¤. ì´ì œ ì´ë¥¼ ì„¤ê³„í•´ë³´ì.

#### Controller ì„¤ê³„

{% highlight java %}
@RestController
@RequestMapping("/users")
public class UserController {

    @GetMapping("/{id}")
    public UserDto getUser(@PathVariable Long id) {
        return userService.getUserById(id);
    }

    @PostMapping("/")
    public UserDto createUser(@RequestBody UserDto userDto) {
        return userService.createUser(userDto);
    }
}
{% endhighlight %}

í•˜ë‚˜í•˜ë‚˜ ëœ¯ì–´ë³¸ë‹¤.

`@Controller` ëŠ” Spring MVCì—ì„œ ì›¹ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ì„ì„ ë‚˜íƒ€ë‚´ëŠ” ì• ë„ˆí…Œì´ì…˜ì´ë‹¤. ì¦‰, ì´ í´ë˜ìŠ¤ ì•ˆì˜ ë©”ì„œë“œë“¤ì´ HTTP ìš”ì²­ê³¼ ì‘ë‹µì„ ë‹´ë‹¹í•˜ê²Œ ëœë‹¤.

**ì—­í• **
- í´ë˜ìŠ¤ ë ˆë²¨ì— ë¶™ìŒ â†’ ì´ í´ë˜ìŠ¤ê°€ `Controller` ì„ì„ Spring ì— ì•Œë¦¼
- Spring Bean ìœ¼ë¡œ ë“±ë¡ â†’ IoC ì»¨í…Œì´ë„ˆì—ì„œ ê´€ë¦¬

> â­ï¸ ì¤‘ìš”: **@RestController** = `@Controller` + `@ResponseBody` ì˜ ê²°í•©ì´ë©° ë°˜í™˜ê°’ì„ **JSON, HTTP Body** ë¡œ ë°”ë¡œ ì „ë‹¬í•˜ê³  ì‹¶ì„ ë•Œ ì“´ë‹¤.

##### @RequestMapping

`Controller` ì— ë“¤ì–´ê°€ëŠ” í•¨ìˆ˜ë“¤ì€ ì „ë¶€ ì œ ê¸°ëŠ¥ì„ í•˜ê¸° ìœ„í•´ `@RequestMapping` ì´ ì£¼ë¡œ ë¶™ëŠ”ë‹¤.

{% highlight java %}
@RequestMapping(value = "/users", method = RequestMethod.GET)
public List<User> getAllUsers() { ... }
{% endhighlight %}

ì´ë•Œ ìœ„ ì• ë„ˆí…Œì´ì…˜ì€ ë‹¤ìŒê³¼ë„ ê°™ë‹¤.

{% highlight java %}
@GetMapping("/users")
public List<User> getAllUsers() { ... }
{% endhighlight %}

ë” ì‰½ê²Œ ì œê³µí•˜ëŠ” í¸ì´ë‹¤. ì´ëŸ°ê²Œ 4ê°œ ë” ìˆë‹¤.

| ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ | ì„¤ëª…           | ì˜ˆì‹œ                       |
|-----------------|----------------|----------------------------|
| `@GetMapping`   | GET ìš”ì²­ ì²˜ë¦¬  | `@GetMapping("/users")`    |
| `@PostMapping`  | POST ìš”ì²­ ì²˜ë¦¬ | `@PostMapping("/users")`   |
| `@PutMapping`   | PUT ìš”ì²­ ì²˜ë¦¬  | `@PutMapping("/users/{id}")` |
| `@DeleteMapping`| DELETE ìš”ì²­ ì²˜ë¦¬ | `@DeleteMapping("/users/{id}")` |
| `@PatchMapping` | PATCH ìš”ì²­ ì²˜ë¦¬ | `@PatchMapping("/users/{id}")` |


{% highlight java %}
@RestController
@RequestMapping("/users")
public class UserController {

    @GetMapping("/{id}")
    public String getUser(@PathVariable Long id) {
        return "ì‚¬ìš©ì ì¡°íšŒ: " + id;
    }

    @PostMapping("/")
    public String createUser(@RequestBody String userName) {
        return "ì‚¬ìš©ì ìƒì„±: " + userName;
    }

    @PutMapping("/put/{id}")
    public String updateUser(@PathVariable Long id, @RequestBody String newName) {
        return "ì‚¬ìš©ì ìˆ˜ì •: " + id + " -> " + newName;
    }

    @DeleteMapping("/delete/{id}")
    public String deleteUser(@PathVariable Long id) {
        return "ì‚¬ìš©ì ì‚­ì œ: " + id;
    }

    @PatchMapping("/patch/{id}")
    public String patchUser(@PathVariable Long id, @RequestBody String newEmail) {
        return "ì‚¬ìš©ì ì´ë©”ì¼ ìˆ˜ì •: " + id + " -> " + newEmail;
    }
}
{% endhighlight %}

ìœ„ì™€ ê°™ì´ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤. ì—¬ê¸°ì„œ ì˜ ë³´ë©´ `@RequestMapping` ì–´ë…¸í…Œì´ì…˜ì„ í´ë˜ìŠ¤ ë ˆë²¨ì— ë‘ì–´ ë‚´ë¶€ ë©”ì„œë“œ ë ˆë²¨ì˜ `@RequestMapping` ë“¤ì— ëŒ€í•´ì„œ prefix ë¥¼ ì ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼ ëœë‹¤. 

ì´ì œ íŒŒë¼ë¯¸í„°ì— ëŒ€í•œ ë§¤í•‘ì„ ë³´ì.

**íŒŒë¼ë¯¸í„° ë§¤í•‘**
| ì–´ë…¸í…Œì´ì…˜        | ì„¤ëª…                                  |
|------------------|------------------------------------|
| `@PathVariable`   | **URL ê²½ë¡œì˜ ë³€ìˆ˜ ê°’**ì„ ë§¤í•‘          |
| `@RequestParam`   | **ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ê°’**ì„ ë§¤í•‘             |
| `@RequestBody`    | **ìš”ì²­ Body(JSON ë“±)ë¥¼ ê°ì²´**ë¡œ ë§¤í•‘   |
| `@RequestHeader`  | **HTTP Header ê°’** ë§¤í•‘             |
| `@CookieValue`    | **ì¿ í‚¤ ê°’** ë§¤í•‘                     |
| `@ModelAttribute` | **í¼ ë°ì´í„°ë¥¼ ê°ì²´**ì— ë°”ì¸ë”©           |

í•˜ë‚˜í•˜ë‚˜ ë‹¤ ì¤‘ìš”í•œ ê²ƒë“¤ì´ë‹ˆ ìì„¸íˆ ë³¸ë‹¤.

##### @PathVariable

Url ì— ìˆëŠ” ê°’ì„ ê·¸ëŒ€ë¡œ ë°›ì„ ìˆ˜ë„ ìˆë‹¤. ì´ëŠ” ì‚¬ìš©ì ê²€ìƒ‰ì„ ë” í¸ë¦¬í•˜ê²Œ í•  ìˆ˜ ìˆê³ , ìŠ¤í¬ë˜í•‘ ì •ë³´ë„ ì œê³µí•˜ê¸° í¸ë¦¬í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.

{% highlight java %}
@GetMapping("/users/{id}")
public String getUser(@PathVariable Long id) {
    return "ì‚¬ìš©ì ì¡°íšŒ: " + id;
}
{% endhighlight %}

##### @RequestParam

url ì „ì²´ì˜ query ë¶€ë¶„ìœ¼ë¡œ key-value ë¥¼ ë³´ë‚¼ë•Œ ì´ë¥¼ ë°›ê²Œ í•  ìˆ˜ë„ ìˆë‹¤.

{% highlight java %}
// GET /users/search?name=í™ê¸¸ë™&age=20
@GetMapping("/search")
public String searchUser(
        @RequestParam String name,
        @RequestParam int age) {
    return "ê²€ìƒ‰ ì‚¬ìš©ì: " + name + ", ë‚˜ì´: " + age;
}

@GetMapping("/search")
public String searchUser(
        @RequestParam(name = "name", required = false, defaultValue = "ìµëª…") String name,
        @RequestParam(name = "age", required = false, defaultValue = "0") int age) {
    return "ê²€ìƒ‰ ì‚¬ìš©ì: " + name + ", ë‚˜ì´: " + age;
}

// GET /users/filter?roles=ADMIN&roles=USER&roles=GUEST
@GetMapping("/filter")
public String filterUsers(@RequestParam List<String> roles) {
    return "í•„í„° ì—­í• : " + roles;
}
{% endhighlight %}

`PostMapping` ì„ í†µí•´ì„œ form ìœ¼ë¡œ `password`, `username` ë“±ë„ ë°›ì„ ìˆ˜ ìˆë‹¤.

> ì—¬ëŸ¬ ê°œë¥¼ ë°›ì„ ë•ŒëŠ” &ë¡œ ì—°ê²°í•˜ê³  key ë¥¼ ì¤‘ë³µí•´ì„œ ì„ ì–¸í•´ì£¼ë©´ ëœë‹¤.

##### @RequestBody

ë³´í†µ API ë§Œë“¤ ìš©ë„ë¡œ ì“°ì¸ë‹¤ ì™œëƒë©´ body ìì²´ê°€ êµ¬ì¡°í™”ëœ ë°ì´í„° í˜•íƒœë¡œ ë“¤ì–´ì™€ì•¼ ìë°” ê°ì²´ë¡œ ë³€í™˜í•˜ê¸° í¸í•˜ë©°, í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚¸ JSON ë“±ì˜ ë°ì´í„°ë¥¼ ê°ì²´ë¡œ ì§ì ‘ ë°›ì„ ë•Œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

{% highlight java %}
@PostMapping("/")
public String createUser(@RequestBody UserDto userDto) {
    return "ì‚¬ìš©ì ìƒì„±: " + userDto.getName() + ", ë‚˜ì´: " + userDto.getAge();
}
{% endhighlight %}

> `@RequestBody`: HTTP ìš”ì²­ì˜ Body ë¶€ë¶„(JSON, XML, í…ìŠ¤íŠ¸ ë“±)ì„ ìë°” ê°ì²´ë¡œ ë°”ë¡œ ë³€í™˜í•´ì£¼ëŠ” ì—­í• (ë³´í†µ JSON ë“±ìœ¼ë¡œ ë§¤í•‘)

##### â­ï¸ RequestHeader

{% highlight java %}
/*
 GET /users/header
 Authorization: Bearer abc123
 User-Agent: Chrome
*/

@GetMapping("/header")
public String getHeader(
        @RequestHeader("Authorization") String authHeader,
        @RequestHeader(value = "User-Agent", required = false) String userAgent) {

    return "ì¸ì¦ í—¤ë”: " + authHeader + ", ë¸Œë¼ìš°ì €: " + userAgent;
}
{% endhighlight %}

ë³´í†µ ì¸ì¦ í† í°ì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ íŒë³„í•  ë•Œ ì“¸ ìˆ˜ ìˆê² ë‹¤.

- í† í° ì¸ì¦
- API í‚¤ ê²€ì¦

##### ê³ ê¸‰ ì˜µì…˜

`RequestMapping` ì—ì„œ ë¶™ì¼ ìˆ˜ ìˆëŠ” ì˜µì…˜ì´ë©°, ë‹¨ìˆœíˆ ìš”ì²­ ë¿ ì•„ë‹ˆë¼ í˜•ì‹, íŒŒë¼ë¯¸í„°, í—¤ë”ì— ë”°ë¼ ë§¤í•‘ì„ ë” ì„¸ë°€íˆ ì œì–´í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

| ì˜µì…˜      | ì„¤ëª…                                      |
|-----------|------------------------------------------|
| `consumes`| ìš”ì²­ Content-Type ì œí•œ (`application/json`) |
| `produces`| ì‘ë‹µ Content-Type ì§€ì • (`application/json`) |
| `params`  | íŠ¹ì • ìš”ì²­ íŒŒë¼ë¯¸í„° ì¡´ì¬ ì—¬ë¶€ë¡œ ë§¤í•‘       |
| `headers` | íŠ¹ì • HTTP í—¤ë” ì¡´ì¬ ì—¬ë¶€ë¡œ ë§¤í•‘           |

**ì‚¬ìš© ì˜ˆì‹œ**

`consumes` ëŠ” **ìš”ì²­ Content-Type** ì„ ì œí•œí•˜ëŠ”ë°, ì‰½ê²Œ ë§í•´ì„œ JSON ìš”ì²­ë§Œ ì²˜ë¦¬í•˜ê²Œ ì œí•œí•˜ë„ë¡ í•  ìˆ˜ ìˆê³  ë‹¤ë¥¸ ë‹¤ì–‘í•œ ê²ƒë“¤ì´ ìˆë‹¤.

**consumes**
{% highlight java %}
@PostMapping(value = "/users", consumes = "application/json")
public String createUser(@RequestBody UserDto userDto) {
    return "JSONìœ¼ë¡œ ì‚¬ìš©ì ìƒì„±: " + userDto.getName();
}
{% endhighlight %}

produces ëŠ” **ì‘ë‹µì˜ Content-Type** ì„ ì§€ì •í•œë‹¤. ìœ„ë‘ ë‹¤ë¥´ë‹¤. ë§Œì•½ ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥ë˜ì—ˆë‹¤ë©´ JSON í˜•íƒœë¡œë§Œ ì‘ë‹µí•˜ë„ë¡ ì§€ì •í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤.

**produces**
{% highlight java %}
@GetMapping(value = "/users/{id}", produces = "application/json")
public UserDto getUser(@PathVariable Long id) {
    return new UserDto(id, "í™ê¸¸ë™", 25);
}
{% endhighlight %}

params ëŠ” íŠ¹ì • ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¡°ê±´ì´ ìˆì„ ë•Œë§Œ ë§¤í•‘ì„ í•˜ê²Œ ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ admin ì´ë¼ëŠ” parameter key ì— value ë¡œ `true` ê°€ ì•„ë‹ˆë¼ë©´ í•´ë‹¹ í•¨ìˆ˜ëŠ” ë§¤í•‘ì´ ì•ˆë˜ê²Œ ëœë‹¤. ë”°ë¼ì„œ ë‘ ë©”ì„œë“œëŠ” ë‹¤ë¥¸ ë©”ì„œë“œë¡œ ë™ì‘ë˜ê³  ì¤‘ë³µ ì„ ì–¸ìœ¼ë¡œ ì˜¤ë¥˜ê°€ ì•ˆëœ¬ë‹¤.

**params**
{% highlight java %}
// ì˜ˆ: /users/search?admin=true ì¼ ë•Œë§Œ ë§¤í•‘ë¨
@GetMapping(value = "/users/search", params = "admin=true")
public String searchAdminUsers() {
    return "ê´€ë¦¬ì ê³„ì • ê²€ìƒ‰";
}

// ì˜ˆ: /users/search?role=user ì¼ ë•Œë§Œ ë§¤í•‘ë¨
@GetMapping(value = "/users/search", params = "role=user")
public String searchNormalUsers() {
    return "ì¼ë°˜ ì‚¬ìš©ì ê²€ìƒ‰";
}
{% endhighlight %}

headers ëŠ” ìš”ì²­ì´ ì˜¤ëŠ” HTTP í—¤ë”ì— ì¡°ê±´ì´ ìˆì„ë•Œë§Œ ë§¤í•‘ì„ í•˜ê²Œ ëœë‹¤. ë¸Œë¼ìš°ì € ë³„ë¡œ ì‚¬ìš©í•˜ëŠ” API ê°€ ë‹¬ë¼ì„œ ê·¸ì— í˜¸í™˜ë˜ëŠ” ì²˜ë¦¬ë¥¼ í•  ìˆ˜ë„ ìˆë‹¤.

**headers**
{% highlight java %}
@GetMapping(value = "/users/version", headers = "X-API-VERSION=1")
public String getUserV1() {
    return "API Version 1 í˜¸ì¶œë¨";
}

@GetMapping(value = "/users/version", headers = "X-API-VERSION=2")
public String getUserV2() {
    return "API Version 2 í˜¸ì¶œë¨";
}
{% endhighlight %}

ì´ì œ Model ê³¼ View ë¥¼ ë³´ì.

#### Model & View

ëª¨ë¸ì€ ë‹¨ìˆœíˆ ë°ì´í„°ë¥¼ ë‹´ëŠ” í†µ(Bean) ì´ë©°, ìš”ì²­ê³¼ ì‘ë‹µ ì‚¬ì´ì—ì„œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” í•µì‹¬ ë§¤ê°œì²´ì´ë‹¤. Spring MVC ì—ì„œëŠ” ë‹¤ìŒ 3ê°€ì§€ í˜•íƒœë¡œ `Model` ì„ ë‹¤ë£¬ë‹¤.

- `org.springframework.ui.Model`: ë‹¨ìˆœ key-value ì €ì¥ì†Œ
- `ModelMap`: Model ê³¼ ìœ ì‚¬í•˜ë‚˜ `LinkedHashMap` ê¸°ë°˜
- `ModelAndView`: `Model` + `ViewName` ì„ í•œë²ˆì— ê´€ë¦¬

1.	ì‚¬ìš©ìì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ `DispatcherServlet` ì´ í•´ë‹¹ `Controller` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤.
2.	`Controller` ë©”ì„œë“œëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ `Model` ì— ë‹´ëŠ”ë‹¤.
3.	`DispatcherServlet` ì€ `Model` ì— ë‹´ê¸´ ë°ì´í„°ë¥¼ `View` ì— ì „ë‹¬í•œë‹¤.
4.	`View(ì˜ˆ: Thymeleaf, JSP)` ëŠ” `${key}` ë˜ëŠ” `*{key}` ë¬¸ë²•ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì°¸ì¡°í•œë‹¤.

**String ì˜ˆì‹œ**
{% highlight java %}
@Controller
@RequestMapping("/example")
public class ExampleController {

    @GetMapping("/model")
    public String modelExample(Model model) {
        // Modelì— ë°ì´í„° ë‹´ê¸°
        model.addAttribute("message", "Hello, Model!");
        model.addAttribute("number", 42);

        // view ì´ë¦„ ë°˜í™˜ (hello.html)
        return "hello";
    }
}
{% endhighlight %}

**ModelMap ì˜ˆì‹œ**
{% highlight java %}
@Controller
@RequestMapping("/example")
public class ExampleController {

    @GetMapping("/modelmap")
    public String modelMapExample(ModelMap modelMap) {
        // ModelMapì— ë°ì´í„° ë‹´ê¸°
        modelMap.put("message", "Hello, ModelMap!");
        modelMap.put("number", 123);

        // view ì´ë¦„ ë°˜í™˜ (hello.html)
        return "hello";
    }
}
{% endhighlight %}

**ModelAndView ì˜ˆì‹œ**
{% highlight java %}
@Controller
@RequestMapping("/example")
public class ExampleController {

    @GetMapping("/modelandview")
    public ModelAndView modelAndViewExample() {
        ModelAndView mav = new ModelAndView();

        // view ì´ë¦„ ì§€ì •
        mav.setViewName("hello");

        // ë°ì´í„° ì¶”ê°€
        mav.addObject("message", "Hello, ModelAndView!");
        mav.addObject("number", 999);

        return mav;
    }
}
{% endhighlight %}

> redirect ë°©ì‹ì€ `ModelAndView("redirect:(path)")` ì²˜ëŸ¼ `ModelAndView` ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

---

##### Thymeleaf

Java spring ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” HTML ë Œí„°ë§ ì„œë²„ì‚¬ì´ë“œ í…œí”Œë¦¿ ì—”ì§„ì´ë‹¤.

ê¸°ë³¸ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ê³ , `resorces/templates/` í´ë”ì— html ì„ ì €ì¥í•˜ê²Œ ëœë‹¤.

{% highlight html %}
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Thymeleaf ì˜ˆì œ</title>
</head>
<body>
    <h1 th:text="${message}">Hello</h1>
</body>
</html>
{% endhighlight %}

ê¼­ html ì— íƒœê·¸ë¡œ `xmlns:th="http://www.thymeleaf.org"` ë¥¼ ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤. th ëŠ” ììœ ë‹¤. Thymeleaf ëŠ” `View` ê³„ì¸µì— í¬í•¨ë˜ëŠ” ì• ì´ë©°, ì—¬ê¸°ì— ë“¤ì–´ê°€ëŠ” ë°ì´í„°ë“¤ì´ ì „ë¶€ `Model` ì—ì„œ ê°€ì ¸ì˜¤ê²Œ ë˜ê² ë‹¤.

**í…ìŠ¤íŠ¸ í‘œí˜„**
- `th:text="${var}`: ë³€ìˆ˜ ê°’ ì¶œë ¥
- `th:utext="${var}`: HTML íƒœê·¸ë¥¼ í¬í•¨í•œ ë¬¸ìì—´ ì¶œë ¥ (escape ì•ˆí•¨)
- `th:inline="text"`: í…ìŠ¤íŠ¸ ì¸ë¼ì¸ í‘œí˜„ ê°€ëŠ¥ ${var} ì‚¬ìš©

**ì†ì„± ë°”ì¸ë”©**
- `th:href="@{/home}"`: ë§í¬ URL ë°”ì¸ë”©
- `th:src="@{/images/logo.png}"`: ì´ë¯¸ì§€ src ë°”ì¸ë”©
- `th:class="@{condition ? 'active' : ''}` ì¡°ê±´ë¶€ í´ë˜ìŠ¤ ì ìš©

**ì¡°ê±´ë¬¸**
- `th:if`: ì¡°ê±´ì´ true ë©´ í•´ë‹¹ íƒœê·¸ ë Œë”ë§
- `th:unless`: ì¡°ê±´ì´ false ë©´ í•´ë‹¹ íƒœê·¸ ë Œë”ë§

> `<p th:text="${user.age >= 18 ? 'ì„±ì¸' : 'ë¯¸ì„±ë…„'}"></p>` ì²˜ëŸ¼ ì“¸ ìˆ˜ë„ ìˆë‹¤.

**ë°˜ë³µë¬¸**
- `th:each="(for ë‚´ë¶€ ë³€ìˆ˜) : ${var}"`: ì»¬ë ‰ì…˜ ë°˜ë³µ

**URL ë§í¬ ì²˜ë¦¬**
- `th:href=@{ê²½ë¡œ}`: ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œ ìë™ ì ìš©ì´ ëœë‹¤. `${}` ì™€ ê°™ì´ ê²½ë¡œ ì•ˆì— íŒŒë¼ë¯¸í„° í¬í•¨ ê°€ëŠ¥

> ì‹¤ìŠµ ì½”ë“œì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë˜ì–´ ìˆëŠ”ë°, `<a th:href="@{/users/{id}(id=${user.id})}">View Profile</a>` {} ëŠ” ë‹¨ìˆœ ë³€ìˆ˜ì´ë©° $ ë‚˜ * ë“±ì´ ì—†ë‹¤. ì´ë•ŒëŠ” () ë¥¼ í†µí•´ id ì— ì§ì ‘ ë„£ì„ ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆë‹¤.

**ë³€ìˆ˜ í‘œí˜„ì‹**
- `${var}`: ì¼ë°˜ ë³€ìˆ˜
- `*{field}`: form ê°ì²´ì˜ field (th:object ì•ˆì—ì„œ)

{% highlight java %}
<!-- Form ì²˜ë¦¬ -->
<form th:action="@{/users}" th:object="${userForm}" method="post">
    <input type="text" th:field="*{username}" />
    <input type="email" th:field="*{email}" />
    <button type="submit">Submit</button>
</form>
{% endhighlight %}

- `#{msg.key}`: ë©”ì‹œì§€ êµ­ì œí™”(i18n)
    - `messages.properties` ì— `greeting=ì•ˆë…•í•˜ì„¸ìš”, {0}ë‹˜`ì˜ key-value ê°€ ìˆë‹¤ê³  ì³ë³´ì.  
    Thymeleaf ë¥¼ ì“°ëŠ” HTML ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì“¸ ìˆ˜ ìˆë‹¤.  
    `<p th:text="#{greeting(${user.name})}">ê¸°ë³¸ ì¸ì‚¬</p>`

- `~{template}`: fragment/template ì°¸ì¡° ì•„ë˜ë¥¼ í†µí•´ ë” ìì„¸íˆ ì‚´í´ë³´ì.

**th:replace**
{% highlight java %}
<!-- header.html -->
<!-- fragment ë“±ë¡ -->
<div th:fragment="header">
    <h1>ì‚¬ì´íŠ¸ í—¤ë”</h1>
</div>

<!-- main.html -->
<!-- fragment ì‚¬ìš© -->
<div th:replace="header :: header"></div>
{% endhighlight %}

í…œí”Œë¦¿ì˜ ìœ„ì¹˜ëŠ” `application.yml` ì´ë‚˜ í”„ë¡œí¼í‹°ì— `spring.thymeleaf.prefix=classpath:/templates/`, `spring.thymeleaf.suffix=.html` ì²˜ëŸ¼ ê¸°ë³¸ì ìœ¼ë¡œ ë„£ì–´ì ¸ìˆê³ , ì´ë¥¼ ë”°ë¡œ ì§€ì •í•˜ì—¬ ë„£ì–´ì¤„ ìˆ˜ ìˆë‹¤. ì´ë•Œ ê·¸ í•˜ìœ„ì˜ html ì— ëŒ€í•œ Thymeleaf ë¬¸ë²•ìœ¼ë¡œ ì‘ì„±ëœ ë¬¸ì„œë“¤ì´ ë‹¤ ë¶ˆëŸ¬ì™€ì§€ê³ , fragment ë„ ê·¸ë•Œ ë“±ë¡ëœë‹¤. ì¶”ê°€ë¡œ ë” ì•Œì•„ë³¼ ê²ƒì€ `ClassLoaderTemplateResolver` ì„ í†µí•´ì„œë„ ì´ëŸ° template ìœ„ì¹˜ë¥¼ ì½”ë“œ ë‚´ì—ì„œë„ ì§€ì • ê°€ëŠ¥í•˜ë‹¤(ë‚˜ì¤‘ì— ì•Œì•„ë³´ì).

ìœ„ ì½”ë“œë¥´ ë³´ë©´ :: ë¥¼ í†µí•´ ìë°”ì˜ ì •ì  ì°¸ì¡° ë¬¸ë²•ê³¼ ë¹„ìŠ·í•˜ë©°, `th:replace` ë¥¼ í†µí•´ `(íŒŒì¼ ê²½ë¡œ) :: (fragment ëª…)` ì„ ì¨ì„œ ì§€ì • ê°€ëŠ¥í•˜ë‹¤.

**ì‹¤ìŠµ**
{% highlight java %}
<!-- fragments/header.html -->
<header th:fragment="header">
    <nav class="navbar">
        <a th:href="@{/}">Home</a>
        <a th:href="@{/about}">About</a>
        <a th:href="@{/contact}">Contact</a>
    </nav>
</header>

<!-- fragments/footer.html -->
<footer th:fragment="footer">
    <p>&copy; 2024 My Application</p>
</footer>

<!-- main.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>My App</title>
</head>
<body>
    <div th:replace="~{fragments/header :: header}"></div>

    <main>
        <h1>Main Content</h1>
        <!-- Page specific content -->
    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>
{% endhighlight %}

> fragment ì˜ ë‹¨ì ì€ ê²½ë¡œ ì§€ì •ì„ ì •í™•íˆ í•´ì£¼ì–´ì•¼ë§Œ í•œë‹¤.

**í¼ ì²˜ë¦¬**
- `th:action`: form ì œì¶œ URL
- `th:method`: form method
- `th:field`: input, select, textarea value ë°”ì¸ë”©

**ê¸°íƒ€ ìœ ìš© ì†ì„±**
- th:value
- th:checked
- th:selected
- th:disabled
- th:style
- th:onclick

> ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ th:(HTML ì˜ ì†ì„± ëª…) ì˜ í˜•íƒœë¥¼ ë ë©°, ê°’ ë‚´ë¶€ì— java ì½”ë“œë¥¼ ì¼ë¶€ ì§‘ì–´ë„£ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. êµ³ì´ ì™¸ìš°ì§€ ë§ì.

##### Thymeleaf ì—ëŸ¬ ë©”ì‹œì§€ ì²˜ë¦¬

í”„ë¡ íŠ¸ì—ì„œ ì—ëŸ¬ ì²˜ë¦¬ëŠ” ë³´í†µ ì…ë ¥ìª½ì— ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì•¼í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. ë”°ë¼ì„œ View ìª½ì—ëŠ” ê·¸ëŸ° í”¼ë“œë°± ì±…ì„ì´ ìˆê¸°ì— ì´ë¥¼ ì²˜ë¦¬í•´ì¤˜ì•¼ í•œë‹¤.

{% highlight java %}
<form method="post">
    <div class="form-group">
        <label for="username">ì‚¬ìš©ì ì´ë¦„</label>
        <input type="text" id="username" th:field="*{username}" class="form-control" />
        <p class="error" th:if="${#fields.hasErrors('username')}" th:errors="*{username}">ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
    </div>
    <div class="form-group">
        <label for="email">ì´ë©”ì¼</label>
        <input type="email" id="email" th:field="*{email}" class="form-control" />
        <p class="error" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">ìœ íš¨í•œ ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
    </div>
    <button type="submit" class="btn btn-primary">ì œì¶œ</button>
</form>
{% endhighlight %}

ì—¬ê¸°ì„œ ë³´ë©´ `th:object` ê°€ ì—†ëŠ”ë°ë„ ë¶ˆêµ¬í•˜ê³  `*{}` ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, thymeleaf ëŠ” ë‹¤ìŒ ê²½ìš°ì— `th:object` ê°€ ì—†ë”ë¼ë„ `*{}` ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

1. `@ModelAttribute` ë¡œ ë„˜ê²¨ ì£¼ëŠ” ê°ì²´ê°€ ë”± í•˜ë‚˜ì¼ ê²½ìš°
2. í•„ë“œë¡œ `@ModelAttribute` ë¥¼ ì‚¬ìš©í•´ ë„˜ê²¨ì¤¬ì„ ê²½ìš°

ì´ë‹¤. ì´ë•Œ `Post` ë¶€ë¶„ì„ ë³¸ë‹¤.

{% highlight java %}
@PostMapping("/register")
public String registerUser(@Valid @Moâ‚©delAttribute UserDto user,
                            BindingResult result,
                            RedirectAttributes redirectAttrs) {
    if (result.hasErrors()) {
        return "user/register";  // í¼ ì¬í‘œì‹œ
    }
{% endhighlight %}

Springì—ì„œ `@ModelAttribute` ì˜ value ì†ì„±ì€ ì„ íƒ ì‚¬í•­ì´ë©°, ì´ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ë§¤ê°œë³€ìˆ˜ì˜ ì´ë¦„ì´ ëª¨ë¸ ì†ì„±ì˜ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.

ë”°ë¼ì„œ `UserDto` ì— ê°ê° `username`, `email` ì´ ë“¤ì–´ê°€ê²Œ ë˜ê³  `@Valid` ë¥¼ í†µí•´ ë„ë©”ì¸ì˜ í•„ë“œì— ë¶™ì–´ìˆëŠ” `jakarta.validation.constraints` íŒ¨í‚¤ì§€ì˜ ì–´ë…¸í…Œì´ì…˜ ê²€ì¦ ë¡œì§ì„ ìˆ˜í–‰í•˜ê²Œ ëœë‹¤. ë§Œì•½ DTO ê°ì²´ ì—†ì´ ê·¸ëƒ¥ ë°›ê³  ì‹¶ë‹¤ë©´ 2ë²ˆì˜ ë°©ì‹ìœ¼ë¡œ `@ModelAttribute` ë¥¼ ì“°ë©´ ëœë‹¤.

{% highlight java %}
if (result.hasErrors()) {
    return "user/register";  // í¼ ì¬í‘œì‹œ
}

User savedUser = userService.register(user);
redirectAttrs.addFlashAttribute("message",
    "Registration successful!");

return "redirect:/users/" + savedUser.getId();
{% endhighlight %}

ìœ„ëŠ” `POST` ë§¤í•‘ì˜ ë‚´ë¶€ ì²˜ë¦¬ì´ë‹¤. ìš”ì²­ ë°›ì„ ë•Œ `Post` ë¡œ `BindingResult` ì— ê²°ê³¼ë¥¼ ë°›ê²Œ ëœë‹¤. ë°˜ë“œì‹œ `@Valid` ë‚˜ `@Validated` ì• ë„ˆí…Œì´ì…˜ê³¼ í•­ìƒ ì§ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤. `Spring` ì´ í¼ ë°ì´í„°ë¥¼ ê°ì²´ì— ë°”ì¸ë”© í•˜ê³ , ê·¸ ê³¼ì •ì—ì„œ ìƒê¸´ ì—ëŸ¬ë¥¼ ë‹´ëŠ” ê°ì²´ë¡œ ë³´ë©´ ëœë‹¤.

**BindingResult**
{% highlight java %}
@PostMapping("/register")
public String registerUser(
        @Valid @ModelAttribute UserDto user,
        BindingResult result) {
    
    if (result.hasErrors()) {
        return "user/register";
    }

    return "redirect:/users/success";
}
{% endhighlight %}

ë”°ë¼ì„œ `hasErrors()` ë¥¼ í† ëŒ€ë¡œ ì…ë ¥ ê°’ì— ëŒ€í•´ `Validation` ë¥¼ ìˆ˜í–‰í–ˆì„ë•Œ ì—ëŸ¬ê°€ ìˆì—ˆëŠ”ì§€ë¥¼ ê²€ì‚¬í•˜ê³ , ê²€ì‚¬ê°€ ëë‚˜ë©´ ë¡œì§ ìˆ˜í–‰ìœ¼ë¡œ ë„˜ì–´ê°€ê²Œ ëœë‹¤.

**RedirectAttributes**

ì´ì œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹œì ì—ì„œ ë°ì´í„° ì „ë‹¬ì„ ë„ì™€ì£¼ëŠ” ìŠ¤í”„ë§ ì¸í„°í˜ì´ìŠ¤ê°€ ë°”ë¡œ `RedirectAttributes` ì´ë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ FlashAttribute(ì¼ì‹œì  ì„¸ì…˜) ì„ ì‚¬ìš©í•´ì„œ í•œ ë²ˆë§Œ ì „ë‹¬ë˜ëŠ” ë°ì´í„°ë¥¼ ì €ì¥í•˜ì—¬ ì „ë‹¬í•´ì¤€ë‹¤.

{% highlight java %}
@PostMapping("/register")
public String registerUser(
        @Valid @ModelAttribute UserDto user,
        BindingResult result,
        RedirectAttributes redirectAttrs) {

    if (result.hasErrors()) {
        return "user/register"; // forward â€” ëª¨ë¸ ë°ì´í„° ê·¸ëŒ€ë¡œ ìœ ì§€
    }

    userService.register(user);

    // redirect ì‹œ ë°ì´í„° ì „ë‹¬
    redirectAttrs.addFlashAttribute("message", "íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
    redirectAttrs.addAttribute("userId", user.getId());

    return "redirect:/users/{userId}";
}
{% endhighlight %}

ë”°ë¼ì„œ
- `Model` ì€ forward ì‹œ ë°ì´í„° ìœ ì§€
- `RedirectAttributes` ëŠ” redirect ì‹œ ë°ì´í„° ìœ ì§€
ë¡œ ì •ë¦¬í•  ìˆ˜ ìˆë‹¤.

ì£¼ìš” ë©”ì„œë“œë“¤ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:
- `addAttribute(String key, Object value)`: ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì¶”ê°€
- `addFlashAttribute(String key, Object value)`: ì„¸ì…˜ì— ì„ì‹œ ì €ì¥ í›„ redirect ì´í›„ 1íšŒì„±ìœ¼ë¡œ êº¼ëƒ„

ì•„ë˜ëŠ” ì´ë¥¼ ì´í•´ í›„ ì‚¬ìš©í•˜ëŠ” ì˜ˆì‹œë‹¤.

**addAttribute()**

{% highlight java %}
redirectAttrs.addAttribute("id", user.getId());
redirectAttrs.addAttribute("status", "success");
return "redirect:/users/detail";
{% endhighlight %}

ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ ìµœì¢… URL ì€ ë‹¤ìŒê³¼ ê°™ê²Œ ëœë‹¤.

> `/users/detail?id=10&status=success`

**addFlashAttribute()**

{% highlight java %}
redirectAttrs.addFlashAttribute("message", "íšŒì›ê°€ì… ì™„ë£Œ!");
return "redirect:/users/welcome";
{% endhighlight %}

ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„:
- URL ì—ëŠ” ì•„ë¬´ê²ƒë„ ì•ˆ ë¶™ê³ 
- ë‚´ë¶€ì ìœ¼ë¡œ ì„¸ì…˜ì— ì ì‹œ ì €ì¥ì´ ëœë‹¤
    - ë‹¤ìŒ ìš”ì²­ì—ì„œ êº¼ë‚´ê±°ë‚˜ ìš”ì²­ ëë‚¬ì„ ì‹œ ì‚­ì œê°€ ë¨
    - ì¦‰, ì¼ì‹œì  ì„¸ì…˜ìœ¼ë¡œ, ë¦¬ë‹¤ì´ë ‰íŠ¸ ì§í›„ í•œ ë²ˆë§Œ ìœ ì§€ë˜ê³ , ìƒˆë¡œê³ ì¹¨í•˜ë©´ ì‚¬ë¼ì§

{% highlight java %}
@GetMapping("/users/welcome")
public String welcomePage(Model model) {
    model.getAttribute("message"); // "íšŒì›ê°€ì… ì™„ë£Œ!"
    return "welcome";
}
{% endhighlight %}

> Spring ì´ ë‚´ë¶€ì ìœ¼ë¡œ ì„¸ì…˜ì„ ì§ì ‘ ê±´ë“œë¦¬ì§€ ì•Šì•„ë„ `FlashMap` ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ URL ë…¸ì¶œ ë°©ì§€ë¡œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

##### Forwarding ê³¼ì •

ì´ì œ `Forwarding` ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì™„ë²½íˆ ì´í•´ê°€ ê°€ëŠ¥í•˜ë‹¤.

1. HTTP `POST` ìš”ì²­ì„ í†µí•´ WAS ë¥¼ ê±°ì³ `HttpServletRequest` ì™€ `HttpServletResponse` ë¥¼ ìƒì„±í•˜ê²Œ ëœë‹¤.
    - `HttpServletRequest` ì™€ `HttpServletResponse` ê°ì²´ëŠ” ìš”ì²­-ì‘ë‹µ ìƒëª…ì£¼ê¸°ë¥¼ ëŒ€í‘œí•˜ëŠ” ê°ì²´

2. `DispatcherServlet` ê°€ ì´ë¥¼ ë°›ê³  ë°›ì€ `HttpRequest` ì—ì„œì˜ path ë¥¼ `HandlerMapping` ì— ì£¼ê²Œ ëœë‹¤.

3. ë°›ì€ path ì— ì•Œë§ì€ mapping í•¨ìˆ˜ë¥¼ `Controller` ì—ì„œ ê³¨ë¼ì§€ê²Œ ëœë‹¤.
    - ì •í™•íˆëŠ” `HandlerMapping` ëª©ë¡ì„ ìˆœíšŒí•˜ë©°, ì´ URL ìš”ì²­ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” `Controller` ì˜ ë©”ì„œë“œë¥¼ íƒìƒ‰í•œë‹¤.
    - ì°¾ì€ ê²°ê³¼ë¥¼ `HandlerExecutionChain` ê°ì²´ë¡œ ë˜í•‘ í›„ ë°˜í™˜í•œë‹¤.
    - ì—¬ê¸°ì— ì‹¤ì œ `Controller` ë©”ì„œë“œì™€ `Interceptor` ì²´ì¸ì´ í¬í•¨ë˜ê²Œ ëœë‹¤.

4. `DispatcherServlet` ì€ `HandlerAdapter` ë¥¼ í†µí•´ ë°›ì•˜ë˜ ë°ì´í„°(`header`, `body` ë“±ë“±)ë¥¼ `Controller` ì— ë„˜ê²¨ ì£¼ê²Œ ëœë‹¤.
    - `Controller` ë§ˆë‹¤ í˜¸ì¶œ ë°©ì‹ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— `DispatcherServlet` ì€ `HandlerAdapter` ë¥¼ ì‚¬ìš©í•´ í˜¸ì¶œ ê³¼ì •ì„ ì¶”ìƒí™”í•œë‹¤.
    - Spring ì€ ê¸°ë³¸ì ìœ¼ë¡œ `RequestMappingHandlerAdapter` ë¥¼ ì‚¬ìš©í•˜ê³ , `ArgumentResolver` ì™€ `ReturnValueHandler` ì²´ê³„ë¥¼ í†µí•˜ì—¬ ë§¤ê°œë³€ìˆ˜ë¥¼ ë¶„ì„(`@RequestParam`, `@ModelAttribute`, `@RequestBody` ë“±)í•˜ê³ , ë°˜í™˜ê°’ì„ í•´ì„ í•˜ê²Œ ëœë‹¤(`String`, `ModelAndView`, `ResponseBody` ë“±)

5. ì´ì œ `Controller` ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì‹¤í–‰ì‹œì¼œ ì•Œë§ì€ ê²°ê³¼ê°’ì„ ë°˜í™˜ í›„

6. `Model` ì„ í†µí•´ ë„˜ê²¨ì¤„ ë°ì´í„°ë“¤ì„ ì •í•´ì¤€ í›„ì— ë·° ì´ë¦„ì„ `HandlerAdapter` ì—ê²Œ ë°˜í™˜í•˜ê²Œ ëœë‹¤.
    - ì—¬ê¸°ì„œ `Controller` ê°€ ë¦¬í„´í•œ ê°’ì„ ë°›ì•„ `ModelAndView` ê°ì²´ë¡œ í†µí•©í•˜ê²Œ ëœë‹¤.
    - ë§Œì•½ ë°˜í™˜ íƒ€ì…ì´ `String` ì´ë©´ `viewName` ìœ¼ë¡œ í•´ì„í•˜ê³ ,
    - ë³„ë„ë¡œ `Model` ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ í•¨ê»˜ ë‹´ëŠ”ë‹¤.
    - ì´ë•Œ 4ë²ˆ ë‹¨ê³„ì—ì„œ `ModelAndView`, `ResponseBody` ë“±ìœ¼ë¡œ ë¦¬í„´í•˜ë©´ ìˆ˜í–‰ ë‹¨ê³„ê°€ ì¡°ê¸ˆ ë‹¬ë¼ì§€ê¸´ í•œë‹¤. ê·¸ ìì²´ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

> `ModelAndView` ë¡œ ì´ë¯¸ `Controller` ì—ì„œ `HandlerAdapter` ì—ê²Œ ë°˜í™˜ë˜ì—ˆë‹¤ë©´ 6ë²ˆ ê³¼ì •ì€ ìƒëµí•˜ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™í•œë‹¤.

7. ê·¸ëŸ¬ê³  `DispatcherServlet` ì´ `HandlerAdapter` ë¡œ ë¶€í„° ë°›ì€ `viewName` ì„ ê°€ì§€ê³ , `ViewResolver` ì—ê²Œ ì–´ë–¤ view ë¥¼ ì“¸ ì§€ë¥¼ ì •í•˜ê²Œ ë˜ê³ ,
    - `DispatcherServlet` ì€ `viewName` ì„ `ViewResolver` ì—ê²Œ ë„˜ê¸´ë‹¤(`ModelAndView` ë¥¼ ë°›ì•˜ë‹¤ë©´ ì´ ê³¼ì •ì€ ì—†ë‹¤).
    - `ViewResolver` ëŠ” ë…¼ë¦¬ ë·° ì´ë¦„(logical view name) ì„ ë¬¼ë¦¬ì  ë¦¬ì†ŒìŠ¤ ê²½ë¡œë¡œ ë³€í™˜í•˜ì—¬ `View` ê°ì²´(`ThymeleafView`, `JstlView` ë“±)ìœ¼ë¡œ ë³€í™˜í•œë‹¤ (`ThymeleafViewResolver`, `InternalResourceViewResolver` ë“±ì´ `ViewResolver` ì˜ ëŒ€í‘œì  êµ¬í˜„ì²´ì´ë‹¤)
    - ìµœì¢…ì ìœ¼ë¡œ `View` ê°€ ìƒì„±ëœë‹¤.

8. ê·¸ ë‹¤ìŒ `DispatcherServlet` ì€ ë°›ì•˜ë˜ `HttpServletResponse` ì™€ í•¨ê»˜ View ë¡œ `forwarding` ì„ í•´ì£¼ê³ ,
    - `DispatcherServlet` ì€ ì„ íƒëœ `View` ê°ì²´ì˜ `render()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³ , ì´ë•Œ `HttpServletRequest`, `HttpServletResponse` ì´ ì „ë‹¬ëœë‹¤.

9. `View` ì—ì„œëŠ” `ViewResolver` ë¥¼ í†µí•´ ì•Œë§ì€ `View` ê°€ ìƒì„±ë˜ê³ , `View` ëŠ” `Model` ì„ ì°¸ì¡°í•˜ì—¬ì„œ ê²°ê³¼ë“¤ì„ ê°€ì ¸ì˜¤ê³  ì™„ì „í•œ ë¬¸ì„œë¥¼ ë§Œë“¤ê²Œ ëœë‹¤
    - `View` ëŠ” `Model` ì˜ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ê³ , ë Œë”ë§ ê²°ê³¼ëŠ” `HttpServletResponse` ì˜ body ë¡œ ì§ì ‘ ì‘ì„±ë˜ê²Œ ëœë‹¤.
    - ë Œë”ë§ì´ ëë‚˜ë©´ `DispatcherServlet` ì´ `response.flushBuffer()` í›„ ìš”ì²­-ì‘ë‹µ ê°ì²´ëŠ” ì†Œë©¸ëœë‹¤.

##### Redirecting ê³¼ì •

ì´ì œ `Redirecting` ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì™„ë²½íˆ ì´í•´ê°€ ê°€ëŠ¥í•˜ë‹¤.

**Controller ì˜ return ê°’ì´ `"redirect:"` ì ‘ë‘ì–´ë¥¼ í¬í•¨í•œ String ì¼ ë•Œ**

1. ì‚¬ìš©ìê°€ `POST` ìš”ì²­ì„ ë³´ë‚¸ë‹¤. WAS(Tomcat ë“±)ê°€ ì´ë¥¼ ë°›ì•„ `HttpServletRequest`, `HttpServletResponse` ê°ì²´ë¥¼ ìƒì„±í•˜ê³  `DispatcherServlet` ì—ê²Œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤.

2. `DispatcherServlet` ì€ ìš”ì²­ì˜ URI ì •ë³´ë¥¼ í™•ì¸í•˜ì—¬ `HandlerMapping` ì—ê²Œ ì–´ë–¤ `Controller` ê°€ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ”ì§€ ì¡°íšŒë¥¼ ë§¡ê¸´ë‹¤.  
   - `HandlerMapping` ì€ ìš”ì²­ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì ì ˆí•œ `@RequestMapping` ë©”ì„œë“œë¥¼ ì°¾ì•„ `HandlerExecutionChain` ìœ¼ë¡œ ê°ì‹¸ ë°˜í™˜í•œë‹¤.  
   - ì´ ê°ì²´ì—ëŠ” **Controller ë©”ì„œë“œ**ì™€ **Interceptor ì²´ì¸**ì´ í¬í•¨ëœë‹¤.

3. `DispatcherServlet` ì€ `HandlerAdapter` ë¥¼ í†µí•´ í•´ë‹¹ `Controller` ë©”ì„œë“œë¥¼ ì‹¤í–‰í•œë‹¤.  
   - ì´ë•Œ `HandlerAdapter` ëŠ” `ArgumentResolver`, `ReturnValueHandler` ë¥¼ í†µí•´ ìš”ì²­ ë°ì´í„°ë¥¼ íŒŒë¼ë¯¸í„°ì— ë°”ì¸ë”©í•˜ê³ , ë°˜í™˜ íƒ€ì…(`String`, `ModelAndView`, `ResponseBody`) ì„ ë¶„ì„í•œë‹¤.

4. `Controller` ê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•œ í›„, `return "redirect:/users/welcome";` ì²˜ëŸ¼ `"redirect:"` ë¡œ ì‹œì‘í•˜ëŠ” ë¬¸ìì—´ì„ ë°˜í™˜í•œë‹¤.  
   - ì´ ì ‘ë‘ì–´ëŠ” Spring MVC ë‚´ë¶€ì—ì„œ **RedirectView** ë¡œ ìë™ ë³€í™˜ë˜ë„ë¡ íŠ¸ë¦¬ê±°í•œë‹¤.

5. â­ï¸ `DispatcherServlet` ì€ ë°˜í™˜ëœ ë·° ì´ë¦„ì„ í™•ì¸í•˜ê³ , `"redirect:"` ì ‘ë‘ì–´ê°€ í¬í•¨ë˜ì–´ ìˆìŒì„ ê°ì§€í•˜ë©´ **`RedirectView`** ë¥¼ ìƒì„±í•œë‹¤.  
   - â­ï¸ ì´ë•ŒëŠ” **ViewResolver** ë¥¼ ê±°ì¹˜ì§€ ì•ŠëŠ”ë‹¤.
   - â­ï¸ ëŒ€ì‹  `RedirectView` ì˜ `render()` ê°€ í˜¸ì¶œë˜ì–´ `HttpServletResponse` ì— `302 Found` ìƒíƒœ ì½”ë“œì™€ `Location` í—¤ë”ë¥¼ ì„¤ì •í•œë‹¤.

6. ì‘ë‹µì´ í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ë¡œ ì „ì†¡ëœë‹¤.  
   - ì‘ë‹µ í—¤ë” ì˜ˆì‹œ:
     ```
     HTTP/1.1 302 Found
     Location: /users/welcome
     ```
   - ë¸Œë¼ìš°ì €ëŠ” ì´ë¥¼ ë³´ê³  `/users/welcome` ìœ¼ë¡œ **ìƒˆë¡œìš´ GET ìš”ì²­**ì„ ìë™ìœ¼ë¡œ ë³´ë‚¸ë‹¤.

7. ìƒˆë¡œìš´ GET ìš”ì²­ì´ ë°œìƒí•˜ë©´ WAS ëŠ” ë‹¤ì‹œ `HttpServletRequest`, `HttpServletResponse` ë¥¼ ìƒˆë¡œ ìƒì„±í•˜ê³ , ë‹¤ì‹œ 1~4ë²ˆì˜ **Forwarding ê³¼ì •**ê³¼ ë™ì¼í•œ `DispatcherServlet` ì²˜ë¦¬ íë¦„ì„ ê±°ì¹œë‹¤.

8. ì´ë•Œ, ì´ì „ ìš”ì²­ì˜ `Model` ë°ì´í„°ëŠ” ìœ ì§€ë˜ì§€ ì•ŠëŠ”ë‹¤.
   - ëŒ€ì‹  `RedirectAttributes.addFlashAttribute()` ë¡œ ì¶”ê°€ëœ ë°ì´í„°ëŠ” **ì¼ì‹œì  ì„¸ì…˜(FlashMap)** ì— ì €ì¥ë˜ì–´ ìƒˆ ìš”ì²­ ì‹œì ì— í•œ ë²ˆë§Œ ì‚¬ìš©ëœë‹¤.
   - ì´í›„ ìš”ì²­ì´ ì™„ë£Œë˜ë©´ `FlashMap` ë°ì´í„°ëŠ” ìë™ ì†Œë©¸ëœë‹¤.

9. ìƒˆë¡œìš´ `Controller` ë©”ì„œë“œ(`/users/welcome`) ê°€ í˜¸ì¶œë˜ê³ , ë·° ë Œë”ë§ì´ ì™„ë£Œë˜ë©´ ìµœì¢… HTML ì‘ë‹µì´ ë¸Œë¼ìš°ì €ì— ì „ë‹¬ëœë‹¤.

> ì¦‰, Redirect ëŠ” **"ìš”ì²­ì´ ë‘ ë²ˆ ì¼ì–´ë‚œë‹¤"**.  
> ì²« ë²ˆì§¸ ìš”ì²­ì€ ì„œë²„ì˜ 302 ì‘ë‹µìœ¼ë¡œ ëë‚˜ê³ ,  
> ë‘ ë²ˆì§¸ ìš”ì²­ì´ ì‹¤ì œ ê²°ê³¼ í˜ì´ì§€ë¥¼ ë Œë”ë§í•œë‹¤.  
> ë”°ë¼ì„œ Forward ì™€ ë‹¬ë¦¬ **URL ì´ ë°”ë€Œë©°, Model ë°ì´í„°ëŠ” ìœ ì§€ë˜ì§€ ì•ŠëŠ”ë‹¤.**

##### Forward vs Redirect ë¹„êµ ìš”ì•½

| êµ¬ë¶„ | Forward | Redirect |
|------|----------|-----------|
| ìš”ì²­ íšŸìˆ˜ | 1íšŒ | 2íšŒ (POST â†’ GET) |
| URL ë³€ê²½ | âŒ ê·¸ëŒ€ë¡œ ìœ ì§€ | âœ… ë³€ê²½ë¨ |
| ë°ì´í„° ì „ë‹¬ | `Model` ë¡œ ì „ë‹¬ | `FlashAttribute` ë¡œ 1íšŒ ì „ë‹¬ |
| ì²˜ë¦¬ ë°©ì‹ | ì„œë²„ ë‚´ë¶€ ì´ë™ | í´ë¼ì´ì–¸íŠ¸ ì¬ìš”ì²­ |
| ì£¼ ìš©ë„ | ë‹¨ìˆœ ë·° ë Œë”ë§ | `PRG(Post-Redirect-Get)` íŒ¨í„´, URL ë…¸ì¶œ ë³€ê²½ ë“± |

> `Forward` ëŠ” "ì„œë²„ ë‚´ë¶€ ì´ë™"  
> `Redirect` ëŠ” "í´ë¼ì´ì–¸íŠ¸ ì¬ìš”ì²­"  
> â€” ì´ í•œ ì¤„ë§Œ ì •í™•íˆ ê¸°ì–µí•˜ë©´, Spring MVC íë¦„ì€ ì™„ì „íˆ ì¡ì€ ê²ƒì´ë‹¤.

