---
layout: post
title:  5. Spring Boot Application Logging Customizing with Log4j2
date:   2025-06-13 15:55:11 +0900
categories: Java Spring
---

<!--more-->

## ğŸª› í•œê³„ì 

ìŠ¤í”„ë§ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ë„ìš°ëŠ” ì„œë²„ ì •ë³´ì— ëŒ€í•´ ê°€ë…ì„±ì´ ë¶€ì¡±í•˜ë©°, ì¶”ì  ê°€ëŠ¥í•œ ë¡œê·¸ ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤.

## ğŸ“‚ ëª©ì°¨
- [Log4j2](#log4j2)
    - [log4j2.properties ì„¤ì •](#log4j2.properties)
        - [ë¡œê¹… ë ˆë²¨ ê³„ì¸µ ì™€ ì´ë¦„ ì„¤ì •](#ë¡œê¹…-ë ˆë²¨-ê³„ì¸µ-ì™€-ì´ë¦„-ì„¤ì •)
        - [Filter ê¸°ëŠ¥ì„ ì‚¬ìš©í•œ ë¡œê·¸ ì´ë²¤íŠ¸ ìƒì„¸ ì œì–´](#filter-ê¸°ëŠ¥ì„-ì‚¬ìš©í•œ-ë¡œê·¸-ì´ë²¤íŠ¸-ìƒì„¸-ì œì–´)
        - [Appenders êµ¬ì„±í•˜ê¸°](#appenders-êµ¬ì„±í•˜ê¸°)
        - [ë£¨íŠ¸ ë¡œê±° ì„¤ì • (ê¸°ë³¸ ë ˆë²¨ ë° Appender ì—°ê²°)](#-ë£¨íŠ¸-ë¡œê·¸-ë ˆë²¨-ë°-appender-ì°¸ì¡°)
    - [Logger ê°ì²´ë¥¼ ê°€ì ¸ì™€ ì¶œë ¥í•´ë³´ê¸°]()

---

## ğŸ“š ë³¸ë¬¸

### Log4j2

ìš°ì„  Log4j2 ëŠ” Asynchronous Logger + LMAX Disruptor ê¸°ë°˜ìœ¼ë¡œ 1800ë§Œ ê±´/s ë¡œê¹…ì´ ê°€ëŠ¥í•˜ë©°,  

- XML/JSON/YAML ì„¤ì • ë“±ì„ ì§€ì›
- Lambda ê¸°ë°˜ ì§€ì—° ë¡œê¹…
- MDC, Marker, ì‚¬ìš©ì ì •ì˜ Message API

ë“±ì˜ ê³ ê¸‰ ê¸°ëŠ¥ë“¤ì„ ì§€ì›í•œë‹¤. ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒ ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì¤€ë‹¤.

{% highlight groovy %}
dependencies {
    ...
    // log4j2
    implementation 'org.springframework.boot:spring-boot-starter-log4j2'
    ...
}
{% endhighlight %}

ê¸°ì¡´ì— ìˆëŠ” starter íŒ©ì— Logbackê³¼ì˜ ì¶©ëŒì„ ë§‰ê¸° ìœ„í•´ ë‹¤ìŒì„ ì¶”ê°€í•œë‹¤.
{% highlight groovy %}
configurations.all {
	exclude group: 'org.springframework.boot', module: 'spring-boot-starter-logging'
}
{% endhighlight %}

#### log4j2.properties

log4j2 ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ resourcesì— `log4j2.properties` ë¥¼ ì°¸ì¡°í•˜ì—¬ ë¡œê¹… êµ¬ì„± ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ Loggingì„ í•  ë•Œì˜ ê¸°ëŠ¥ë“¤ì„ ìˆ˜í–‰í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ **[Appender](#appender), [Logger](#logger)** ê°€ ìˆë‹¤.

ì•„ë˜ì˜ ìš©ì–´ë“¤ì„ ë³´ê³  ì˜¤ê¸¸ ë°”ë€ë‹¤.

##### ë¡œê¹… ë ˆë²¨ ê³„ì¸µ ì™€ ì´ë¦„ ì„¤ì •

ë¡œê·¸ë¥¼ ë„ìš¸ ë•Œë„ íŠ¹ì • ì •ë³´ë“¤ë§Œ ë„ìš¸ ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆë‹¤.

ë¡œê·¸ ë ˆë²¨ ê³„ì¸µì€ ë‹¤ìŒê³¼ ê°™ë‹¤  
ALL â†’ TRACE â†’ DEBUG â†’ INFO â†’ WARN â†’ ERROR â†’ FATAL â†’ OFF  

- ALL: ëª¨ë“  ë¡œê·¸ ë ˆë²¨ í—ˆìš©
- TRACE: ê°€ì¥ ì„¸ë°€í•œ ë‹¨ê³„(ë””í…Œì¼ ë©”ì„œë“œ í˜¸ì¶œ, ë£¨í”„ ë“±)
- DEBUG: ê°œë°œ ë° ë””ë²„ê¹… ì‹œ ìœ ìš©í•œ ì •ë³´-ë³€ìˆ˜ ìƒíƒœ, íë¦„ ë“±
- INFO: ìš´ì˜ ì¤‘ ê¸°ë³¸ì ìœ¼ë¡œ ë‚¨ê¸°ëŠ” ì¼ë°˜ ì •ë³´-ì‹œì‘/ì¢…ë£Œ, ìƒíƒœ ì „í™˜ ë“±
- WARN: ë¬¸ì œëŠ” ì•„ë‹ˆì§€ë§Œ ì£¼ì˜ê°€ í•„ìš”í•œ ìƒí™©-ì„±ëŠ¥ ì €í•˜, ë¹„ì¶”ì²œ API ì‚¬ìš© ë“±
- ERROR: ê¸°ëŠ¥ ì¼ë¶€ ì‹¤íŒ¨ ë“± ì²˜ë¦¬ ì¤‘ì— ì¥ì•  ë°œìƒ
- FATAL: ì¹˜ëª…ì ì¸ ì˜¤ë¥˜ë¡œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ìˆ˜ì¤€
- OFF: ëª¨ë“  ë¡œê·¸ë¥¼ ë¹„í™œì„±í™”

status ì˜ í”„ë¡œí¼í‹°ë¥¼ ì£¼ë©´ í•´ë‹¹ status ë³´ë‹¤ **í•˜ìœ„ì˜ ë¡œê·¸ ë©”ì‹œì§€ë“¤ì„ ì¶œë ¥**í•˜ê²Œ ëœë‹¤.

{% highlight properties %}
## log4j2.properties
# â–¼ ë‚´ë¶€ ë¡œê¹… ë ˆë²¨
status = warn
name = PropertiesConfig
{% endhighlight %}

nameìœ¼ë¡œëŠ” ë¡œê¹… ì„¤ì • ì „ì²´ì˜ ì´ë¦„ì„ ì§€ì •í•˜ëŠ” ì‹ë³„ìì´ë‹¤.

##### Filter ê¸°ëŠ¥ì„ ì‚¬ìš©í•œ ë¡œê·¸ ì´ë²¤íŠ¸ ìƒì„¸ ì œì–´

Log4j2ëŠ” í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì–´ë–»ê²Œ ì²˜ë¦¬í•´ì•¼ í• ì§€ ì œì–´í•  ìˆ˜ ìˆë‹¤.

ìš°ì„  ì´ë²¤íŠ¸ë¥¼ í‰ê°€í•˜ëŠ” ê²ƒë¶€í„° ë³´ìë©´ ê¸°ë³¸ì ì¸ í•„í„° ë¡œì§ì€ ë¡œê·¸ ì´ë²¤íŠ¸ë¥¼ í‰ê°€í•˜ê³ , ACCEPT, DENY, NEUTRAL ì¤‘ í•˜ë‚˜ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ê²Œ ëœë‹¤.

- ACCEPT: í•´ë‹¹ ë¡œê·¸ë¥¼ ì¦‰ì‹œ ìˆ˜ìš©í•˜ê³  ë‹¤ìŒ í•„í„°ëŠ” ê²€ì‚¬í•˜ì§€ ì•ŠìŒ(ë°”ë¡œ ì¶œë ¥)
- DENY: í•´ë‹¹ ë¡œê·¸ë¥¼ ì¦‰ì‹œ ë²„ë¦¬ê³  ì´í›„ ë‹¨ê³„ë¡œ ì „ë‹¬í•˜ì§€ ì•ŠìŒ(ë²„ë¦¼)
- NEUTRAL: íŒë‹¨ì„ ë³´ë¥˜í•˜ê³  ë‹¤ìŒ í•„í„°ë¡œ ë„˜ê¹€(ë‹¤ìŒ í•„í„°í•œí…Œ ì¸ê³„)

ìœ„ 3ê°€ì§€ë¥¼ ê²°ì •ë‚´ë¦¬ëŠ” ë‹¨ê³„ëŠ” í¬ê²Œ 4ë‹¨ê³„ë¡œ ë‚˜ë‰˜ê³ , ê° í•„í„° ë‹¨ê³„ì—ì„œ ìœ„ì˜ ê²°ê³¼ ì¤‘ í•˜ë‚˜ë¥¼ ê°€ì§€ê²Œ ëœë‹¤.

1. Context-wide: ì „ì²´ ì„¤ì •ì— ëŒ€í•œ ì´ˆê¸° í•„í„°
2. Logger-level: íŠ¹ì • ë¡œê±°ì— ì„¤ì •ëœ í•„í„°
3. AppenderReference: ì–´ë–¤ Appenderì— ë³´ë‚¼ì§€ ê²°ì •
4. Appender-level: ì‹¤ì œ Appender ë‚´ë¶€ í•„í„°

ì•„ë˜ ì½”ë“œëŠ” threshold ë¼ëŠ” í•„í„°ë¥¼ í†µí•´ ì „ì—­ í•„í„°ë¥¼ ì„¤ì •í•˜ê³  ìˆë‹¤.

{% highlight properties %}
# â–¼ ì „ì—­ í•„í„° ì„¤ì •: ë””ë²„ê·¸ ì´ìƒ ë¡œê·¸ë§Œ ì¶œë ¥
filters = threshold     # ì „ì—­í•„í„° ì´ë¦„ì€ threshold

# filters ë’¤ì— ë‚˜ì—´ëœ í•„í„° ì´ë¦„ì€ ì´í›„ ì„¤ì •ì—ì„œ
# filter.<name>.type, filter.<name>.level ê°™ì´ ì°¸ì¡° ê°€ëŠ¥

# ì „ì—­ í•„í„° threshold ì˜ íƒ€ì…ìœ¼ë¡œ ThresholdFilter ë¼ëŠ” ë ˆë²¨ ê¸°ë°˜ í•„í„°ë¥¼ ì‚¬ìš©í•œë‹¤.
filter.threshold.type = ThresholdFilter
# ë©”ì‹œì§€ì˜ ë ˆë²¨ì´ ì„¤ì •í•œ ê¸°ì¤€ ì´ìƒì¸ì§€ ë¹„êµí•˜ì—¬ ì²˜ë¦¬í•œë‹¤.

# í•´ë‹¹ ThresholdFilter ê°€ ì ìš©í•  ê¸°ì¤€ ë ˆë²¨ì„ ì •ì˜í•œë‹¤.
filter.threshold.level = debug
# ê¸°ë³¸ì ìœ¼ë¡œ onMatch=NEUTRAL, onMismatch=DENY ì´ë¯€ë¡œ
# DEBUG ì´ìƒì´ë©´ NEUTRALë¡œ ë„˜ì–´ê°€ ë‹¤ìŒ ë ˆë²¨ ê²€ì‚¬ í›„ ì¶œë ¥ ê°€ëŠ¥
# TRACE ì´í•˜ëŠ” DENYë¡œ ë°”ë¡œ ì°¨ë‹¨ë¨
{% endhighlight %}


ëŒ€í‘œì ì¸ í•„í„° ì¢…ë¥˜ë¡œëŠ”
- ThresholdFilter: íŠ¹ì • ê¸°ì¤€ ì´ìƒì¸ì§€ ì•„ë‹Œì§€ í•„í„°ë§
- BurstFilter
- CompositeFilter
- DynamicThresholdFilter
- RegexFilter: ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•œ í•„í„°ë§
- MapFilter, MarkerFilter, TimeFilter ë“±ë“±
ë“±ì´ ìˆë‹¤.

##### Appenders êµ¬ì„±í•˜ê¸°

{% highlight properties %}
# â–¼ ì½˜ì†” Appender êµ¬ì„±

# ì‚¬ìš©í•  Appender ë‚˜ì—´
appenders = console, rolling

# Appender ì˜ íƒ€ì… ì§€ì •, ì—¬ê¸°ì„œëŠ” Consoleë¡œ, System.out, System.err ê°™ì€ ì¶œë ¥ í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ëƒ„
appender.console.type = Console

# Appender ì— ì‹ë³„ìë¥¼ ë¶™ì„
appender.console.name = STDOUT

# Appender ì— ë¡œê·¸ ë©”ì‹œì§€ë¥¼ ì–´ë–¤ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í• ì§€ ì •í•¨
appender.console.layout.type = PatternLayout

# Appender ì˜ ë¡œê·¸ ì¶œë ¥ í¬ë§·ì„ ì§€ì •í•¨
appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5p %c{1}:%L - %m%n
{% endhighlight %}

**ë¡œê·¸ ì¶œë ¥ í¬ë§·**
- %d{...}: ë‚ ì§œ/ì‹œê°„ì˜ í¬ë§· ì§€ì •
- %t: ìŠ¤ë ˆë“œ ì´ë¦„(main ë“±)
- %-5p: ê³ ì • í­ 5ìë¦¬ì˜ ë¡œê·¸ ë ˆë²¨(INFO, DEBUG ë“±)
- %c{1}: ë¡œê±° ì´ë¦„ì˜ ë§ˆì§€ë§‰ ì»´í¬ë„ŒíŠ¸, ì¼ë°˜ì ìœ¼ë¡œ í´ë˜ìŠ¤ ëª…
- %L: ë¡œê·¸ ë°œìƒ ì½”ë“œ ë¼ì¸ ë²ˆí˜¸
- %m: ì‹¤ì œ ë©”ì‹œì§€
- %n: ì¤„ë°”ê¿ˆ

{% highlight properties %}
# â–¼ ë¡¤ë§ íŒŒì¼ Appender êµ¬ì„±

# ë¡œê·¸ íŒŒì¼ ë‚´ìš©ì„ ì–´ë”” ì €ì¥í• ì§€ ì§€ì •
appender.rolling.fileName = logs/app.log

# íŒŒì¼ëª…ì„ ì–´ë–»ê²Œ ì“¸ê±´ì§€ ì„¤ì •
appender.rolling.filePattern = logs/app-%d{yyyy-MM-dd}-%i.log.gz

# Policies ë¼ëŠ” ë¡¤ì˜¤ë²„ ì¡°ê±´ ê·¸ë£¹(wrapper)ë¥¼ ì§€ì •
appender.rolling.policies.type = Policies

# ì‹œê°„ ê¸°ë°˜ íŠ¸ë¦¬ê±° ì •ì±… ì‚¬ìš©, íŠ¹ì • ì£¼ê¸°ë§ˆë‹¤ ë¡œê·¸ íŒŒì¼ì´ ìë™ìœ¼ë¡œ Rollover
appender.rolling.policies.time.type = TimeBasedTriggeringPolicy

# Rollover ê°„ê²©ì„ 1ë‹¨ìœ„ë¡œ ì§€ì •
appender.rolling.policies.time.interval = 1

# íŒŒì¼ í¬ê¸° ê¸°ë°˜ íŠ¸ë¦¬ê±° ì •ì±… ì§€ì •
appender.rolling.policies.size.type = SizeBasedTriggeringPolicy

# íŒŒì¼ì´ 10MBë¥¼ ì´ˆê³¼ ì‹œ Rollover ì‹¤í–‰
appender.rolling.policies.size.size = 10 MB

# Rollover ì „ í›„ì˜ ì²˜ë¦¬ ì „ëµì„ ì§€ì •
appender.rolling.strategy.type = DefaultRolloverStrategy

# Rollover íŒŒì¼ì˜ ìµœëŒ€ ê°œìˆ˜ë¥¼ 7ê°œë¡œ ì„¤ì •
appender.rolling.strategy.max = 7
{% endhighlight %}


##### ë£¨íŠ¸ ë¡œê±° ì„¤ì • (ê¸°ë³¸ ë ˆë²¨ ë° Appender ì—°ê²°)

{% highlight properties %}
# â–¼ ë£¨íŠ¸ ë¡œê·¸ ë ˆë²¨ ë° Appender ì°¸ì¡°

# ë¡œê·¸ ë ˆë²¨ ì„¤ì •
rootLogger.level = info

# ê¸°ë³¸ ë¡œê·¸ ë ˆë²¨ê³¼ appender ë§¤í•‘ ì„¤ì •
rootLogger.appenderRefs = stdout, rolling
rootLogger.appenderRef.stdout.ref = STDOUT
rootLogger.appenderRef.rolling.ref = ROLLING
{% endhighlight %}

#### Logger ê°ì²´ë¥¼ ê°€ì ¸ì™€ ì¶œë ¥í•´ë³´ê¸°

Logging ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•  í´ë˜ìŠ¤ ì»¨í…ìŠ¤íŠ¸ì— ë‹¤ìŒì„ ì…ë ¥í•œë‹¤:
{% highlight java %}
import org.slf4j.*;
...
    private static final Logger logger =
            LoggerFactory.getLogger(StudyApplication.class);
{% endhighlight %}

ì¶œë ¥í•  ë©”ì‹œì§€ê°€ ì‚´ì•„ìˆëŠ” function ì˜ context ì—ì„œ ë‹¤ìŒì„ ì…ë ¥í•œë‹¤.
{% highlight java %}
ConfigurableApplicationContext applicationContext =
        springApplication.run(args);
logger.info("The application is completely running");
{% endhighlight %}


ë‹¤ìŒì´ ì¶œë ¥ë¨ì„ ë³¼ ìˆ˜ ìˆë‹¤.
{% highlight text %}
[restartedMain] INFO  StudyApplication:73 - The application is completely running
{% endhighlight %}

---

## âœ’ï¸ ìš©ì–´

###### Logger

í•œ ê°œ ì´ìƒì˜ Appender ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ ë©”ì‹œì§€ í‘œì‹œë¥¼ ë‹´ë‹¹í•˜ëŠ” ë¡œê¹… í”„ë ˆì„ì›Œí¬ì˜ ì»´í¬ë„ŒíŠ¸

###### Appender

ì–´íœë”ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ê°€ ì¶œë ¥ë˜ëŠ” ëŒ€ìƒê³¼ ë¡œê¹… í¬ë§·ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ë¡œê·¸ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ëŠ” ë§¤ì²´ì— ë”°ë¼ ë‹¤ì–‘í•œ ì–´íœë”ê°€ ìˆê³ , ì½˜ì†” ì–´íœë”ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì½˜ì†”ì— ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê³ , íŒŒì¼ ì–´íœë”ëŠ” ë¡œê·¸ ë©”ì‹œì§€ë¥¼ íŒŒì¼ì— ì¶œë ¥í•œë‹¤. 

- RollingFileAppender: ì‹œê°„ê³¼ ë‚ ì§œ ê¸°ë°˜ìœ¼ë¡œ ë³„ë„ì˜ íŒŒì¼ì— ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê²Œ ëœë‹¤.
- SMTP Appender: ì •í•´ì§„ ì´ë©”ì¼ ì£¼ì†Œë¡œ ë¡œê·¸ë¥¼ ì¶œë ¥í•œë‹¤.