---
layout: post
title:  6. Spring Boot Validation
date:   2025-06-23 17:38:00 +0900
categories: ComputerScience Java Spring
---

<!--more-->



## ğŸ“‚ ëª©ì°¨
- [Business Entity](#business-entity)
- [Bean Validation ì˜ì¡´ì„± ì¶”ê°€](#bean-validation-ì˜ì¡´ì„±-ì¶”ê°€)
- [Bean Validation ì„ í†µí•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë£° ê²€ì¦](#bean-validation-ì„-í†µí•œ-ë¹„ì¦ˆë‹ˆìŠ¤-ë£°-ê²€ì¦)
	- [Validatorë¥¼ í†µí•´ ìœ„ë°˜ ì‚¬í•­ ì¶œë ¥](#validatorë¥¼-í†µí•´-ìœ„ë°˜-ì‚¬í•­-ì¶œë ¥)
- [Hibernate Validator Annotations](#hibernate-validator-annotations)
- [Custom Bean Validation Annotation](#custom-bean-validation-annotation)
	- [ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ì• ë„ˆí…Œì´ì…˜ ë§Œë“¤ê¸°](#ë¹„ë°€ë²ˆí˜¸-ê²€ì¦-ì• ë„ˆí…Œì´ì…˜-ë§Œë“¤ê¸°)

---

## ğŸ“š ë³¸ë¬¸
 
ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹° ìœ íš¨ì„± ê²€ì¦ì„ ìœ„í•œ ë°¸ë¦¬ë°ì´ì…˜ì„ ì‚¬ìš©ì„ ìƒê°í•  ìˆ˜ ìˆë‹¤.

### Business Entity

ì—…ë¬´ì—ì„œ ì¤‘ìš”í•˜ê²Œ ë‹¤ë£¨ëŠ” ëŒ€ìƒ(ì‹¤ì²´)ë¥¼ ì˜ë¯¸í•˜ë©°, ì£¼ë¡œ ì •ë³´ ì‹œìŠ¤í…œì´ë‚˜ ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„ì—ì„œ ì‚¬ìš©ëœë‹¤. í˜„ì‹¤ì„¸ê³„ì˜ ê°œë…ì„ ì¶”ìƒí™” í•œ ë°ì´í„°ì´ë‹¤.

íŠ¹ì§•
- í˜„ì‹¤ ì„¸ê³„ì˜ ëª…ì‚¬ì  ê°œë…ì„ ì¶”ìƒí™”
- ëŒ€ë¶€ë¶„ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ë‹¨ìœ„ë¡œ êµ¬í˜„ë¨
- ì‹œìŠ¤í…œ ì „ë°˜ì—ì„œ í•µì‹¬ ë¡œì§ì˜ ì£¼ì²´ë¡œ ë™ì‘í•¨

ê´€ë ¨ ê°œë…ìœ¼ë¡œëŠ” ë„ë©”ì¸ ê°ì²´, DTO ë“±ì´ ìˆìœ¼ë‚˜ ê²€ìƒ‰í•´ë³´ê¸¸ ë°”ë€ë‹¤.

### Bean Validation ì˜ì¡´ì„± ì¶”ê°€
validation ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì£¼ì.

{% highlight java %}
// Bean Validation
implementation 'org.springframework.boot:spring-boot-starter-validation'
{% endhighlight %}

### Bean Validation ì„ í†µí•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë£° ê²€ì¦

ì“°ê¸° ìœ„í•´ ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹°ë¥¼ ì„ ì–¸í•˜ì.

{% highlight java %}
import jakarta.validation.constraints.*;

public class Account implements IAccount {
    private int number;
    private String name;

    @Min(value=0, message = "Account should have a minimum of 0 money")
    private int money;

    public Account(int number) {}

    public void setMoney(int money) {
        this.money = money;
    }
}
{% endhighlight %}

ìœ„ì™€ ê°™ì´ `@Min`ì„ í†µí•´ ìµœì†Œë¡œ ê°€ì§ˆ ê°’ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

#### Validatorë¥¼ í†µí•´ ìœ„ë°˜ ì‚¬í•­ ì¶œë ¥

ëŒ€ì¶© ì´ë¥¼ ì“°ê¸° ìœ„í•´ application í´ë˜ìŠ¤ì—ì„œ `CommandLineRunner` ë¥¼ êµ¬í˜„í•´ì„œ ì¨ë³´ì.
{% highlight java %}
@SpringBootApplication
@EnableConfigurationProperties(CustomProperties.class)
public class StudyApplication
		implements CommandLineRunner
{
    ...
    	@Override
	public void run(String... args) throws Exception {
		Account account = new Account(123);
		account.setMoney(-1);

		Validator validator = Validation.buildDefaultValidatorFactory().getValidator();

		Set<ConstraintViolation<Account>> violations = validator.validate(account);

		violations.forEach(accountConstraintViolation -> {
			logger.error("A constraint violation has occurred. Violation details: [{}].", accountConstraintViolation);
		}); 
		// [{}] ì—¬ê¸°ì— accountConstraintViolation ë‚´ìš©ì´ ë“¤ì–´ê°
	}
}
{% endhighlight %}

account ë¡œëŠ” ìµœì†Œê°’ì´ 0ì´ê¸° ë•Œë¬¸ì— 0ì„ ì¤€ë‹¤ë©´ ì—ëŸ¬ê°€ ë°œìƒí•  ê²ƒì´ë‹¤. `Validator` ì—ì„œ í•´ë‹¹ ë„ë©”ì¸ ê°ì²´ê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ë£°ì„ ë§Œì¡±í–ˆëŠ”ì§€ ê²€ì¦ì„ í•˜ê³ , ê²€ì¦ ë¡œê·¸ë¥¼ `ConstraintViolation` ì—´ê±°í˜•ìœ¼ë¡œ ë°˜í™˜í•œë‹¤.

> buildDefaultValidatorFactory ëŠ” ë‹¨ìˆœ í…ŒìŠ¤íŠ¸ ëª©ì ì—ì„œ ì‚¬ìš©ëœë‹¤.
> Spring Contextì—ì„œëŠ” @Autowired ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì ¸ì˜¤ê¸¸ ë°”ë€ë‹¤.

{% highlight text %}
2025-06-18 21:04:38.793 [restartedMain] ERROR StudyApplication:127 - A constraint violation has occurred. Violation details: [ConstraintViolationImpl{interpolatedMessage='Account should have a minimum of 0 money', propertyPath=money, rootBeanClass=class com.example.study.entity.account.Account, messageTemplate='Account should have a minimum of 0 money'}].
{% endhighlight %}

ìœ„ì™€ ê°™ì´ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

### Hibernate Validator Annotations

| ë²”ì£¼       | ì• ë„ˆí…Œì´ì…˜            | ì„¤ëª… |
|------------|------------------------|------|
| **Null ì—¬ë¶€** | `@NotNull`             | nullì´ ì•„ë‹ˆì–´ì•¼ í•¨ |
|            | `@NotEmpty`           | null, ë¹ˆ ë¬¸ìì—´ ëª¨ë‘ í—ˆìš© ì•ˆ í•¨ (ê³µë°±ì€ í—ˆìš©ë¨) |
|            | `@NotBlank`           | null, ë¹ˆ ë¬¸ìì—´, ê³µë°±ë¬¸ì ë¶ˆê°€ |
| **ë¬¸ìì—´ ê´€ë ¨** | `@Size(min, max)`       | ê¸¸ì´ ì œí•œ (ë¬¸ìì—´, ë°°ì—´, ë¦¬ìŠ¤íŠ¸ ë“±) |
|            | `@Pattern(regexp)`    | ì •ê·œí‘œí˜„ì‹ íŒ¨í„´ ê²€ì‚¬ |
|            | `@Email`              | ì´ë©”ì¼ í˜•ì‹ ê²€ì‚¬ |
|            | `@Length(min, max)`   | ë¬¸ìì—´ ê¸¸ì´ ì œí•œ (`hibernate-validator` ê³ ìœ ) |
| **ìˆ«ì ê´€ë ¨** | `@Min(value)`          | ìµœì†Œê°’ (ì •ìˆ˜í˜•) |
|            | `@Max(value)`          | ìµœëŒ€ê°’ (ì •ìˆ˜í˜•) |
|            | `@DecimalMin(value)`  | ìµœì†Œê°’ (ì‹¤ìˆ˜ í¬í•¨) |
|            | `@DecimalMax(value)`  | ìµœëŒ€ê°’ (ì‹¤ìˆ˜ í¬í•¨) |
|            | `@Positive`           | ì–‘ìˆ˜ë§Œ í—ˆìš© |
|            | `@PositiveOrZero`     | ì–‘ìˆ˜ ë˜ëŠ” 0 í—ˆìš© |
|            | `@Negative`           | ìŒìˆ˜ë§Œ í—ˆìš© |
|            | `@NegativeOrZero`     | ìŒìˆ˜ ë˜ëŠ” 0 í—ˆìš© |
|            | `@Digits(i, f)`       | ì •ìˆ˜ iìë¦¬, ì†Œìˆ˜ fìë¦¬ |
| **ë‚ ì§œ ê´€ë ¨** | `@Past`                | ê³¼ê±° ë‚ ì§œë§Œ í—ˆìš© |
|            | `@PastOrPresent`      | ê³¼ê±° ë˜ëŠ” ì˜¤ëŠ˜ |
|            | `@Future`             | ë¯¸ë˜ ë‚ ì§œë§Œ í—ˆìš© |
|            | `@FutureOrPresent`    | ë¯¸ë˜ ë˜ëŠ” ì˜¤ëŠ˜ |
| **ê³„ì¸µ ê°ì²´** | `@Valid`               | ì¤‘ì²© ê°ì²´ì˜ ìœ íš¨ì„± ê²€ì‚¬ ìˆ˜í–‰ |

### Custom Bean Validation Annotation

ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹° ìœ íš¨ì„± ê²€ì¦ì„ ìœ„ ì• ë„ˆí…Œì´ì…˜ ì™¸ì— ì…ë§›ëŒ€ë¡œ ê²€ì¦ì„ ìˆ˜í–‰í•˜ë„ë¡ í•˜ëŠ” ì»¤ìŠ¤í…€ ë¹ˆ ë°¸ë¦¬ë°ì´ì…˜ ì• ë„ˆí…Œì´ì…˜ì„ ì •ì˜ í•  ìˆ˜ë„ ìˆë‹¤.

#### ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ì• ë„ˆí…Œì´ì…˜ ë§Œë“¤ê¸°

[ì»¤ìŠ¤í…€ ì• ë„ˆí…Œì´ì…˜][custom-annotation]ì„ ë§Œë“¤ê¸° ìœ„í•´ `ConstraintValidator` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ ëœë‹¤. ì œë„¤ë¦­ ë³€ìˆ˜ë¡œ ì²«ë²ˆì§¸ëŠ” ì»¤ìŠ¤í…€ ë°¸ë¦¬ë°ì´í„° ë¡œì§ì„ ì ìš©í•˜ê²Œ í•´ì£¼ëŠ” ì• ë„ˆí…Œì´ì…˜(ì• ë„ˆí…Œì´ì…˜ì„ ë”°ë¡œ ì •ì˜í•´ì•¼ í•¨)ì„ ë„£ì–´ì£¼ê³ , ë‘ ë²ˆì§¸ë¡œëŠ” ì»¤ìŠ¤í…€ ì• ë„ˆí…Œì´ì…˜ì„ ì ìš©í•´ì•¼ í•˜ëŠ” ë°ì´í„° íƒ€ì…ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤(ë°¸ë¦¬ë°ì´ì…˜ì„ ìˆ˜í–‰í•˜ëŠ” ëŒ€ìƒì˜ íƒ€ì…ì„ ì ì–´ì£¼ë¼ëŠ” ë§).

{% highlight java %}
import jakarta.validation.*;

import java.lang.annotation.*;

public class PasswordRuleValidator implements ConstraintValidator<> {

    @Override
    public void initialize(Annotation constraintAnnotation) {
        ConstraintValidator.super.initialize(constraintAnnotation);
    }

    @Override
    public boolean isValid(Object value, ConstraintValidatorContext context) {
        return false;
    }
}
{% endhighlight %}

êµ¬í˜„ì‹œ isValid ì™€ initializeê°€ ìƒì„±ëœë‹¤. initializeëŠ” `ConstraintValidator`ê°€ íŠ¹ì • ì• ë„ˆí…Œì´ì…˜ì— ëŒ€í•´ ì´ˆê¸° ì„¤ì •ì„ ìˆ˜í–‰í•˜ëŠ” ë¡œì§ì¸ë°, ì´ëŠ” ì²«ë²ˆì§¸ Genericì„ ì¸ìë¡œ ë°›ì•„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

ë§Œì•½ `ConstraintValidator<Id, String>` ìœ¼ë¡œ êµ¬í˜„ì„ í–ˆë‹¤ë©´, Id ì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ë³€ìˆ˜ë¡œ ë©¤ë²„ë³€ìˆ˜ë“¤ì„ ì„ ì–¸í•˜ì—¬ í†µí•´ ë‚˜ì¤‘ì— isValid ì—ì„œ ì´ ë³€ìˆ˜ë“¤ì„ í™œìš©í•´ ë‹¤ì–‘í•œ ê²€ì¦ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” ë¶ˆí•„ìš”í•˜ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ ì‚­ì œí•œë‹¤.

ì œë„¤ë¦­ ì¸ìì— ë„£ì„ ì• ë„ˆí…Œì´ì…˜ì„ êµ¬í˜„í•´ì£¼ì.

{% highlight java %}
import jakarta.validation.*;

import java.lang.annotation.*;

@Target({ElementType.TYPE, ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
public @interface Password {
    // ê¸°ë³¸ ë©”ì‹œì§€ ì •ì˜
    String message() default "Password do not adhere to the specified rule";
    Class<?>[] groups() default {};
    /*
     ê²€ì¦ ëŒ€ìƒ ê°ì²´ì— ëŒ€í•œ ë¶€ê°€ì ì¸ ë©”íƒ€ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” Payloadë¥¼ ì‚¬ìš©
     ì–´ë–¤ ê²€ì¦ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í–ˆëŠ”ì§€ë¥¼ payload ê°ì²´ë¡œ ë°›ê²Œ ë¨
     */
    Class<? extends Payload>[] payload() default {};
}
{% endhighlight %}

messageëŠ” ìœ„ë°˜ ì‚¬í•­ì— ëŒ€í•œ ì¶œë ¥, groupsëŠ” ê·¸ë£¹ë³„ ê²€ì¦ ì‹œ ìœ ìš©í•˜ë©°, ì‹¤ë¬´ì—ì„œëŠ” ê³„ì¸µì  ìœ íš¨ì„± ê²€ì¦ì„ í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íšŒì›ê°€ì…ì—ì„œëŠ” name, email, password ê°€ ëª¨ë‘ í•„ìˆ˜ì§€ë§Œ, ë¡œê·¸ì¸ ì‹œì—ëŠ” email, passwordë§Œ í•„ìš”í•˜ê²Œ ëœë‹¤. ì´ë•Œ ëª¨ë“  í•„ë“œë¥¼ í•œêº¼ë²ˆì— ê²€ì¦í•˜ë©´ ë¶ˆí•„ìš”í•œ ì œì•½ì´ ìƒê¸°ê²Œ ë˜ëŠ”ë°, ì´ëŸ´ ë•Œ groupsë¡œ ìœ íš¨ì„± ê²€ì¦ì„ ë¶„ë¦¬ì‹œì¼œ ìƒí™©ì— ë§ê²Œ í•„ìš”í•œ ê²ƒë§Œ ê²€ì¦ì„ í•  ìˆ˜ ìˆë‹¤.
{% highlight java %}
// interfaces def.class
public interface OnRegister {}
public interface OnLogin {}

// User.class
public class User {

    @NotBlank(groups = OnRegister.class)
    private String name;

    @NotBlank(groups = {OnRegister.class, OnLogin.class})
    private String email;

    @NotBlank(groups = {OnRegister.class, OnLogin.class})
    private String password;
}

// validate
Validator validator = Validation.buildDefaultValidatorFactory().getValidator();

User user = new User();
Set<ConstraintViolation<User>> violations =
    validator.validate(user, OnLogin.class);  // ë¡œê·¸ì¸ì— í•„ìš”í•œ ê²ƒë§Œ ê²€ì¦
{% endhighlight %}


ì´ì œ ë‹¤ì‹œ `PasswordValidator` ë¡œ ê°€ì„œ `isValid()` ë¥¼ êµ¬í˜„í•´ì£¼ì.

ì—¬ê¸°ì„œ Password ì— ëŒ€í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ê²€ì¦ì€ êµ‰ì¥íˆ ë§ì´ ì“°ì´ê¸° ë•Œë¬¸ì— ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë”°ë¡œ êµ¬í˜„ì´ ë˜ì–´ ìˆë‹¤. passay ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ì—¬ ì´ë¥¼ ì“°ë„ë¡ í•˜ì.

{% highlight groovy %}
implementation 'org.passay:passay:1.6.3'
{% endhighlight %}


**Bean Validation êµ¬í˜„**

{% highlight java %}
import jakarta.validation.*;
import org.passay.*;

import java.util.*;

public class PasswordRuleValidator implements ConstraintValidator<Password, String> {
    private static final int MIN_COMPLEX_RULE = 2;
    private static final int MAX_REPETITIVE_CHARS = 3;
    private static final int MIN_SPECIAL_CASE_CHARS = 1;
    private static final int MIN_UPPER_CASE_CHARS = 1;
    private static final int MIN_LOWER_CASE_CHARS = 1;
    private static final int MIN_DIGIT_CASE_CHARS = 1;

    @Override
    public boolean isValid(String password, ConstraintValidatorContext context) {
        List<Rule> passwordRules = List.of(
                new LengthRule(8, 30),
                new CharacterCharacteristicsRule(
                        MIN_COMPLEX_RULE,
                        new CharacterRule(EnglishCharacterData.Special, MIN_SPECIAL_CASE_CHARS),
                        new CharacterRule(EnglishCharacterData.UpperCase, MIN_UPPER_CASE_CHARS),
                        new CharacterRule(EnglishCharacterData.LowerCase, MIN_LOWER_CASE_CHARS),
                        new CharacterRule(EnglishCharacterData.Digit, MIN_DIGIT_CASE_CHARS)
                ),
                new RepeatCharacterRegexRule(MAX_REPETITIVE_CHARS));

        PasswordValidator passwordValidator = new PasswordValidator(passwordRules);
        PasswordData passwordData = new PasswordData(password);
        RuleResult ruleResult = passwordValidator.validate(passwordData);
        return ruleResult.isValid();
    }
}
{% endhighlight %}

ì´ì œ ì´ë¥¼ ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹°ì— ì ìš©ì‹œì¼œì£¼ë©´ ë˜ì§€ë§Œ, í•˜ê¸° ì „ì— ì–´ë…¸í…Œì´ì…˜ê³¼ Validator ë¥¼ ì—°ê²°ì‹œì¼œì¤„ ë¬´ì–¸ê°€ê°€ í•„ìš”í•˜ë‹¤. ì§€ê¸ˆì€ ì„¤ê³„ë§Œ ëë‚œ ê²ƒì´ì§€ ì–´ë…¸í…Œì´ì…˜ì´ ì–´ë–¤ Validate ë¥¼ í• ì§€ ëª…ì‹œë¥¼ ì•ˆí•´ì£¼ì—ˆê¸°ì— ê·¸ëƒ¥ ë©”íƒ€ë°ì´í„°ë§Œ ë„£ê²Œ ëœ ê²ƒ ë¿ì´ë‹¤. ë”°ë¼ì„œ ì–´ë…¸í…Œì´ì…˜ì— ê°€ì„œ **@Constraint**ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” target ì—ê²Œ ì–´ë–¤ validator ë¥¼ ì“¸ ê²ƒì¸ì§€ ëª…ì‹œë¥¼ í•´ì¤€ë‹¤.

{% highlight java %}
@Target({ElementType.TYPE, ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = PasswordRuleValidator.class)
public @interface Password {
	...
{% endhighlight %}

ì´ì œ ì—”í‹°í‹°ì— ì ìš©ì‹œì¼œì£¼ì.

{% highlight java %}
import com.example.study.validator.*;
import lombok.*;

@Getter
@ToString
@NoArgsConstructor
@AllArgsConstructor
public class User {
    private String name;
    @Password // ì»¤ìŠ¤í…€ ì• ë„ˆí…Œì´ì…˜ ì‚¬ìš©
    private String password;
}
{% endhighlight %}

ì´ì œ ë™ì¼í•˜ê²Œ validator ë¥¼ í†µí•´ ConstraintViolation ë“¤ì„ ê°€ì ¸ì™€ì„œ ê²€ì¦ì„ ìˆ˜í–‰í•˜ë©´ ëœë‹¤.

---

## ğŸ”— ê´€ë ¨ ì¶œì²˜
- [Custom Annotation][custom-annotation]

[custom-annotation]: {{ site.baseurl }}/java/2025/06/23/custom-annotation.html