<!DOCTYPE html>
<html lang="kor">

    <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="icon" href="/seonghun120614/assets/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/seonghun120614/assets/css/style.css">
<title>8. Spring Boot Auto Configuration</title>
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Spring Boot Auto Configuration | Seonghun’s Blog</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Spring Boot Auto Configuration" />
<meta name="author" content="Seonghun Park" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="https://seonghun120614.github.io/seonghun120614/computerscience/java/spring/2025/08/08/8.-spring-boot-auto-configuration.html" />
<meta property="og:url" content="https://seonghun120614.github.io/seonghun120614/computerscience/java/spring/2025/08/08/8.-spring-boot-auto-configuration.html" />
<meta property="og:site_name" content="Seonghun’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-08T06:45:34+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Spring Boot Auto Configuration" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Seonghun Park"},"dateModified":"2025-08-08T06:45:34+00:00","datePublished":"2025-08-08T06:45:34+00:00","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"Spring Boot Auto Configuration","mainEntityOfPage":{"@type":"WebPage","@id":"https://seonghun120614.github.io/seonghun120614/computerscience/java/spring/2025/08/08/8.-spring-boot-auto-configuration.html"},"url":"https://seonghun120614.github.io/seonghun120614/computerscience/java/spring/2025/08/08/8.-spring-boot-auto-configuration.html"}</script>
<!-- End Jekyll SEO tag -->


<script type="text/javascript" src="/seonghun120614/assets/js/darkmode.js"></script>

<!-- Mermaid -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RQTWJRLWGD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-RQTWJRLWGD');
</script></head><script>
        document.addEventListener("DOMContentLoaded", function () {
            const toggle = document.getElementById("dark-toggle");
        
            // 이미 실행한 적 있는지 확인
            const hasToggled = localStorage.getItem("darkModeInitialized");
        
            if (!hasToggled && toggle && toggle.checked) {
                toggleDarkMode();
                localStorage.setItem("darkModeInitialized", "true"); // 최초 실행 기록
            }
        });
    </script>

    <body>
        <div id="scroll-progress"></div>
        <main class="container">
            <section class="about">
                <div class="about-header condensed">
                    <div class="about-title">
                        <a href="/seonghun120614/">
                            
                            <img class="light"
                                src="/seonghun120614/assets/portfolio.png"
                                alt="Seonghun Park" />
                            <img class="dark"
                                src="/seonghun120614/assets/portfolio.png"
                                alt="Seonghun Park" />
                            
                        </a>
                        <h2 id="title">
                            <a href="/seonghun120614/">Seonghun Park</a>
                        </h2>
                    </div><p class="tagline">Developer.</p></div>
                
                <ul class="social about-footer condensed"><li>
                        <a
                            href="https://github.com/seonghun120614"
                            target="_blank"
                            rel="noopener"
                            aria-label="github">
                            <i class="icon-github-circled"></i>
                        </a>
                    </li><li>
                        <a
                            href="mailto:seonghun120614@gmail.com"
                            target="_blank" rel="noopener" aria-label="email">
                            <i class="icon-mail-alt"></i>
                        </a>
                    </li></ul><nav class="navigation about-footer condensed">
                    <ul>
                        
                        <li>
                            <a href="/seonghun120614/about">About Me</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/computerscience">Computer Science</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/math">Math</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/softwareengineering">Software Engineering</a>
                        </li>
                        
                    </ul>
                </nav><p class="about-footer condensed">&copy;
                    2025</p><div class="about-footer condensed">
                    <p>Dark Mode
                        <i class="icon-moon"></i>
                        <label class="switch" for="dark-toggle">
                            <input id="dark-toggle" type="checkbox"
                                class="dark-mode-toggle"
                                aria-label="Toggle dark mode">
                            <span class="slider round"
                                onclick="toggleDarkMode()"></span>
                        </label>
                    </p>
                </div>
            </section>
            <section class="content">
                <script>
window.MathJax = {
    tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']]
    },
    options: {
    renderActions: {
        addMenu: []
    }
    }
};
</script>

<script type="text/javascript"
    id="MathJax-script"
    async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script><div class="post-container">
    <a class="post-link" href="/seonghun120614/computerscience/java/spring/2025/08/08/8.-spring-boot-auto-configuration.html">
        <h2 class="post-title">8. Spring Boot Auto Configuration</h2>
    </a>
    
    <div class="post-meta">
        <div class="post-date"><i class="icon-calendar"></i>Aug 8, 2025</div><ul class="post-categories"><li>ComputerScience</li><li>Java</li><li>Spring</li></ul></div>

    <div class="post">
        <!--more-->

<h2 id="-목차">📂 목차</h2>
<ul>
  <li><a href="#common-context-configuration-설정">Common Context Configuration 설정</a></li>
  <li><a href="#conditional-을-통한-특정-bean-제외하고-import-하기">Conditional 을 통한 특정 Bean 제외하고 Import 하기</a></li>
  <li><a href="#condition-동작-방식">@Condition 동작 방식</a></li>
  <li><a href="#springfactories">spring.factories</a></li>
  <li><a href="#auto-configuration-구성하기">Auto Configuration 구성하기</a></li>
  <li><a href="#auto-configure-되는-datasource-클래스-우회하기">Auto Configure 되는 DataSource 클래스 우회하기</a></li>
</ul>

<hr />

<h2 id="-본문">📚 본문</h2>

<p>스프링 부트는 개발에 필요한 컴포넌트를 자동으로 설정해주는 기능이 있는데 이를 Auto Configuration 이라고 한다. 만약 <code class="language-plaintext highlighter-rouge">spring-boot-starter-web</code> 을 추가한다면, Spring Boot는 웹 어플리케이션 구동에 필요한 웹 서버가 필요할 것이라고 추론하고 아파치 톰캣(기본값임) 웹서버를 기본 웹 서버로 추가해준다. 톰캣 말고도 Jetty를 사용해도 무관하다. 그때는 dependencies를 Jetty를 사용하도록 수정해주면 된다(<code class="language-plaintext highlighter-rouge">spring-boot-starter-jetty</code>).</p>

<p>하지만 이게 모든 상황에 편리할 수는 없다. 예를 들어 개발팀1 에서 스프링 프레임워크를 사용해서 여러가지 프로젝트를 진행하고 있는데 spring bean 설정이 모든 팀(개발팀2, 개발팀3)에서 복사해서 사용하고 있으면 중복되는 bean 들을 여러 개 생성하는 것은 매우 비효율적일 것이다. 따라서 <strong>공통 구성 설정</strong> 이 필요할 수 있다.</p>

<h3 id="common-context-configuration-설정">Common Context Configuration 설정</h3>

<p><code class="language-plaintext highlighter-rouge">@Configuration</code> 애너테이션을 통해 이 클래스를 스프링 설정으로 담당하는데, 따로 <code class="language-plaintext highlighter-rouge">CommonApplicationContextConfiguration</code> 이라는 클래스를 만들어서 이 클래스를 포함하는 프로젝트는 메이븐이나 그레이들 컴포넌트로 배포되고 개발 팀에서는 이 프로젝트를 의존 관로 추가해서 설정 클래스를 사용할 수 있을 터이다(중복된 설정 작업 막기).</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonApplicationContextConfiguration</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">RelationalDataSourceConfiguration</span> <span class="nf">dataSourceConfiguration</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">RelationalDataSourceConfiguration</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>위는 <code class="language-plaintext highlighter-rouge">RelationalDataSourceConfiguration</code> 의 다른 모든 팀에서 자주 사용할 법한 그런 클래스들을 빈으로 정의하고 있다. 이렇게 정의해두면 다른 팀에서 이를 사용할 때 설정 파일 내용을 수정하는 수고를 덜 수 있다. 이제 이를 함의하는 다른 Application Context(IoC 컨테이너)를 정의하자. 영업팀은 다음을 사용할 수 있을 것이다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.example.study.config</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.*</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="nd">@Import</span><span class="o">(</span><span class="nc">CommonApplicationContextConfiguration</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonBusinessApplicationContextConfiguration</span> <span class="o">{</span>
    <span class="c1">// 영업팀의 Common ApplicationContext</span>
<span class="o">}</span></code></pre></figure>

<h3 id="conditional-을-통한-특정-bean-제외하고-import-하기">Conditional 을 통한 특정 Bean 제외하고 Import 하기</h3>

<p>스프링 프레임워크는 스프링이 관리하는 컴포넌트의 생성을 제어할 수 있도록 <code class="language-plaintext highlighter-rouge">@Bean</code>, <code class="language-plaintext highlighter-rouge">@Component</code>, <code class="language-plaintext highlighter-rouge">@Configuration</code> 애너테이션과 함께 사용할 수 있는 <code class="language-plaintext highlighter-rouge">@Conditional</code> 애너테이션을 제공한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonApplicationContextConfiguration</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="nd">@Conditional</span><span class="o">(</span><span class="nc">RelationalDatabaseCondition</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">RelationalDataSourceConfiguration</span> <span class="nf">dataSourceConfiguration</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">RelationalDataSourceConfiguration</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Conditional 을 붙여 조건을 걸 수 있고, 조건에 해당하는 Context들에만 해당 Bean이 들어가게 된다. <code class="language-plaintext highlighter-rouge">RelationalDatabaseCondition</code> 은 <code class="language-plaintext highlighter-rouge">Condition</code> 인터페이스를 구현하는 클래스이고, <code class="language-plaintext highlighter-rouge">boolean matches()</code> 을 구현하도록 한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.example.study.config</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.core.type.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RelationalDatabaseCondition</span> <span class="kd">implements</span> <span class="nc">Condition</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="nc">ConditionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">AnnotatedTypeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">isMySqlDatabase</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isMySqlDatabase</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.mysql.jdbc.Driver"</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>위에서는 <code class="language-plaintext highlighter-rouge">reflect</code> API를 활용하여 JVM에 jdbc.Driver 가 올라가 있는지를 살피는 로직이다. 안에 얼마든지 복잡한 로직을 사용하여 Application Context 를 유연하게 활용할 수 있다.</p>

<h3 id="condition-동작-방식">@Condition 동작 방식</h3>

<p>애너테이션만으로 조건부 빈 생성이 가능하지만, 스프링에서는 다양한 조건을 쉽게 사용할 수 있게 해주는 다양한 고수준의 애너테이션을 따로 제공한다. 몇 개만 외우자.</p>

<table>
  <tbody>
    <tr>
      <td>애너테이션</td>
      <td>예시</td>
      <td>예시 설명</td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td>@ConditionalOnBean</td>
      <td>@Conditional(DataSource.class)</td>
      <td>설정에서 DataSource 빈이 명시돼 있으면 true 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnClass</td>
      <td>@ConditionalOnClass(DataSource.class)</td>
      <td>클래스 패스에 DataSource 클래스가 있으면 true 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnProperty</td>
      <td>@ConditionalOnClass(“some.property”)</td>
      <td>some.property 가 정의되어 있으면 true 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnCloud</td>
      <td>@ConditionalOnCloud(CloudPlatform.KUBERNETES)</td>
      <td>CloudPlatform 이 KUBERNETES로 설정돼있으면 true 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnJava</td>
      <td>@ConditionalOnJava(JavaVersion.EIGHT)</td>
      <td>Java 버전이 8을 지원하면 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnMissingBean</td>
      <td>@ConditionalOnMissingBean(DataSource.class)</td>
      <td>DataSource 빈이 설정돼 있지 않으면 true 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnMissingClass</td>
      <td>@ConditionalOnMissingClass(DataSource.class)</td>
      <td>클래스 패스에 DataSource 빈이 설정돼 있지 않으면 true 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnNotWebApplication</td>
      <td>@ConditionalOnNotWebApplication</td>
      <td>웹 어플이 아니면 true 반환</td>
    </tr>
    <tr>
      <td>@ConditionalOnSingleCandidate</td>
      <td>@ConditionalOnSingleCandidate(DataSource.class)</td>
      <td>DataSource 빈이 하나만 정의돼 있으면 true</td>
    </tr>
  </tfoot>
</table>

<h3 id="springfactories">spring.factories</h3>

<p>모든 스프링 프로젝트는 spring-boot-autoconfigure 의 의존관계를 포함하고 있다.</p>

<p><img src="/assets/img/spring-boot-autoconfigure-jar.png" alt="spring-boot-autoconfigure-jar.png" /></p>

<p>이 모듈의 JAR 파일의 META-INF 폴더를 파헤치면</p>

<figure class="highlight"><pre><code class="language-txt" data-lang="txt">...

# Auto Configuration Import Listeners
org.springframework.boot.autoconfigure.AutoConfigurationImportListener=\
org.springframework.boot.autoconfigure.condition.ConditionEvaluationReportAutoConfigurationImportListener

# Auto Configuration Import Filters
org.springframework.boot.autoconfigure.AutoConfigurationImportFilter=\
org.springframework.boot.autoconfigure.condition.OnBeanCondition,\
org.springframework.boot.autoconfigure.condition.OnClassCondition,\
org.springframework.boot.autoconfigure.condition.OnWebApplicationCondition

...</code></pre></figure>

<p>위와 같은 properties 가 보이며, Auto Configuration 으로 표시된 부분이 스프링 부트 컴포넌트, 서드 파티 라이브러리 등에 대한 자동 구성 정보가 포함돼 있는 곳이다.</p>

<p>위 Condition 들 순서대로</p>
<ol>
  <li>OnBeanCondition</li>
  <li>OnClassCondition</li>
  <li>OnWebApplicationCondition</li>
</ol>

<p>을 통해 걸러지고 남은 Configuration 들만 <code class="language-plaintext highlighter-rouge">@Configuration</code> 으로 처리된다.</p>

<h3 id="auto-configuration-구성하기">Auto Configuration 구성하기</h3>

<p>모든 팀들이 공통적으로 사용할 데이터 소스의 자동 설정을 건드려보자.</p>

<ul>
  <li>dev 환경: mysql, postgresql 사용</li>
  <li>test 환경: H2 사용</li>
  <li>prod 환경: mysql, postgresql 사용</li>
</ul>

<p>각 환경마다 저렇게 구성하고 싶다고 해보자. properties 를 우선 설정하여 profiles 만 바꾸는 것만으로 <code class="language-plaintext highlighter-rouge">DataSource</code> 를 자동 변경을 시키도록 하고 싶을 것이다.</p>

<p>test 환경에서는 <code class="language-plaintext highlighter-rouge">spring.active.profiles</code> 라는 spring에서 지정된 key 에 의해 <code class="language-plaintext highlighter-rouge">application-{spring.active.profiles}.properties</code> 의 설정 정보를 읽어 들여 실행하게 된다. 이 값을 통해 Condition 을 짜보자.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InMemoryDatabaseCondition</span> <span class="kd">implements</span> <span class="nc">Condition</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span>
            <span class="nc">ConditionContext</span> <span class="n">context</span><span class="o">,</span>
            <span class="nc">AnnotatedTypeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Environment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">activeProfile</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"spring.profiles.active"</span><span class="o">);</span>
        <span class="k">return</span> <span class="c1">// activeProfile == null ||</span>
                <span class="n">activeProfile</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"test"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>InMemory는 내장 RAM 을 통한 db source 를 구성하는 방식이다. context 를 통해서 들고 와도 되고, javax.lang.reflect를 통해 JVM에 올라간 driver class 의 name 을 검사해도 무방하다. 왠만해서는 Spring을 쓰자.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="nd">@Conditional</span><span class="o">(</span><span class="nc">InMemoryDatabaseCondition</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InMemoryDataSourceConfiguration</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">DataSourceProperties</span> <span class="n">dsp</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">InMemoryDataSourceConfiguration</span><span class="o">(</span><span class="nc">DataSourceProperties</span> <span class="n">dataSourceProperties</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">dsp</span> <span class="o">=</span> <span class="n">dataSourceProperties</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">DataSource</span> <span class="nf">dataSource</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HikariDataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HikariDataSource</span><span class="o">();</span>
        <span class="n">ds</span><span class="o">.</span><span class="na">setJdbcUrl</span><span class="o">(</span><span class="n">dsp</span><span class="o">.</span><span class="na">getUrl</span><span class="o">());</span>
        <span class="n">ds</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="n">dsp</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span>
        <span class="n">ds</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">dsp</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">ds</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>공통 DB Configuration 을 선언하여 inner class 를 통해 다수의 class 를 들고 오게 할 수 있다. 이를 통해 각 DB에 대한 property 를 다르게 설정하여 들고 올 수 있고, NoSQL 을 사용하는 DB에 대해서도 추가적으로 확장할 수 있을 터이다. 여기서 DataSource 는 <code class="language-plaintext highlighter-rouge">HikariDataSource</code> 를 사용한다(경랑, 성능 좋음)(Spring 2.x 에서는 커넥션 풀이 Hikari 를 사용하기 때문에 따로 설정해줄 필요가 없다).</p>

<h3 id="auto-configure-되는-datasource-클래스-우회하기">Auto Configure 되는 DataSource 클래스 우회하기</h3>

<p>Spring Boot는 DataSource 를 <code class="language-plaintext highlighter-rouge">spring.datasource</code> prefix 의 key-value 프로퍼티를 읽어들여서 DataSource를 구성하게 된다. 이때, 자신의 project 에 <code class="language-plaintext highlighter-rouge">DataSource</code> 타입의 Bean 이 존재하게 되면 내부의<code class="language-plaintext highlighter-rouge">@ConditionalOnMissingBean(DataSource.class)</code> 의 조건 때문에 원래의 Auto Configure 에 의한 DataSource 의존성 주입을 우회하게 된다. 이를 사용하면 다음을 구성할 수 있다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="nd">@Conditional</span><span class="o">(</span><span class="nc">InMemoryDatabaseCondition</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InMemoryDataSourceConfiguration</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">DataSourceProperties</span> <span class="n">dsp</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">InMemoryDataSourceConfiguration</span><span class="o">(</span><span class="nc">DataSourceProperties</span> <span class="n">dataSourceProperties</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">dsp</span> <span class="o">=</span> <span class="n">dataSourceProperties</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">DataSource</span> <span class="nf">dataSource</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HikariDataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HikariDataSource</span><span class="o">();</span>
        <span class="n">ds</span><span class="o">.</span><span class="na">setJdbcUrl</span><span class="o">(</span><span class="n">dsp</span><span class="o">.</span><span class="na">getUrl</span><span class="o">());</span>
        <span class="n">ds</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="n">dsp</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span>
        <span class="n">ds</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">dsp</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">ds</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>여기서 DataSource thread 개수들을 서버의 성능에 따라 달리 사용하여서 조정할 수도 있고 Pool을 달리 설정할 수도 있다.</p>

    </div><div id="disqus_thread" style="margin-top:25px"></div>
    <script>
    var disqus_config = function () {
        this.page.url = 'https://seonghun120614.github.io/seonghun120614/computerscience/java/spring/2025/08/08/8.-spring-boot-auto-configuration.html';
        this.page.identifier = 'https://seonghun120614.github.io/seonghun120614/computerscience/java/spring/2025/08/08/8.-spring-boot-auto-configuration.html';
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://seonghun.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
  </script>
    <noscript>Please enable JavaScript to view the <a
            href="https://disqus.com/?ref_noscript" rel="nofollow">comments
            powered by Disqus.</a></noscript></div>
<script>
    mermaid.initialize({startOnLoad:true});
    window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
</script>
            </section>
            <footer class="condensed">
                <ul class="social about-footer condensed"><li>
                        <a
                            href="https://github.com/seonghun120614"
                            target="_blank"
                            rel="noopener"
                            aria-label="github">
                            <i class="icon-github-circled"></i>
                        </a>
                    </li><li>
                        <a
                            href="mailto:seonghun120614@gmail.com"
                            target="_blank" rel="noopener" aria-label="email">
                            <i class="icon-mail-alt"></i>
                        </a>
                    </li></ul><nav class="navigation about-footer condensed">
                    <ul>
                        
                        <li>
                            <a href="/seonghun120614/about">About Me</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/computerscience">Computer Science</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/math">Math</a>
                        </li>
                        
                        <li>
                            <a href="/seonghun120614/categories/softwareengineering">Software Engineering</a>
                        </li>
                        
                    </ul>
                </nav><p class="about-footer condensed">&copy;
                    2025</p><div class="about-footer condensed">
                    <p>Dark Mode
                        <i class="icon-moon"></i>
                        <label class="switch" for="dark-toggle">
                            <input id="dark-toggle" type="checkbox"
                                class="dark-mode-toggle"
                                aria-label="Toggle dark mode">
                            <span class="slider round"
                                onclick="toggleDarkMode()"></span>
                        </label>
                    </p>
                </div>
            </footer>
        </main>
        
        <script type="text/javascript" src="/seonghun120614/assets/js/darkmode.js"></script>
        
        <script src="/seonghun120614/assets/js/simple-jekyll-search.min.js"></script>
        <script src="/seonghun120614/assets/js/search.js"></script>
        
        <script>
            window.addEventListener('scroll', () => {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = (scrollTop / docHeight) * 100;
                document.getElementById('scroll-progress').style.width = scrollPercent + '%';
            });
        </script>
    </body>
</html>